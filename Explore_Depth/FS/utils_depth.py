import numpy as np
from sklearn.metrics import confusion_matrix
import random
import torch
import torch.nn.functional as F
import torch.nn as nn
import itertools
from torchvision.utils import make_grid
from torch.autograd import Variable
from PIL import Image
from skimage import io
import os
# import imagecodes

def seed_torch(seed=42):
	random.seed(seed)
	os.environ['PYTHONHASHSEED'] = str(seed) # 为了禁止hash随机化，使得实验可复现
	np.random.seed(seed)
	torch.manual_seed(seed)
	torch.cuda.manual_seed(seed)
	torch.cuda.manual_seed_all(seed) # if you are using multi-GPU.
	torch.backends.cudnn.benchmark = False
	torch.backends.cudnn.deterministic = True

seed_torch()
# Parameters
## SwinFusion
# WINDOW_SIZE = (64, 64) # Patch size
WINDOW_SIZE = (256, 256) # Patch size

STRIDE = 32 # Stride for testing
IN_CHANNELS = 3 # Number of input channels (e.g. RGB)
FOLDER = r"/data5/GLGAN/datasets/" # Replace with your "/path/to/the/ISPRS/dataset/folder/"


BATCH_SIZE = 10 # Number of samples in a mini-batch
# BATCH_SIZE = 16 # Number of samples in a mini-batch

LABELS = ["roads", "buildings", "low veg.", "trees", "cars", "clutter"] # Label names
N_CLASSES = len(LABELS) # Number of classes
WEIGHTS = torch.ones(N_CLASSES) # Weights for class balancing


CACHE = True # Store the dataset in-memory

# ISPRS color palette
# Let's define the standard ISPRS color palette
palette = {0 : (255, 255, 255), # Impervious surfaces (white)
           1 : (0, 0, 255),     # Buildings (blue)
           2 : (0, 255, 255),   # Low vegetation (cyan)
           3 : (0, 255, 0),     # Trees (green)
           4 : (255, 255, 0),   # Cars (yellow)
           5 : (255, 0, 0),     # Clutter (red)
           6 : (0, 0, 0)}       # Undefined (black)

invert_palette = {v: k for k, v in palette.items()}

MODEL = 'UNetformer'
# MODEL = 'ABCNet'
# MODEL = 'FTUNetformer'
MODE = 'Train'
# MODE = 'Test'
# DATASET = 'Vaihingen'
DATASET = 'GID-15'
# DATASET = 'iSAID'
LOSS = 'SEG+OBJ'

os.environ["CUDA_VISIBLE_DEVICES"] = "0"

# 使用该数据集时，请跳转到914行，只统计前五类的miou
if DATASET == 'Potsdam':

    #all
    train_ids = ['6_10_71', '4_12_143', '6_9_58', '7_9_52', '7_7_41', '5_12_70', '7_7_119', '6_10_125', '6_12_36', '2_10_143', '7_8_41', '6_12_136', '7_8_33', '4_11_78', '4_12_104', '7_7_33', '4_11_7', '5_12_64', '4_12_3', '7_10_13', '2_10_28', '7_7_3', '2_10_21', '7_9_51', '6_7_34', '7_10_90', '2_10_11', '7_8_25', '6_10_59', '7_7_12', '3_12_91', '7_11_102', '7_10_15', '5_10_114', '4_12_110', '6_8_127', '3_12_114', '6_8_103', '5_12_105', '2_10_17', '2_12_59', '7_8_94', '6_12_52', '6_7_93', '2_12_32', '6_12_25', '3_11_136', '7_8_74', '6_7_116', '2_10_37', '5_10_35', '3_12_97', '5_12_37', '2_10_74', '7_9_136', '6_10_50', '5_10_130', '4_11_141', '6_9_116', '5_12_133', '6_7_48', '4_11_84', '5_12_113', '5_10_4', '6_12_80', '3_12_58', '4_11_90', '7_8_5', '2_12_66', '4_11_134', '6_12_142', '3_12_39', '2_12_53', '7_7_21', '5_10_78', '3_11_113', '7_11_67', '4_11_2', '6_9_100', '4_11_43', '7_8_43', '6_8_53', '6_9_110', '5_10_39', '7_7_61', '6_10_116', '4_11_55', '6_12_66', '7_7_130', '6_7_107', '5_12_118', '7_10_134', '6_9_60', '7_9_96', '3_12_84', '6_9_121', '5_10_80', '5_12_15', '7_10_93', '6_8_101', '6_7_59', '6_8_42', '5_12_80', '6_9_83', '7_9_142', '2_12_70', '2_10_38', '6_8_70', '6_12_59', '7_10_114', '6_10_73', '3_11_17', '4_12_102', '3_11_15', '5_10_72', '7_9_0', '6_12_64', '4_11_138', '6_8_67', '7_9_102', '6_9_6', '6_7_35', '3_12_30', '2_12_54', '2_10_60', '7_10_36', '7_7_51', '2_12_12', '4_11_17', '7_11_73', '7_8_8', '6_7_5', '2_10_73', '6_9_84', '6_8_3', '3_11_86', '4_12_115', '5_10_79', '5_10_44', '6_7_83', '2_12_14', '4_11_27', '6_10_44', '4_11_35', '6_10_40', '6_9_90', '7_11_68', '5_12_83', '4_12_26', '6_7_9', '6_8_59', '6_7_109', '6_8_0', '3_12_112', '5_12_124', '7_11_35', '6_9_128', '3_12_87', '7_10_39', '2_12_120', '5_12_19', '6_8_2', '7_9_37', '7_10_100', '7_8_101', '2_12_127', '3_12_41', '5_10_61', '7_7_68', '4_11_36', '2_12_46', '6_7_54', '3_12_111', '6_8_141', '4_11_130', '7_8_136', '4_12_124', '7_9_11', '7_11_122', '2_12_75', '7_10_19', '4_11_118', '4_12_53', '7_10_97', '5_12_112', '4_11_129', '5_10_36', '3_11_77', '2_12_94', '6_10_48', '3_11_51', '2_12_4', '3_11_107', '6_7_20', '2_10_76', '3_12_102', '2_10_101', '6_10_24', '6_8_72', '7_11_30', '2_12_44', '4_12_65', '7_7_105', '6_9_74', '5_12_34', '7_7_95', '6_12_88', '6_7_13', '7_11_136', '6_8_56', '7_7_110', '6_10_139', '4_11_137', '2_10_126', '3_11_115', '4_11_26', '6_12_19', '6_9_101', '7_11_137', '4_12_129', '7_11_140', '4_12_97', '6_10_72', '3_12_35', '5_12_21', '4_12_47', '4_11_79', '7_11_109', '4_11_124', '6_9_120', '3_11_103', '4_12_42', '5_10_95', '2_10_66', '5_12_90', '4_11_22', '6_9_93', '7_10_34', '6_7_104', '6_8_83', '7_8_6', '5_10_98', '7_10_17', '2_10_80', '5_12_55', '5_10_91', '7_8_130', '5_12_126', '2_12_81', '6_12_68', '5_10_24', '7_8_86', '4_12_39', '6_10_54', '2_12_0', '6_12_17', '7_7_79', '7_9_10', '3_11_41', '6_8_100', '5_12_140', '5_12_61', '4_11_4', '5_10_123', '6_7_49', '4_11_50', '6_9_126', '7_11_89', '3_11_16', '3_12_121', '3_12_31', '5_10_74', '3_11_14', '7_7_15', '6_12_0', '3_12_143', '7_10_92', '6_10_105', '7_9_27', '6_8_41', '6_10_14', '3_11_10', '3_12_37', '3_12_11', '5_12_1', '2_12_37', '6_12_133', '5_10_125', '3_11_128', '6_7_126', '7_8_21', '7_7_52', '2_10_113', '2_10_98', '2_10_85', '7_9_24', '6_9_98', '3_11_31', '4_12_103', '5_10_29', '2_12_108', '6_7_65', '7_9_134', '5_10_92', '7_10_137', '2_12_100', '5_12_33', '4_12_119', '6_8_48', '7_10_52', '4_12_33', '6_9_12', '3_12_139', '3_12_118', '7_8_23', '6_8_43', '4_12_43', '5_10_19', '3_12_60', '6_7_21', '5_12_13', '2_12_105', '7_8_0', '2_10_87', '2_12_41', '6_12_97', '6_10_97', '4_12_18', '5_12_11', '7_8_51', '6_8_131', '7_8_105', '4_12_55', '2_12_18', '6_8_90', '5_10_107', '7_7_19', '5_10_101', '5_12_81', '7_7_11', '5_10_138', '7_10_135', '7_9_127', '5_10_110', '4_12_133', '5_12_6', '6_7_139', '5_10_25', '6_12_138', '6_12_26', '6_7_39', '2_12_140', '6_12_55', '6_9_63', '6_9_130', '6_10_112', '7_9_67', '6_9_108', '2_12_28', '4_11_51', '6_10_68', '7_7_47', '7_10_20', '2_12_115', '6_9_61', '2_10_86', '3_12_64', '7_10_60', '3_12_83', '6_9_28', '3_11_76', '5_10_113', '7_10_73', '7_9_49', '7_10_122', '3_11_39', '4_11_110', '7_7_83', '2_10_58', '6_7_73', '3_11_28', '4_12_116', '3_12_23', '4_11_139', '2_10_139', '6_10_60', '5_12_131', '4_11_123', '6_12_38', '6_8_60', '4_11_86', '7_9_113', '6_8_30', '7_9_14', '3_11_38', '2_12_2', '7_11_24', '7_8_2', '5_10_76', '4_11_131', '4_12_64', '6_9_91', '7_9_140', '7_7_88', '5_10_17', '3_12_94', '4_12_66', '3_11_98', '2_10_6', '2_12_112', '7_11_37', '2_10_32', '4_11_53', '6_9_77', '3_12_93', '7_8_126', '4_12_84', '3_11_123', '6_9_123', '7_11_112', '3_11_80', '6_7_28', '6_10_10', '6_12_109', '4_11_119', '7_8_104', '2_10_77', '2_12_101', '6_7_133', '7_7_113', '7_10_116', '3_11_84', '3_11_53', '6_9_66', '7_10_41', '6_10_52', '2_12_141', '5_10_8', '7_10_35', '6_7_113', '7_9_62', '4_11_63', '4_12_21', '7_9_23', '6_12_49', '7_8_63', '4_12_77', '7_9_137', '7_9_99', '7_7_62', '6_7_33', '7_11_98', '7_9_44', '7_7_126', '3_11_64', '7_8_137', '4_11_60', '2_12_130', '3_12_42', '7_8_95', '6_7_124', '7_11_59', '7_10_124', '7_9_9', '4_12_112', '3_12_2', '3_12_72', '6_9_106', '3_12_8', '2_10_53', '6_10_42', '2_12_92', '7_11_93', '4_12_111', '6_7_7', '5_12_115', '5_12_10', '5_12_28', '3_11_88', '4_11_142', '4_11_116', '4_11_21', '5_12_122', '6_12_122', '4_12_46', '7_11_132', '7_7_31', '5_12_36', '2_12_84', '6_12_118', '6_12_105', '5_10_135', '6_7_71', '7_10_43', '6_12_12', '7_10_45', '7_7_84', '2_12_64', '6_9_80', '7_7_98', '6_10_67', '5_10_7', '7_7_40', '3_11_8', '2_10_111', '6_10_11', '5_10_59', '2_10_108', '7_10_120', '7_8_70', '3_12_34', '6_9_21', '7_8_11', '7_7_35', '4_12_30', '7_8_115', '2_10_114', '7_8_109', '7_8_111', '7_8_106', '7_8_80', '4_11_25', '7_7_38', '5_10_132', '7_7_78', '7_11_139', '6_10_89', '7_7_124', '7_9_120', '5_12_143', '7_7_122', '4_12_78', '6_8_28', '7_8_56', '6_8_122', '5_12_46', '2_10_57', '7_11_128', '7_7_96', '6_10_131', '6_9_62', '5_10_134', '7_8_84', '2_10_110', '7_10_108', '7_10_61', '6_7_141', '6_8_12', '3_12_115', '6_7_117', '3_12_19', '4_12_134', '7_11_124', '5_10_42', '5_10_75', '4_11_125', '6_10_143', '6_8_114', '3_12_15', '6_12_13', '3_11_67', '7_10_86', '6_9_95', '2_12_39', '4_12_31', '7_8_42', '6_10_134', '7_10_132', '3_11_56', '7_9_64', '2_12_25', '6_9_59', '4_11_61', '3_11_130', '5_10_27', '7_8_124', '7_10_3', '6_12_89', '7_8_129', '4_11_100', '6_9_52', '2_10_115', '7_7_59', '2_10_54', '7_9_6', '3_11_81', '3_11_24', '5_10_103', '6_9_70', '4_12_94', '2_12_20', '6_8_62', '6_10_76', '7_10_88', '6_12_57', '2_12_87', '7_10_63', '7_9_69', '4_12_2', '6_8_32', '6_12_78', '6_9_135', '6_9_65', '6_7_61', '6_8_51', '5_12_2', '6_7_64', '6_12_1', '7_8_78', '6_10_113', '7_9_18', '3_11_104', '4_12_16', '3_12_88', '4_11_107', '7_11_87', '5_12_141', '6_8_64', '3_12_26', '6_7_53', '7_11_81', '5_12_77', '6_10_85', '6_9_30', '7_10_118', '7_7_100', '2_12_125', '3_11_126', '6_12_91', '5_12_104', '2_10_94', '3_11_40', '3_11_0', '4_11_114', '7_11_0', '5_12_134', '4_11_88', '3_12_68', '6_12_126', '4_11_45', '6_10_32', '6_8_97', '7_10_10', '6_9_18', '6_9_64', '2_10_90', '6_8_78', '7_11_101', '7_9_81', '3_11_112', '6_7_23', '5_10_94', '7_10_121', '7_9_125', '7_9_25', '3_11_34', '5_10_6', '6_12_108', '6_8_75', '7_9_17', '6_9_35', '4_12_24', '7_7_123', '7_11_33', '6_9_17', '6_9_131', '6_12_113', '6_7_22', '6_12_121', '2_10_65', '7_7_125', '2_10_83', '3_12_52', '2_10_14', '4_11_6', '7_9_83', '7_9_123', '5_10_87', '4_11_34', '7_8_113', '4_11_75', '5_10_5', '6_12_35', '7_8_83', '7_7_16', '7_7_4', '5_12_85', '6_12_130', '7_9_8', '7_11_19', '6_9_118', '3_11_83', '3_12_67', '3_11_120', '2_12_82', '6_10_27', '7_11_29', '7_7_53', '6_9_79', '3_12_70', '2_12_26', '6_9_87', '7_8_125', '3_12_75', '3_11_106', '4_11_30', '2_12_8', '6_9_46', '2_10_89', '5_10_52', '7_7_135', '2_10_79', '6_10_33', '7_7_39', '6_10_138', '2_12_80', '7_11_6', '7_10_62', '7_7_77', '6_8_142', '3_11_9', '7_8_50', '7_8_60', '6_12_107', '5_12_40', '2_10_97', '6_7_37', '3_12_13', '3_11_94', '6_8_31', '7_9_130', '7_10_65', '6_10_109', '6_7_19', '2_10_64', '6_9_86', '7_8_12', '4_12_100', '7_7_42', '7_11_12', '7_7_34', '5_12_76', '6_9_16', '5_10_84', '6_9_2', '5_10_127', '2_10_121', '2_10_50', '5_10_116', '7_10_7', '2_12_68', '6_9_4', '7_8_58', '6_10_2', '2_12_60', '5_10_118', '3_11_134', '3_11_89', '2_10_119', '3_11_11', '2_10_140', '7_7_55', '6_8_9', '6_9_3', '4_11_99', '7_7_6', '6_8_18', '7_11_125', '4_12_108', '6_9_53', '2_12_78', '4_12_87', '2_10_30', '6_9_34', '6_12_114', '4_12_95', '7_9_129', '7_9_70', '7_9_75', '7_10_56', '7_7_44', '2_12_55', '3_12_49', '6_9_0', '6_10_110', '7_7_25', '7_8_59', '2_12_45', '7_10_57', '7_9_45', '6_8_76', '7_11_105', '3_12_18', '3_12_48', '2_12_73', '5_12_73', '4_12_67', '7_8_31', '5_12_98', '6_12_98', '6_7_121', '3_12_101', '4_11_83', '6_12_120', '7_9_93', '6_8_5', '7_10_42', '6_8_108', '5_12_95', '7_8_133', '6_8_33', '6_12_65', '2_10_29', '6_12_101', '6_12_139', '3_11_99', '6_10_21', '6_9_105', '3_11_95', '7_7_72', '2_12_119', '6_10_84', '7_7_48', '6_8_125', '7_11_143', '6_12_140', '3_12_90', '4_12_128', '6_8_133', '6_7_51', '6_12_9', '6_12_33', '7_8_22', '7_9_78', '7_9_90', '2_10_52', '6_9_10', '2_12_42', '4_11_97', '7_7_143', '2_12_69', '7_10_67', '7_10_46', '6_10_127', '3_11_60', '3_12_129', '3_12_55', '6_8_19', '5_10_60', '7_11_126', '7_9_94', '7_9_3', '7_10_91', '5_12_119', '3_11_116', '5_10_81', '6_10_101', '3_12_124', '7_7_10', '3_12_127', '7_11_83', '5_10_93', '2_12_90', '4_12_98', '7_10_94', '3_12_29', '3_12_105', '6_8_1', '7_8_49', '7_11_115', '6_12_7', '6_9_48', '7_9_41', '6_9_67', '2_12_85', '2_10_142', '5_10_43', '6_7_63', '4_12_15', '2_12_111', '6_8_98', '3_12_132', '5_10_143', '4_11_33', '7_8_14', '6_8_47', '6_10_124', '4_11_111', '6_9_117', '7_9_111', '2_10_59', '6_8_7', '2_10_112', '2_10_96', '7_11_22', '5_12_111', '6_8_99', '7_8_66', '5_12_23', '2_12_133', '3_12_81', '6_10_88', '5_10_86', '6_12_51', '5_10_33', '6_7_91', '7_9_107', '7_11_44', '7_9_97', '4_11_20', '7_9_131', '5_12_57', '6_10_4', '2_10_104', '6_7_4', '6_12_131', '7_9_112', '6_8_140', '4_12_28', '7_7_66', '2_12_10', '5_10_90', '6_8_106', '4_12_0', '3_11_131', '6_7_52', '4_11_71', '7_7_138', '6_8_121', '4_12_6', '6_9_115', '4_12_106', '6_12_135', '6_12_14', '7_7_106', '7_10_50', '4_11_23', '2_10_0', '7_9_124', '6_10_38', '7_8_57', '7_9_100', '7_9_7', '6_9_50', '4_11_81', '7_10_105', '3_12_136', '7_9_89', '5_12_16', '7_7_30', '4_12_41', '5_10_100', '7_7_28', '4_11_14', '6_10_121', '6_9_27', '6_7_89', '6_8_88', '6_10_46', '3_12_137', '7_9_141', '3_12_108', '4_12_96', '3_12_135', '3_11_1', '6_10_74', '6_12_10', '7_11_123', '7_10_110', '7_11_108', '6_9_5', '4_11_108', '6_7_56', '6_8_85', '7_9_139', '5_12_30', '4_11_68', '6_9_129', '7_11_28', '2_10_99', '5_12_53', '7_10_74', '4_11_47', '7_11_31', '6_7_87', '2_12_31', '3_12_78', '6_9_125', '3_11_7', '3_11_111', '2_12_24', '6_9_107', '6_7_136', '7_7_1', '7_7_86', '5_12_26', '2_12_116', '6_12_90', '6_9_15', '7_10_16', '5_12_69', '3_11_109', '7_7_57', '4_11_46', '4_11_44', '7_8_20', '3_11_6', '5_12_35', '7_8_71', '7_7_111', '4_12_126', '2_10_106', '6_9_78', '7_10_111', '6_7_16', '4_11_13', '6_10_115', '4_12_35', '3_11_68', '3_11_122', '6_7_130', '3_12_47', '4_11_126', '6_10_8', '7_10_8', '7_8_139', '4_11_9', '7_10_81', '7_11_118', '7_9_80', '7_11_55', '2_10_69', '4_12_49', '6_12_60', '3_12_4', '4_12_9', '2_12_65', '7_9_114', '4_11_77', '6_8_55', '3_11_62', '5_12_75', '6_8_61', '7_11_3', '4_12_91', '6_7_0', '6_10_25', '6_8_89', '2_12_62', '4_11_12', '6_8_79', '3_11_3', '6_12_102', '4_12_107', '6_8_39', '3_12_92', '4_11_31', '2_10_46', '6_7_62', '7_8_75', '4_12_40', '5_10_121', '6_7_68', '5_10_48', '6_9_31', '6_8_17', '7_7_134', '6_10_140', '6_12_76', '6_10_90', '5_10_26', '6_10_36', '2_12_86', '3_12_80', '2_10_34', '7_9_30', '4_11_69', '7_10_103', '6_10_81', '7_7_108', '2_12_17', '7_9_46', '7_10_106', '2_10_107', '6_12_23', '6_8_136', '3_12_73', '6_7_95', '4_11_72', '7_11_100', '5_12_79', '4_12_142', '2_10_130', '7_8_92', '6_7_112', '6_12_37', '6_7_15', '7_10_72', '7_7_92', '2_10_1', '4_12_109', '7_8_64', '2_12_47', '4_11_66', '2_12_97', '6_9_109', '6_10_22', '5_10_109', '7_10_53', '2_10_95', '5_12_56', '6_9_9', '6_7_90', '7_11_79', '6_10_130', '2_12_91', '4_11_92', '4_12_20', '3_11_108', '6_12_41', '7_7_127', '7_8_123', '7_11_62', '3_12_107', '6_10_26', '5_10_82', '6_10_107', '5_12_12', '5_10_23', '5_12_62', '6_8_132', '7_9_63', '3_11_141', '4_11_93', '2_10_9', '3_11_35', '5_12_39', '7_8_117', '7_9_38', '3_11_19', '6_9_141', '3_11_13', '2_12_89', '7_11_21', '5_10_128', '2_12_137', '5_10_32', '2_12_135', '6_8_139', '7_11_40', '4_12_58', '7_9_116', '7_11_82', '7_10_82', '7_8_55', '7_9_60', '6_7_106', '3_11_129', '4_12_23', '2_12_11', '6_10_133', '7_7_102', '7_10_25', '7_7_18', '5_10_47', '4_12_122', '7_11_103', '6_10_5', '4_12_8', '7_7_131', '6_7_11', '5_10_89', '6_8_58', '5_12_96', '7_8_118', '6_8_22', '7_11_107', '3_11_100', '7_8_44', '7_10_80', '7_7_32', '2_12_52', '6_8_26', '6_12_125', '7_9_56', '5_12_89', '2_10_134', '5_12_120', '6_9_54', '6_12_63', '7_10_12', '6_10_137', '6_9_127', '6_10_93', '7_10_48', '7_8_16', '2_10_120', '6_8_110', '6_10_108', '2_12_6', '4_11_41', '6_7_30', '2_12_110', '7_7_120', '7_8_134', '7_9_22', '4_12_60', '3_12_53', '6_8_35', '3_12_1', '7_7_67', '6_7_99', '5_12_47', '6_12_112', '7_11_14', '6_12_74', '7_7_139', '7_8_46', '6_9_71', '7_10_23', '7_7_112', '6_10_39', '6_8_63', '6_12_72', '2_12_98', '5_10_102', '7_9_98', '7_10_119', '4_11_42', '2_12_117', '2_10_51', '3_11_105', '4_11_52', '7_9_12', '6_8_44', '5_12_65', '5_10_67', '5_12_107', '6_10_119', '6_10_53', '7_9_128', '3_11_93', '7_11_134', '4_11_8', '5_12_102', '7_9_115', '5_12_8', '6_12_99', '7_8_36', '6_9_42', '6_12_27', '6_10_92', '2_12_34', '7_7_73', '6_7_8', '5_12_128', '4_12_7', '6_7_2', '6_8_52', '6_7_92', '2_12_104', '7_9_74', '7_11_85', '7_8_143', '7_11_135', '6_9_68', '5_12_51', '3_12_79', '5_12_27', '6_8_25', '7_10_49', '2_10_72', '2_10_136', '7_11_63', '7_11_48', '7_8_1', '7_8_132', '2_10_135', '6_8_82', '2_12_63', '7_7_129', '6_10_55', '5_10_9', '3_11_135', '7_7_63', '5_12_91', '7_11_97', '6_7_125', '5_10_62', '7_9_36', '6_12_56', '6_8_109', '4_11_113', '4_12_62', '6_10_62', '6_10_16', '6_10_63', '7_7_65', '5_12_110', '7_10_131', '6_7_43', '4_12_86', '7_7_26', '3_12_140', '4_12_114', '5_12_66', '4_11_105', '6_10_58', '6_8_137', '6_12_134', '7_10_139', '7_7_58', '3_11_43', '2_10_128', '5_12_129', '2_10_47', '4_12_76', '6_12_119', '7_9_106', '7_7_104', '6_7_94', '7_8_77', '4_12_85', '6_10_123', '7_11_32', '3_11_26', '4_12_120', '7_9_133', '7_7_137', '5_12_72', '7_8_34', '2_10_133', '7_11_65', '7_8_128', '6_10_129', '5_12_137', '7_7_87', '7_11_47', '6_10_80', '6_10_41', '7_10_71', '6_8_80', '6_9_76', '7_9_109', '6_8_66', '6_10_99', '6_9_40', '3_12_56', '7_10_70', '3_11_22', '4_12_105', '4_11_109', '7_11_94', '6_7_70', '5_10_140', '4_12_11', '2_10_2', '7_10_77', '5_10_31', '3_12_119', '2_10_88', '6_8_81', '6_7_57', '3_12_3', '2_10_100', '7_8_120', '3_11_69', '7_8_108', '7_11_110', '5_12_74', '3_11_55', '7_7_82', '2_12_128', '5_10_28', '3_11_44', '6_10_6', '2_12_93', '7_11_16', '6_10_118', '2_12_38', '7_11_70', '7_11_46', '6_7_77', '4_12_32', '6_12_129', '4_12_121', '4_11_15', '6_9_43', '6_10_0', '7_7_60', '7_10_136', '4_12_130', '6_8_116', '7_9_21', '7_11_111', '7_7_8', '7_9_54', '2_12_123', '3_12_7', '7_10_21', '7_9_76', '6_12_83', '5_12_3', '7_10_133', '5_10_126', '7_8_82', '6_9_36', '6_7_127', '6_10_69', '7_11_56', '3_12_95', '4_11_32', '7_9_58', '7_9_2', '7_8_32', '5_10_77', '6_8_40', '6_10_64', '7_10_140', '4_11_38', '3_11_71', '2_12_67', '2_12_13', '6_12_103', '6_10_17', '6_9_47', '4_11_140', '7_11_57', '2_10_42', '7_10_78', '5_10_133', '7_9_48', '7_11_2', '2_10_92', '5_12_5', '3_11_46', '5_12_103', '7_8_69', '7_8_35', '3_11_72', '7_8_98', '2_12_134', '2_12_114', '6_9_57', '5_12_17', '7_10_1', '4_12_34', '4_11_54', '2_10_81', '5_10_129', '4_11_18', '7_11_71', '2_12_56', '4_12_136', '7_11_38', '7_8_122', '6_7_32', '7_11_133', '6_12_45', '6_7_44', '4_12_52', '5_10_137', '5_12_22', '7_10_66', '7_8_27', '5_10_0', '7_11_60', '2_12_142', '6_9_73', '6_7_115', '7_9_86', '7_9_103', '7_9_119', '7_11_96', '7_7_115', '7_7_117', '7_11_41', '7_11_18', '7_11_69', '6_10_43', '3_12_12', '6_12_42', '5_10_70', '6_12_70', '7_7_2', '3_11_97', '5_10_136', '6_7_27', '7_7_142', '6_7_137', '6_9_96', '5_12_59', '7_10_143', '2_10_5', '7_11_34', '2_10_138', '7_10_113', '5_12_106', '2_12_122', '7_7_64', '6_10_106', '7_9_19', '2_10_8', '5_10_83', '4_12_127', '6_8_113', '7_7_116', '7_7_0', '7_11_129', '2_12_51', '2_12_22', '7_10_76', '6_10_83', '4_12_10', '7_9_68', '7_10_32', '2_10_123', '5_10_50', '3_11_74', '6_8_135', '6_12_75', '4_11_117', '7_8_37', '6_8_21', '7_7_107', '6_7_81', '6_9_33', '2_12_138', '6_8_45', '7_7_121', '4_12_17', '7_10_109', '7_9_26', '6_9_32', '4_11_73', '6_12_6', '3_12_5', '3_12_27', '3_12_20', '6_10_23', '6_10_75', '7_10_101', '3_11_139', '6_9_94', '6_12_111', '6_12_110', '3_11_138', '6_9_72', '4_11_89', '7_7_97', '5_12_7', '6_12_22', '7_8_119', '4_11_56', '4_12_13', '2_12_95', '2_10_103', '2_12_50', '6_7_6', '6_8_134', '5_10_119', '4_12_123', '6_10_57', '2_12_7', '7_11_61', '7_11_104', '5_10_58', '5_12_38', '7_9_72', '6_8_14', '6_8_36', '6_9_20', '3_11_143', '6_10_1', '7_10_59', '6_7_60', '7_8_67', '7_7_50', '3_12_22', '6_9_81', '6_12_32', '5_12_108', '7_10_126', '7_10_95', '3_12_103', '5_12_14', '6_8_138', '7_11_39', '2_10_31', '3_12_89', '7_7_70', '6_7_97', '7_8_140', '7_7_23', '6_7_128', '6_9_88', '6_10_141', '7_10_5', '6_9_114', '6_7_42', '7_8_141', '7_11_127', '3_11_54', '7_11_119', '6_9_122', '5_12_86', '5_10_14', '2_12_131', '7_9_92', '5_10_21', '6_12_43', '6_9_143', '7_10_38', '7_7_36', '7_10_138', '3_11_125', '7_11_64', '5_12_109', '6_9_140', '7_9_59', '3_11_132', '5_10_18', '3_12_57', '5_10_12', '6_8_119', '2_10_71', '7_7_69', '6_12_95', '2_10_75', '3_12_86', '4_11_135', '3_11_142', '6_8_8', '6_9_134', '6_7_80', '6_8_68', '7_8_15', '2_10_24', '3_11_85', '6_12_61', '7_8_28', '6_8_123', '2_12_43', '7_9_91', '6_10_136', '6_7_17', '6_12_123', '7_9_32', '4_12_99', '2_10_118', '7_9_126', '6_8_104', '6_10_13', '7_10_31', '3_12_123', '6_12_21', '6_9_45', '6_12_15', '6_8_37', '6_8_117', '6_8_11', '6_10_82', '7_11_8', '6_7_46', '6_8_126', '7_11_130', '4_11_91', '5_10_13', '4_12_51', '7_11_120', '6_12_58', '7_7_101', '2_10_23', '5_10_57', '7_9_105', '3_12_44', '7_11_20', '4_11_133', '5_10_68', '6_8_15', '3_12_113', '5_10_73', '4_11_24', '4_11_122', '7_9_15', '6_12_86', '4_12_69', '7_9_28', '6_9_103', '6_9_51', '7_9_132', '4_12_72', '5_10_40', '3_12_28', '6_9_49', '3_11_118', '4_12_44', '6_7_79', '7_11_106', '6_10_19', '7_7_46', '7_8_62', '7_9_35', '6_7_31', '5_10_2', '2_10_91', '4_11_65', '6_8_118', '7_8_4', '7_10_112', '2_12_107', '7_10_30', '6_8_143', '7_11_90', '4_12_90', '6_10_98', '7_10_2', '2_10_44', '6_7_36', '2_12_136', '5_12_49', '6_7_120', '6_9_75', '7_8_107', '6_7_138', '2_12_102', '3_11_79', '2_10_3', '6_8_102', '7_9_47', '7_9_110', '5_10_16', '5_10_131', '5_12_71', '3_12_77', '3_11_21', '2_12_29', '5_10_142', '2_10_7', '6_7_29', '5_10_104', '3_12_133', '7_11_116', '2_10_35', '7_7_71', '4_11_82', '6_10_77', '2_10_129', '4_12_1', '6_7_50', '6_9_111', '7_10_104', '6_9_55', '7_9_87', '6_9_41', '7_11_138', '7_10_123', '6_9_26', '5_12_97', '6_12_39', '5_12_43', '4_12_74', '6_9_104', '7_8_72', '6_10_70', '6_8_128', '4_11_74', '7_10_84', '5_10_85', '6_12_53', '4_12_80', '3_11_114', '4_11_3', '4_12_45', '4_12_140', '2_12_72', '3_11_5', '2_12_21', '2_12_48', '4_12_14', '5_10_99', '4_11_120', '4_12_29', '6_10_122', '4_11_37', '7_8_53', '3_12_134', '4_11_58', '6_8_91', '6_10_49', '3_11_52', '7_9_108', '4_11_104', '2_12_61', '6_10_95', '2_12_106', '7_10_40', '5_12_93', '2_12_99', '6_7_96', '6_12_54', '4_12_118', '5_12_123', '4_12_68', '2_10_132', '6_7_134', '7_11_72', '7_11_121', '3_11_33', '7_10_98', '4_11_128', '6_10_114', '6_9_13', '2_10_43', '3_12_110', '5_10_139', '6_9_102', '2_12_83', '3_11_121', '3_11_4', '7_11_50', '7_8_24', '6_12_106', '7_8_112', '4_11_67', '2_12_3', '3_12_6', '2_12_124', '2_10_116', '7_9_61', '5_12_132', '3_12_116', '6_10_120', '7_11_36', '6_12_18', '7_9_73', '6_7_102', '7_9_5', '7_8_19', '2_12_96', '7_7_109', '6_9_69', '3_11_110', '7_7_89', '5_12_24', '7_7_17', '7_7_140', '7_9_117', '2_10_131', '3_12_120', '6_9_23', '3_12_24', '7_8_121', '7_11_15', '4_11_127', '6_8_16', '4_11_40', '6_9_124', '6_7_10', '7_11_76', '6_10_61', '7_10_83', '7_9_20', '6_8_38', '6_7_14', '6_10_132', '3_11_90', '6_7_131', '4_12_12', '3_12_142', '2_10_84', '4_12_63', '4_12_138', '7_10_99', '6_9_1', '7_11_51', '7_11_142', '4_11_80', '6_9_89', '4_11_103', '2_12_118', '3_12_109', '6_12_30', '3_12_36', '3_12_71', '4_12_54', '6_8_86', '7_8_138', '6_10_65', '3_12_131', '7_9_4', '3_12_51', '4_12_61', '6_7_111', '5_12_41', '6_7_41', '3_11_30', '7_7_75', '7_10_129', '4_11_16', '7_7_118', '5_10_88', '4_11_70', '6_7_76', '6_10_56', '5_12_58', '4_12_59', '6_10_18', '3_12_99', '7_8_142', '6_12_34', '7_8_3', '5_10_122', '7_8_48', '6_9_29', '7_8_90', '3_11_78', '2_12_15', '5_10_41', '3_12_32', '6_9_136', '7_7_49', '7_7_22', '7_7_37', '3_12_98', '7_11_54', '7_8_91', '5_12_32', '6_7_75', '7_8_38', '6_8_27', '6_7_45', '5_12_78', '7_8_7', '7_8_89', '2_12_35', '6_7_12', '6_8_6', '4_11_10', '6_12_124', '2_12_57', '6_12_117', '6_8_24', '6_8_34', '7_9_29', '5_10_3', '3_12_21', '2_12_74', '6_8_49', '5_10_111', '6_12_8', '3_12_100', '4_11_19', '4_12_101', '6_10_126', '7_9_71', '7_10_11', '6_12_81', '6_12_79', '6_12_141', '7_9_122', '3_11_75', '5_10_54', '7_11_17', '5_12_25', '7_9_55', '7_10_127', '6_8_87', '7_7_94', '6_12_92', '3_11_36', '5_10_115', '7_10_125', '6_12_48', '2_10_33', '5_12_60', '7_10_44', '2_10_78', '5_12_48', '7_9_53', '4_12_56', '6_7_40', '4_12_50', '6_10_66', '2_12_132', '4_12_5', '3_12_130', '5_10_34', '6_7_69', '3_11_119', '3_12_50', '7_11_10', '3_12_63', '6_7_1', '2_10_48', '2_10_26', '7_7_99', '5_12_99', '7_8_29', '5_10_51', '6_10_142', '7_11_42', '7_11_95', '2_10_124', '2_12_9', '6_10_135', '7_11_13', '6_8_115', '4_11_64', '6_12_128', '5_10_106', '7_8_99', '7_8_93', '7_7_103', '6_8_84', '7_11_99', '6_12_24', '2_12_113', '5_10_124', '2_10_39', '6_12_137', '2_10_18', '7_8_54', '2_12_30', '4_12_4', '7_7_133', '7_7_74', '4_12_137', '6_7_24', '7_11_91', '7_11_92', '3_11_61', '6_9_11', '6_9_99', '2_12_23', '5_12_0', '2_10_16', '5_12_9', '7_8_30', '7_11_80', '6_8_112', '6_7_18', '7_7_56', '4_11_85', '6_10_47', '6_8_124', '5_12_54', '6_8_95', '7_8_97', '7_9_82', '6_10_78', '6_9_139', '7_10_29', '3_11_117', '7_11_26', '6_7_135', '6_10_30', '2_10_41', '5_10_65', '4_11_106', '3_12_104', '6_12_44', '5_10_45', '3_12_66', '4_12_88', '5_10_105', '3_12_138', '5_12_127', '6_10_103', '4_11_87', '3_11_73', '6_8_54', '7_8_52', '2_10_36', '4_11_94', '6_8_130', '6_9_97', '6_9_24', '6_12_3', '3_12_33', '7_11_7', '5_12_52', '6_9_38', '6_7_129', '7_8_10', '6_8_94', '7_10_4', '7_10_130', '2_12_16', '6_9_39', '6_12_46', '3_11_59', '2_12_33', '7_8_131', '3_12_16', '3_11_102', '6_10_96', '6_8_96', '3_12_9', '7_11_11', '6_9_22', '3_11_133', '6_7_119', '7_10_85', '6_9_142', '5_12_138', '6_8_57', '5_12_136', '7_8_68', '7_11_49', '7_7_76', '6_10_28', '2_10_102', '7_8_88', '2_10_125', '7_9_31', '7_8_13', '6_7_98', '6_12_84', '4_11_49', '2_10_55', '2_10_141', '6_12_50', '3_11_91', '5_10_37', '4_12_141', '6_12_20', '6_7_101', '4_11_76', '3_11_58', '7_11_113', '5_10_15', '4_12_139', '3_11_48', '7_7_91', '7_7_20', '7_9_84', '6_9_14', '7_10_47', '4_12_37', '6_10_79', '2_12_126', '3_12_14', '6_10_94', '3_12_126', '2_10_109', '6_7_132', '7_10_24', '7_8_116', '7_9_88', '2_12_19', '6_12_5', '4_11_39', '2_10_4', '6_12_2', '6_9_7', '7_11_117', '6_12_29', '7_9_50', '6_7_140', '7_11_52', '7_10_22', '7_10_128', '4_12_27', '7_10_96', '7_10_117', '7_11_9', '3_11_82', '6_7_100', '3_12_45', '7_10_87', '4_11_95', '6_9_44', '4_11_115', '5_12_87', '5_10_66', '7_9_138', '5_12_139', '2_10_12', '2_10_20', '6_9_56', '6_12_31', '7_7_136', '6_7_118', '7_10_69', '7_8_61', '6_7_66', '6_8_73', '4_11_101', '7_7_81', '7_11_53', '7_11_58', '3_11_87', '3_12_69', '6_12_104', '6_10_29', '6_10_35', '5_10_11', '5_12_50', '5_12_121', '6_8_10', '7_9_95', '6_12_67', '7_9_101', '3_11_27', '7_9_135', '7_7_93', '6_7_114', '4_12_82', '7_9_42', '5_10_55', '3_12_125', '5_10_108', '6_8_20', '3_12_82', '3_12_76', '2_10_56', '4_12_117', '6_10_20', '4_12_73', '4_12_22', '2_12_103', '5_12_116', '7_8_102', '2_10_68', '3_11_140', '3_11_18', '6_10_9', '3_11_20', '6_12_115', '6_7_142', '4_11_29', '7_7_27', '7_10_142', '5_10_141', '3_11_42', '6_9_133', '2_10_15', '2_12_121', '3_11_12', '6_10_91', '6_8_13', '2_10_93', '7_10_64', '4_11_28', '7_9_16', '6_8_29', '2_10_63', '6_7_3', '5_12_125', '7_10_107', '6_7_72', '7_11_84', '4_12_113', '3_12_96', '6_7_103', '5_10_69', '7_9_77', '5_12_4', '3_11_101', '6_8_107', '7_9_33', '7_8_9', '2_10_117', '7_11_27', '7_7_132', '4_11_11', '4_11_57', '4_11_96', '7_8_96', '6_9_8', '6_10_51', '6_7_55', '2_12_58', '7_9_34', '5_12_130', '6_9_119', '5_12_88', '7_10_27', '7_8_85', '6_7_47', '7_11_114', '6_7_58', '5_12_45', '6_12_132', '7_10_55', '5_10_120', '5_12_92', '6_10_86', '2_10_45', '2_10_22', '7_9_79', '7_7_85', '5_12_101', '5_12_94', '5_12_68', '7_7_24', '4_11_132', '4_12_71', '6_8_69', '5_10_49', '2_12_1', '3_12_62', '3_12_54', '7_7_43', '7_9_13', '7_10_37', '6_8_111', '3_11_50', '3_12_128', '4_12_70', '7_9_121', '4_11_98', '2_12_139', '3_11_127', '7_11_75', '5_10_97', '7_8_73', '6_9_137', '6_9_132', '7_7_54', '5_10_64', '6_9_113', '7_7_14', '6_7_67', '7_9_40', '5_12_31', '7_11_5', '5_10_10', '5_12_20', '2_10_105', '3_12_141', '6_10_15', '5_10_22', '3_12_85', '2_10_61', '3_11_29', '2_10_122', '7_8_47', '5_12_100', '6_12_73', '3_12_43', '6_10_117', '4_12_75', '2_10_62', '6_12_96', '3_11_70', '3_11_25', '7_9_43', '7_11_4', '7_10_0', '6_9_82', '6_8_4', '6_7_82', '3_12_10', '6_12_4', '2_10_19', '6_10_37', '3_11_47', '7_8_135', '5_10_96', '6_7_25', '6_7_88', '5_12_82', '2_10_82', '7_10_141', '6_12_87', '7_10_51', '6_8_74', '7_8_65', '6_12_127', '3_11_63', '6_10_100', '5_10_20', '6_10_111', '3_11_23', '6_7_38', '2_10_49', '4_11_59', '2_12_5', '7_11_131', '6_12_143', '7_7_5', '6_8_65', '6_8_120', '6_10_31', '7_11_77', '3_12_74', '4_12_48', '7_11_74', '6_8_105', '2_12_88', '3_11_37', '5_12_142', '4_12_89', '6_9_92', '7_8_45', '7_10_102', '7_8_114', '6_10_128', '7_11_43', '7_9_118', '7_7_141', '7_8_81', '7_11_1', '7_10_14', '4_12_25', '5_12_29', '4_12_125', '4_12_83', '4_12_135', '5_12_117', '6_7_123', '7_8_79', '7_8_110', '6_7_26', '3_11_66', '6_7_85', '6_7_74', '2_10_67', '5_12_44', '7_11_141', '7_10_54', '5_10_1', '5_10_53', '4_11_121', '3_11_96', '6_12_82', '7_7_13', '6_12_85', '5_10_38', '6_8_50', '4_11_48', '3_11_57', '3_12_117', '6_10_3', '7_9_143', '6_9_37', '3_11_45', '4_11_102', '7_10_18', '7_9_1', '3_11_92', '4_11_143', '6_12_100', '3_12_122', '7_8_87', '7_10_68', '7_10_33', '7_7_128', '6_7_105', '6_10_104', '2_12_40', '6_12_62', '6_12_93', '2_12_143', '4_12_92', '7_9_66', '6_9_112', '3_12_65', '7_7_45', '6_9_25', '3_12_59', '2_12_129', '6_10_87', '6_10_102', '7_10_115', '6_8_77', '7_11_78', '7_9_65', '7_10_58', '7_11_25', '4_11_5', '7_7_9', '7_8_17', '2_10_27', '4_12_19', '5_10_71', '6_7_86', '5_10_56', '7_8_40', '7_8_127', '2_12_27', '6_12_69', '4_12_131', '7_7_80', '5_12_18', '2_12_77', '3_12_61', '6_10_7', '6_8_46', '5_10_63', '6_10_34', '2_10_10', '6_9_85', '6_8_23', '2_10_137', '7_8_18', '3_12_106', '2_10_70', '2_10_25', '5_12_63', '5_12_84', '4_11_62', '2_12_109', '2_12_71', '3_11_32', '6_8_71', '6_12_40', '7_8_76', '4_12_38', '3_11_124', '4_11_136', '7_7_7', '2_12_79', '7_11_66', '3_12_0', '7_10_89', '4_12_57', '7_11_23', '5_12_114', '5_10_117', '4_12_132', '3_12_40', '5_12_135', '6_9_19', '7_11_86', '7_11_88', '7_10_75', '3_12_17', '7_7_114', '6_12_16', '7_10_9', '6_8_93', '6_8_129', '2_12_49', '7_8_39', '4_11_112', '2_10_40', '6_10_12', '6_7_108', '5_10_30', '3_12_25', '6_7_143', '7_9_104', '5_12_67', '7_10_6', '4_12_36', '6_12_77', '2_10_127', '2_12_76', '2_10_13', '5_10_46', '4_11_1', '6_7_78', '7_8_100', '5_10_112', '6_12_11', '6_7_110', '4_12_79', '3_11_65', '6_8_92', '7_8_103', '7_9_57', '6_12_116', '4_11_0', '7_9_39', '4_12_81', '7_11_45', '7_10_79', '2_12_36', '3_11_2', '6_10_45', '7_7_29', '6_12_28', '7_9_85', '4_12_93', '5_12_42', '3_11_49', '6_9_138', '6_12_47', '7_8_26', '3_11_137', '6_7_84', '7_7_90', '6_12_94', '3_12_46', '7_10_28', '6_7_122', '3_12_38', '6_12_71', '7_10_26']

    test_ids = ['4_10_49', '5_11_19', '6_11_102', '7_12_40', '6_11_85', '7_12_47', '2_11_126', '2_11_56', '2_11_100', '6_11_74', '4_10_53', '7_12_63', '2_11_102', '3_10_117', '3_10_41', '5_11_120', '7_12_110', '4_10_124', '7_12_51', '7_12_91', '6_11_106', '3_10_14', '5_11_9', '5_11_71', '6_11_94', '5_11_112', '7_12_50', '5_11_45', '5_11_53', '3_10_48', '7_12_105', '5_11_139', '7_12_112', '4_10_44', '7_12_129', '6_11_100', '7_12_18', '3_10_13', '5_11_57', '5_11_48', '3_10_26', '5_11_52', '2_11_53', '5_11_127', '6_11_138', '3_10_92', '6_11_73', '6_11_98', '7_12_68', '6_11_0', '5_11_10', '4_10_76', '5_11_128', '5_11_137', '7_12_20', '6_11_116', '6_11_81', '7_12_143', '2_11_134', '4_10_7', '3_10_107', '6_11_137', '5_11_86', '2_11_48', '5_11_42', '5_11_92', '3_10_53', '5_11_25', '3_10_66', '6_11_48', '4_10_102', '5_11_55', '2_11_78', '2_11_61', '2_11_19', '5_11_99', '6_11_134', '4_10_11', '5_11_38', '7_12_11', '2_11_91', '4_10_47', '5_11_30', '6_11_139', '3_10_114', '6_11_56', '3_10_110', '4_10_121', '5_11_82', '3_10_7', '6_11_25', '3_10_122', '7_12_128', '3_10_49', '3_10_16', '2_11_132', '4_10_101', '5_11_54', '7_12_104', '5_11_21', '7_12_12', '5_11_106', '3_10_62', '2_11_55', '4_10_129', '3_10_106', '6_11_37', '5_11_95', '5_11_33', '2_11_97', '5_11_22', '4_10_13', '6_11_79', '6_11_31', '5_11_104', '3_10_54', '6_11_57', '4_10_62', '2_11_74', '4_10_39', '5_11_83', '2_11_8', '3_10_141', '2_11_49', '7_12_10', '2_11_58', '6_11_95', '5_11_72', '3_10_55', '7_12_138', '5_11_97', '5_11_8', '6_11_70', '3_10_29', '3_10_21', '5_11_67', '3_10_77', '5_11_77', '6_11_121', '3_10_72', '4_10_68', '7_12_38', '3_10_73', '4_10_35', '4_10_5', '5_11_109', '6_11_54', '5_11_32', '2_11_107', '4_10_36', '7_12_137', '5_11_132', '7_12_4', '6_11_14', '4_10_80', '2_11_140', '7_12_123', '2_11_45', '3_10_70', '2_11_117', '5_11_34', '2_11_51', '2_11_67', '6_11_40', '5_11_16', '3_10_27', '7_12_54', '4_10_38', '6_11_90', '2_11_42', '3_10_11', '6_11_126', '3_10_42', '7_12_87', '7_12_64', '5_11_98', '7_12_46', '2_11_103', '6_11_16', '3_10_38', '7_12_48', '3_10_131', '3_10_133', '3_10_74', '2_11_131', '2_11_120', '7_12_35', '6_11_13', '2_11_121', '3_10_1', '6_11_108', '5_11_143', '4_10_66', '5_11_68', '3_10_34', '5_11_117', '7_12_1', '3_10_82', '3_10_71', '3_10_69', '7_12_37', '5_11_73', '2_11_38', '6_11_97', '2_11_20', '4_10_60', '7_12_13', '6_11_17', '7_12_9', '6_11_115', '5_11_28', '4_10_113', '6_11_9', '2_11_32', '4_10_112', '4_10_88', '4_10_75', '7_12_109', '3_10_25', '4_10_45', '4_10_10', '7_12_122', '2_11_82', '4_10_19', '5_11_39', '4_10_83', '3_10_139', '3_10_83', '3_10_18', '5_11_26', '5_11_107', '4_10_28', '4_10_72', '5_11_105', '7_12_3', '7_12_114', '5_11_41', '5_11_136', '5_11_12', '4_10_18', '2_11_9', '7_12_57', '2_11_28', '7_12_14', '5_11_5', '7_12_127', '2_11_26', '2_11_17', '2_11_27', '2_11_113', '6_11_3', '6_11_131', '7_12_17', '7_12_59', '2_11_24', '7_12_67', '7_12_95', '7_12_19', '7_12_85', '7_12_88', '4_10_108', '7_12_93', '3_10_96', '4_10_4', '4_10_57', '6_11_123', '3_10_44', '7_12_77', '6_11_51', '2_11_16', '5_11_96', '6_11_99', '2_11_127', '3_10_116', '2_11_68', '2_11_105', '6_11_52', '2_11_106', '5_11_63', '6_11_49', '5_11_93', '7_12_44', '6_11_24', '6_11_15', '6_11_92', '7_12_16', '6_11_19', '2_11_40', '2_11_62', '7_12_27', '3_10_60', '7_12_111', '2_11_1', '4_10_114', '7_12_121', '2_11_57', '7_12_33', '2_11_125', '7_12_141', '2_11_139', '5_11_133', '2_11_130', '6_11_36', '4_10_71', '4_10_109', '4_10_70', '3_10_67', '3_10_100', '2_11_98', '2_11_84', '3_10_24', '6_11_136', '3_10_126', '7_12_29', '3_10_61', '6_11_55', '4_10_1', '3_10_90', '2_11_65', '2_11_112', '7_12_116', '3_10_33', '4_10_50', '4_10_48', '7_12_96', '3_10_113', '2_11_22', '7_12_136', '4_10_55', '5_11_85', '4_10_30', '2_11_86', '6_11_83', '2_11_77', '7_12_22', '4_10_16', '5_11_78', '4_10_52', '6_11_93', '5_11_75', '2_11_128', '5_11_1', '6_11_77', '2_11_12', '4_10_69', '3_10_76', '7_12_97', '5_11_129', '3_10_129', '7_12_99', '4_10_64', '2_11_133', '2_11_124', '4_10_131', '7_12_23', '2_11_2', '7_12_25', '7_12_80', '6_11_128', '6_11_2', '6_11_66', '2_11_46', '2_11_93', '7_12_58', '6_11_101', '4_10_92', '7_12_0', '4_10_116', '4_10_79', '3_10_50', '4_10_81', '4_10_105', '4_10_54', '6_11_107', '4_10_134', '6_11_41', '6_11_21', '6_11_4', '5_11_40', '6_11_12', '7_12_34', '2_11_90', '7_12_42', '3_10_15', '2_11_137', '4_10_103', '4_10_99', '2_11_88', '5_11_35', '4_10_21', '5_11_43', '4_10_22', '6_11_22', '3_10_86', '5_11_44', '2_11_60', '2_11_136', '4_10_42', '4_10_41', '3_10_99', '5_11_111', '2_11_135', '2_11_10', '3_10_109', '7_12_74', '2_11_25', '4_10_26', '2_11_5', '3_10_68', '3_10_95', '4_10_100', '6_11_62', '3_10_59', '6_11_96', '2_11_11', '5_11_125', '3_10_2', '5_11_113', '5_11_90', '5_11_29', '3_10_98', '4_10_136', '2_11_101', '6_11_91', '5_11_88', '2_11_95', '4_10_133', '5_11_4', '6_11_39', '2_11_47', '2_11_73', '7_12_132', '4_10_46', '5_11_46', '4_10_137', '4_10_91', '6_11_103', '4_10_51', '6_11_50', '4_10_40', '7_12_66', '7_12_62', '5_11_24', '4_10_65', '3_10_10', '7_12_92', '2_11_66', '5_11_50', '5_11_80', '4_10_140', '6_11_130', '4_10_142', '3_10_5', '6_11_30', '2_11_14', '3_10_130', '7_12_15', '7_12_30', '7_12_107', '7_12_81', '5_11_51', '5_11_47', '5_11_70', '6_11_29', '5_11_118', '5_11_87', '5_11_102', '6_11_87', '3_10_124', '5_11_59', '3_10_63', '3_10_118', '6_11_119', '3_10_84', '2_11_4', '6_11_69', '4_10_93', '2_11_118', '6_11_141', '2_11_142', '3_10_43', '4_10_122', '4_10_90', '5_11_0', '3_10_123', '6_11_44', '6_11_28', '7_12_140', '2_11_30', '7_12_41', '7_12_45', '5_11_76', '4_10_12', '4_10_110', '4_10_78', '5_11_108', '6_11_132', '2_11_35', '3_10_127', '3_10_89', '4_10_31', '7_12_31', '5_11_60', '7_12_83', '3_10_97', '4_10_120', '6_11_64', '4_10_6', '5_11_110', '4_10_143', '4_10_67', '2_11_123', '6_11_59', '3_10_46', '6_11_89', '2_11_83', '2_11_59', '7_12_69', '5_11_56', '5_11_89', '2_11_109', '6_11_35', '2_11_71', '7_12_60', '2_11_64', '5_11_61', '6_11_5', '2_11_39', '6_11_84', '3_10_134', '4_10_139', '5_11_138', '5_11_6', '2_11_75', '6_11_45', '4_10_106', '4_10_74', '3_10_79', '3_10_91', '5_11_66', '3_10_0', '3_10_138', '7_12_102', '2_11_52', '2_11_94', '4_10_56', '5_11_141', '4_10_14', '3_10_120', '2_11_70', '2_11_63', '5_11_114', '3_10_102', '7_12_131', '7_12_118', '3_10_45', '3_10_19', '4_10_29', '4_10_59', '6_11_76', '7_12_100', '7_12_89', '4_10_98', '3_10_9', '3_10_93', '6_11_120', '3_10_80', '3_10_32', '3_10_142', '6_11_122', '6_11_80', '5_11_94', '6_11_38', '3_10_12', '5_11_36', '7_12_82', '2_11_7', '3_10_108', '3_10_132', '5_11_124', '5_11_126', '4_10_132', '4_10_119', '6_11_142', '4_10_8', '4_10_127', '6_11_114', '5_11_13', '4_10_15', '6_11_34', '5_11_122', '5_11_3', '5_11_69', '2_11_129', '6_11_127', '7_12_21', '6_11_33', '7_12_53', '2_11_85', '7_12_106', '2_11_36', '3_10_105', '6_11_124', '7_12_126', '5_11_18', '4_10_97', '3_10_39', '6_11_78', '5_11_116', '2_11_141', '3_10_23', '7_12_94', '5_11_131', '6_11_32', '3_10_64', '2_11_104', '5_11_115', '2_11_15', '3_10_101', '3_10_112', '3_10_52', '3_10_31', '2_11_54', '7_12_55', '7_12_32', '3_10_85', '2_11_119', '3_10_135', '6_11_71', '2_11_92', '2_11_33', '7_12_90', '5_11_64', '6_11_42', '5_11_101', '5_11_7', '2_11_110', '7_12_113', '7_12_86', '5_11_81', '7_12_75', '4_10_89', '5_11_65', '7_12_39', '5_11_135', '5_11_91', '6_11_1', '4_10_117', '3_10_81', '7_12_78', '3_10_104', '2_11_44', '7_12_142', '3_10_57', '7_12_6', '7_12_73', '6_11_112', '5_11_84', '6_11_46', '3_10_136', '7_12_5', '6_11_88', '5_11_31', '4_10_61', '2_11_79', '4_10_77', '5_11_49', '7_12_76', '7_12_124', '3_10_37', '2_11_31', '6_11_65', '7_12_61', '3_10_111', '3_10_125', '5_11_20', '5_11_23', '6_11_68', '7_12_26', '7_12_135', '6_11_6', '4_10_118', '4_10_135', '6_11_140', '4_10_27', '4_10_3', '3_10_6', '6_11_129', '6_11_113', '2_11_43', '3_10_20', '5_11_58', '3_10_65', '2_11_115', '4_10_73', '5_11_79', '6_11_67', '7_12_72', '5_11_37', '6_11_72', '5_11_100', '7_12_49', '2_11_122', '5_11_74', '4_10_34', '3_10_140', '4_10_58', '4_10_111', '5_11_103', '7_12_119', '5_11_140', '4_10_86', '3_10_87', '4_10_94', '4_10_63', '3_10_40', '5_11_11', '5_11_130', '7_12_101', '4_10_43', '2_11_81', '3_10_17', '4_10_0', '2_11_76', '2_11_143', '6_11_11', '3_10_58', '4_10_9', '7_12_139', '5_11_123', '6_11_27', '7_12_125', '3_10_103', '6_11_58', '7_12_56', '2_11_50', '2_11_6', '5_11_119', '2_11_21', '2_11_138', '5_11_121', '4_10_24', '2_11_3', '2_11_34', '4_10_2', '7_12_79', '2_11_37', '7_12_130', '6_11_20', '4_10_138', '2_11_13', '2_11_114', '6_11_63', '2_11_29', '4_10_32', '2_11_99', '7_12_115', '5_11_15', '2_11_108', '4_10_20', '3_10_121', '6_11_118', '3_10_8', '6_11_110', '7_12_8', '3_10_119', '6_11_105', '7_12_133', '3_10_28', '2_11_72', '6_11_61', '3_10_36', '7_12_36', '6_11_60', '3_10_56', '6_11_47', '5_11_2', '5_11_62', '2_11_116', '4_10_33', '6_11_135', '2_11_23', '2_11_87', '7_12_120', '2_11_0', '3_10_115', '5_11_134', '3_10_137', '6_11_109', '3_10_4', '4_10_104', '4_10_107', '7_12_84', '3_10_3', '3_10_22', '4_10_82', '4_10_23', '4_10_87', '7_12_71', '2_11_89', '7_12_24', '6_11_111', '3_10_94', '3_10_143', '4_10_123', '4_10_126', '6_11_53', '2_11_41', '6_11_143', '7_12_108', '6_11_117', '5_11_17', '6_11_86', '6_11_75', '7_12_103', '7_12_7', '3_10_51', '7_12_70', '4_10_84', '3_10_75', '4_10_141', '2_11_69', '6_11_82', '6_11_7', '7_12_52', '5_11_14', '6_11_10', '6_11_26', '7_12_2', '6_11_125', '2_11_80', '3_10_35', '2_11_18', '6_11_133', '3_10_78', '7_12_28', '4_10_37', '3_10_128', '5_11_142', '7_12_98', '7_12_65', '2_11_96', '7_12_134', '6_11_23', '3_10_47', '6_11_8', '2_11_111', '6_11_43', '3_10_30', '4_10_85', '3_10_88', '5_11_27', '4_10_130', '4_10_128', '4_10_95', '4_10_115', '6_11_104', '4_10_96', '4_10_25', '4_10_125', '7_12_117', '7_12_43', '6_11_18', '4_10_17']

    Stride_Size = 128
    FOLDER = "/data5/GLGAN/datasets/"
    LABELS = ["roads", "buildings", "low veg.", "trees", "cars", "clutter"]
    N_CLASSES = len(LABELS) # Number of classes
    WEIGHTS = torch.ones(N_CLASSES) # Weights for class balancing
    MAIN_FOLDER = FOLDER + 'postdam/'
    DATA_FOLDER = MAIN_FOLDER + 'img_512/{}.tif'
    LABEL_FOLDER = MAIN_FOLDER + 'label_512/{}.tif'
    BOUNDARY_FOLDER = MAIN_FOLDER + 'depth_512_1/{}.png'
    OBJECT_FOLDER = MAIN_FOLDER + 'depth_512_1/{}.png'
    ERODED_FOLDER = MAIN_FOLDER + 'label_512/{}.tif'
    # palette = {0 : (255, 255, 255), # background
    #        1 : (255, 0, 0),     # building
    #        2 : (255, 255, 0),   # road
    #        3 : (0, 0, 255),     # water
    #        4 : (159, 129, 183), # barren
    #        5 : (0, 255, 0),     # forest
    #        6 : (255, 195, 128)} # agriculture
    palette = {0: (255, 255, 255),  # Impervious surfaces (white)
               1: (0, 0, 255),  # Buildings (blue)
               2: (0, 255, 255),  # Low vegetation (cyan)
               3: (0, 255, 0),  # Trees (green)
               4: (255, 255, 0),  # Cars (yellow)
               5: (255, 0, 0),  # Clutter (red)
               6: (0, 0, 0)}  # Undefined (black)
    invert_palette = {v: k for k, v in palette.items()}




# 使用该数据集时，请跳转到914行，只统计前五类的miou
if DATASET == 'Vaihingen':


    train_ids = ['13_23', '32_19', '34_2', '11_2', '3_6', '32_0', '11_8', '1_11', '23_1', '7_2', '32_3', '13_11', '3_0', '7_5', '7_15', '28_20', '23_7', '11_0', '13_7', '26_13', '1_21', '23_15', '26_4', '28_12', '1_20', '28_11', '37_14', '13_27', '3_23', '32_18', '7_11', '26_15', '23_10', '13_16', '13_24', '1_7', '34_12', '3_3', '28_21', '11_4', '7_19', '11_13', '17_2', '28_19', '23_5', '3_11', '26_14', '1_12', '28_9', '32_4', '13_10', '34_9', '17_12', '23_17', '13_3', '32_1', '37_0', '3_4', '34_11', '7_18', '26_10', '34_0', '17_3', '7_12', '1_1', '1_19', '26_1', '13_9', '28_18', '3_20', '17_4', '32_14', '28_17', '34_5', '37_13', '11_19', '3_14', '1_3', '28_14', '11_23', '11_17', '17_10', '23_2', '26_17', '32_10', '26_23', '7_7', '13_22', '11_21', '3_17', '37_3', '7_9', '13_6', '17_7', '1_16', '17_6', '7_0', '13_1', '28_15', '17_9', '3_19', '34_10', '23_18', '26_18', '26_12', '1_2', '23_12', '13_5', '34_13', '32_9', '28_0', '28_2', '26_8', '32_13', '28_3', '7_13', '3_21', '13_8', '13_0', '3_15', '1_9', '13_17', '13_21', '1_0', '7_1', '17_13', '37_1', '23_6', '28_5', '32_17', '11_9', '32_6', '13_2', '28_10', '1_18', '28_4', '26_7', '26_11', '23_4', '7_17', '3_12', '26_20', '28_13', '37_6', '17_14', '28_7', '34_3', '1_14', '1_8', '17_11', '3_1', '17_1', '37_12', '26_16', '37_7', '13_15', '28_16', '1_10', '37_11', '7_4', '13_14', '11_22', '13_29', '3_8', '26_2', '17_0', '11_16', '34_7', '23_14', '32_15', '26_6', '1_22', '37_5', '11_10', '7_8', '26_3', '1_5', '32_11', '11_14', '3_7', '7_6', '26_5', '7_14', '13_13', '28_8', '13_28', '11_11', '11_20', '23_8', '11_3', '13_20', '17_5', '32_8', '37_4', '28_6', '34_1', '13_12', '32_7', '32_16', '23_11', '11_7', '3_22', '1_23', '3_2', '1_17', '3_13', '3_16', '28_22', '23_9', '34_14', '11_1', '34_6', '13_4', '37_2', '11_5', '23_3', '23_13', '7_16', '32_5', '32_12', '37_10', '32_2', '26_9', '37_15', '28_1', '37_8', '26_22', '13_25', '26_21', '26_0', '1_15', '37_9', '11_18', '34_4', '13_26', '13_18', '1_13', '3_18', '1_4', '3_10', '7_3', '7_10', '1_6', '26_19', '11_15', '34_8', '23_0', '11_12', '3_5', '23_19', '13_19', '28_23', '3_9', '23_16', '11_6', '17_8']

    test_ids = ['30_1', '5_6', '15_3', '15_22', '30_2', '15_4', '30_18', '15_16', '5_1', '15_9', '30_4', '5_0', '30_21', '5_7', '30_16', '15_7', '5_8', '21_13', '30_5', '21_0', '21_6', '21_18', '15_11', '30_7', '5_12', '5_10', '15_23', '15_17', '30_8', '15_20', '30_11', '30_14', '5_11', '15_5', '5_9', '21_17', '21_16', '15_10', '30_23', '30_10', '15_0', '30_0', '30_22', '15_21', '15_14', '30_20', '15_12', '30_15', '30_9', '15_6', '30_13', '15_2', '5_3', '5_13', '15_1', '21_5', '21_8', '21_1', '15_18', '30_6', '5_5', '15_15', '21_10', '21_12', '15_13', '21_15', '15_19', '21_19', '21_7', '30_19', '5_4', '21_14', '21_4', '5_18', '5_17', '30_12', '30_3', '5_19', '5_2', '30_17', '21_2', '5_14', '21_9', '5_16', '21_11', '21_3', '15_8', '5_15']

    Stride_Size = 128
    FOLDER = "/data5/GLGAN/datasets/"
    LABELS = ["roads", "buildings", "low veg.", "trees", "cars", "clutter"]
    N_CLASSES = len(LABELS) # Number of classes
    WEIGHTS = torch.ones(N_CLASSES) # Weights for class balancing
    MAIN_FOLDER = FOLDER + 'vaihingen/'
    DATA_FOLDER = MAIN_FOLDER + 'img_512/{}.tif'
    LABEL_FOLDER = MAIN_FOLDER + 'label_512/{}.tif'
    BOUNDARY_FOLDER = MAIN_FOLDER + 'depth_512_1/{}.png'
    OBJECT_FOLDER = MAIN_FOLDER + 'depth_512_1/{}.png'
    ERODED_FOLDER = MAIN_FOLDER + 'label_512/{}.tif'

if DATASET == 'Loveda':

    train_ids = ['0','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','179','180','181','182','183','184','185','186','187','188','189','190','191','192','193','194','195','196','197','198','199','200','201','202','203','204','205','206','207','208','209','210','211','212','213','214','215','216','217','218','219','220','221','222','223','224','225','226','227','228','229','230','231','232','233','234','235','236','237','238','239','240','241','242','243','244','245','246','247','248','249','250','251','252','253','254','255','256','257','258','259','260','261','262','263','264','265','266','267','268','269','270','271','272','273','274','275','276','277','278','279','280','281','282','283','284','285','286','287','288','289','290','291','292','293','294','295','296','297','298','299','300','301','302','303','304','305','306','307','308','309','310','311','312','313','314','315','316','317','318','319','320','321','322','323','324','325','326','327','328','329','330','331','332','333','334','335','336','337','338','339','340','341','342','343','344','345','346','347','348','349','350','351','352','353','354','355','356','357','358','359','360','361','362','363','364','365','366','367','368','369','370','371','372','373','374','375','376','377','378','379','380','381','382','383','384','385','386','387','388','389','390','391','392','393','394','395','396','397','398','399','400','401','402','403','404','405','406','407','408','409','410','411','412','413','414','415','416','417','418','419','420','421','422','423','424','425','426','427','428','429','430','431','432','433','434','435','436','437','438','439','440','441','442','443','444','445','446','447','448','449','450','451','452','453','454','455','456','457','458','459','460','461','462','463','464','465','466','467','468','469','470','471','472','473','474','475','476','477','478','479','480','481','482','483','484','485','486','487','488','489','490','491','492','493','494','495','496','497','498','499','500','501','502','503','504','505','506','507','508','509','510','511','512','513','514','515','516','517','518','519','520','521','522','523','524','525','526','527','528','529','530','531','532','533','534','535','536','537','538','539','540','541','542','543','544','545','546','547','548','549','550','551','552','553','554','555','556','557','558','559','560','561','562','563','564','565','566','567','568','569','570','571','572','573','574','575','576','577','578','579','580','581','582','583','584','585','586','587','588','589','590','591','592','593','594','595','596','597','598','599','600','601','602','603','604','605','606','607','608','609','610','611','612','613','614','615','616','617','618','619','620','621','622','623','624','625','626','627','628','629','630','631','632','633','634','635','636','637','638','639','640','641','642','643','644','645','646','647','648','649','650','651','652','653','654','655','656','657','658','659','660','661','662','663','664','665','666','667','668','669','670','671','672','673','674','675','676','677','678','679','680','681','682','683','684','685','686','687','688','689','690','691','692','693','694','695','696','697','698','699','700','701','702','703','704','705','706','707','708','709','710','711','712','713','714','715','716','717','718','719','720','721','722','723','724','725','726','727','728','729','730','731','732','733','734','735','736','737','738','739','740','741','742','743','744','745','746','747','748','749','750','751','752','753','754','755','756','757','758','759','760','761','762','763','764','765','766','767','768','769','770','771','772','773','774','775','776','777','778','779','780','781','782','783','784','785','786','787','788','789','790','791','792','793','794','795','796','797','798','799','800','801','802','803','804','805','806','807','808','809','810','811','812','813','814','815','816','817','818','819','820','821','822','823','824','825','826','827','828','829','830','831','832','833','834','835','836','837','838','839','840','841','842','843','844','845','846','847','848','849','850','851','852','853','854','855','856','857','858','859','860','861','862','863','864','865','866','867','868','869','870','871','872','873','874','875','876','877','878','879','880','881','882','883','884','885','886','887','888','889','890','891','892','893','894','895','896','897','898','899','900','901','902','903','904','905','906','907','908','909','910','911','912','913','914','915','916','917','918','919','920','921','922','923','924','925','926','927','928','929','930','931','932','933','934','935','936','937','938','939','940','941','942','943','944','945','946','947','948','949','950','951','952','953','954','955','956','957','958','959','960','961','962','963','964','965','966','967','968','969','970','971','972','973','974','975','976','977','978','979','980','981','982','983','984','985','986','987','988','989','990','991','992','993','994','995','996','997','998','999','1000','1001','1002','1003','1004','1005','1006','1007','1008','1009','1010','1011','1012','1013','1014','1015','1016','1017','1018','1019','1020','1021','1022','1023','1024','1025','1026','1027','1028','1029','1030','1031','1032','1033','1034','1035','1036','1037','1038','1039','1040','1041','1042','1043','1044','1045','1046','1047','1048','1049','1050','1051','1052','1053','1054','1055','1056','1057','1058','1059','1060','1061','1062','1063','1064','1065','1066','1067','1068','1069','1070','1071','1072','1073','1074','1075','1076','1077','1078','1079','1080','1081','1082','1083','1084','1085','1086','1087','1088','1089','1090','1091','1092','1093','1094','1095','1096','1097','1098','1099','1100','1101','1102','1103','1104','1105','1106','1107','1108','1109','1110','1111','1112','1113','1114','1115','1116','1117','1118','1119','1120','1121','1122','1123','1124','1125','1126','1127','1128','1129','1130','1131','1132','1133','1134','1135','1136','1137','1138','1139','1140','1141','1142','1143','1144','1145','1146','1147','1148','1149','1150','1151','1152','1153','1154','1155','1156','1157','1158','1159','1160','1161','1162','1163','1164','1165','1166','1167','1168','1169','1170','1171','1172','1173','1174','1175','1176','1177','1178','1179','1180','1181','1182','1183','1184','1185','1186','1187','1188','1189','1190','1191','1192','1193','1194','1195','1196','1197','1198','1199','1200','1201','1202','1203','1204','1205','1206','1207','1208','1209','1210','1211','1212','1213','1214','1215','1216','1217','1218','1219','1220','1221','1222','1223','1224','1225','1226','1227','1228','1229','1230','1231','1232','1233','1234','1235','1236','1237','1238','1239','1240','1241','1242','1243','1244','1245','1246','1247','1248','1249','1250','1251','1252','1253','1254','1255','1256','1257','1258','1259','1260','1261','1262','1263','1264','1265','1266','1267','1268','1269','1270','1271','1272','1273','1274','1275','1276','1277','1278','1279','1280','1281','1282','1283','1284','1285','1286','1287','1288','1289','1290','1291','1292','1293','1294','1295','1296','1297','1298','1299','1300','1301','1302','1303','1304','1305','1306','1307','1308','1309','1310','1311','1312','1313','1314','1315','1316','1317','1318','1319','1320','1321','1322','1323','1324','1325','1326','1327','1328','1329','1330','1331','1332','1333','1334','1335','1336','1337','1338','1339','1340','1341','1342','1343','1344','1345','1346','1347','1348','1349','1350','1351','1352','1353','1354','1355','1356','1357','1358','1359','1360','1361','1362','1363','1364','1365','1366','1367','1368','1369','1370','1371','1372','1373','1374','1375','1376','1377','1378','1379','1380','1381','1382','1383','1384','1385','1386','1387','1388','1389','1390','1391','1392','1393','1394','1395','1396','1397','1398','1399','1400','1401','1402','1403','1404','1405','1406','1407','1408','1409','1410','1411','1412','1413','1414','1415','1416','1417','1418','1419','1420','1421','1422','1423','1424','1425','1426','1427','1428','1429','1430','1431','1432','1433','1434','1435','1436','1437','1438','1439','1440','1441','1442','1443','1444','1445','1446','1447','1448','1449','1450','1451','1452','1453','1454','1455','1456','1457','1458','1459','1460','1461','1462','1463','1464','1465','1466','1467','1468','1469','1470','1471','1472','1473','1474','1475','1476','1477','1478','1479','1480','1481','1482','1483','1484','1485','1486','1487','1488','1489','1490','1491','1492','1493','1494','1495','1496','1497','1498','1499','1500','1501','1502','1503','1504','1505','1506','1507','1508','1509','1510','1511','1512','1513','1514','1515','1516','1517','1518','1519','1520','1521','1522','1523','1524','1525','1526','1527','1528','1529','1530','1531','1532','1533','1534','1535','1536','1537','1538','1539','1540','1541','1542','1543','1544','1545','1546','1547','1548','1549','1550','1551','1552','1553','1554','1555','1556','1557','1558','1559','1560','1561','1562','1563','1564','1565','1566','1567','1568','1569','1570','1571','1572','1573','1574','1575','1576','1577','1578','1579','1580','1581','1582','1583','1584','1585','1586','1587','1588','1589','1590','1591','1592','1593','1594','1595','1596','1597','1598','1599','1600','1601','1602','1603','1604','1605','1606','1607','1608','1609','1610','1611','1612','1613','1614','1615','1616','1617','1618','1619','1620','1621','1622','1623','1624','1625','1626','1627','1628','1629','1630','1631','1632','1633','1634','1635','1636','1637','1638','1639','1640','1641','1642','1643','1644','1645','1646','1647','1648','1649','1650','1651','1652','1653','1654','1655','1656','1657','1658','1659','1660','1661','1662','1663','1664','1665','1666','1667','1668','1669','1670','1671','1672','1673','1674','1675','1676','1677','1678','1679','1680','1681','1682','1683','1684','1685','1686','1687','1688','1689','1690','1691','1692','1693','1694','1695','1696','1697','1698','1699','1700','1701','1702','1703','1704','1705','1706','1707','1708','1709','1710','1711','1712','1713','1714','1715','1716','1717','1718','1719','1720','1721','1722','1723','1724','1725','1726','1727','1728','1729','1730','1731','1732','1733','1734','1735','1736','1737','1738','1739','1740','1741','1742','1743','1744','1745','1746','1747','1748','1749','1750','1751','1752','1753','1754','1755','1756','1757','1758','1759','1760','1761','1762','1763','1764','1765','1766','1767','1768','1769','1770','1771','1772','1773','1774','1775','1776','1777','1778','1779','1780','1781','1782','1783','1784','1785','1786','1787','1788','1789','1790','1791','1792','1793','1794','1795','1796','1797','1798','1799','1800','1801','1802','1803','1804','1805','1806','1807','1808','1809','1810','1811','1812','1813','1814','1815','1816','1817','1818','1819','1820','1821','1822','1823','1824','1825','1826','1827','1828','1829','1830','1831','1832','1833','1834','1835','1836','1837','1838','1839','1840','1841','1842','1843','1844','1845','1846','1847','1848','1849','1850','1851','1852','1853','1854','1855','1856','1857','1858','1859','1860','1861','1862','1863','1864','1865','1866','1867','1868','1869','1870','1871','1872','1873','1874','1875','1876','1877','1878','1879','1880','1881','1882','1883','1884','1885','1886','1887','1888','1889','1890','1891','1892','1893','1894','1895','1896','1897','1898','1899','1900','1901','1902','1903','1904','1905','1906','1907','1908','1909','1910','1911','1912','1913','1914','1915','1916','1917','1918','1919','1920','1921','1922','1923','1924','1925','1926','1927','1928','1929','1930','1931','1932','1933','1934','1935','1936','1937','1938','1939','1940','1941','1942','1943','1944','1945','1946','1947','1948','1949','1950','1951','1952','1953','1954','1955','1956','1957','1958','1959','1960','1961','1962','1963','1964','1965','1966','1967','1968','1969','1970','1971','1972','1973','1974','1975','1976','1977','1978','1979','1980','1981','1982','1983','1984','1985','1986','1987','1988','1989','1990','1991','1992','1993','1994','1995','1996','1997','1998','1999','2000','2001','2002','2003','2004','2005','2006','2007','2008','2009','2010','2011','2012','2013','2014','2015','2016','2017','2018','2019','2020','2021','2022','2023','2024','2025','2026','2027','2028','2029','2030','2031','2032','2033','2034','2035','2036','2037','2038','2039','2040','2041','2042','2043','2044','2045','2046','2047','2048','2049','2050','2051','2052','2053','2054','2055','2056','2057','2058','2059','2060','2061','2062','2063','2064','2065','2066','2067','2068','2069','2070','2071','2072','2073','2074','2075','2076','2077','2078','2079','2080','2081','2082','2083','2084','2085','2086','2087','2088','2089','2090','2091','2092','2093','2094','2095','2096','2097','2098','2099','2100','2101','2102','2103','2104','2105','2106','2107','2108','2109','2110','2111','2112','2113','2114','2115','2116','2117','2118','2119','2120','2121','2122','2123','2124','2125','2126','2127','2128','2129','2130','2131','2132','2133','2134','2135','2136','2137','2138','2139','2140','2141','2142','2143','2144','2145','2146','2147','2148','2149','2150','2151','2152','2153','2154','2155','2156','2157','2158','2159','2160','2161','2162','2163','2164','2165','2166','2167','2168','2169','2170','2171','2172','2173','2174','2175','2176','2177','2178','2179','2180','2181','2182','2183','2184','2185','2186','2187','2188','2189','2190','2191','2192','2193','2194','2195','2196','2197','2198','2199','2200','2201','2202','2203','2204','2205','2206','2207','2208','2209','2210','2211','2212','2213','2214','2215','2216','2217','2218','2219','2220','2221','2222','2223','2224','2225','2226','2227','2228','2229','2230','2231','2232','2233','2234','2235','2236','2237','2238','2239','2240','2241','2242','2243','2244','2245','2246','2247','2248','2249','2250','2251','2252','2253','2254','2255','2256','2257','2258','2259','2260','2261','2262','2263','2264','2265','2266','2267','2268','2269','2270','2271','2272','2273','2274','2275','2276','2277','2278','2279','2280','2281','2282','2283','2284','2285','2286','2287','2288','2289','2290','2291','2292','2293','2294','2295','2296','2297','2298','2299','2300','2301','2302','2303','2304','2305','2306','2307','2308','2309','2310','2311','2312','2313','2314','2315','2316','2317','2318','2319','2320','2321','2322','2323','2324','2325','2326','2327','2328','2329','2330','2331','2332','2333','2334','2335','2336','2337','2338','2339','2340','2341','2342','2343','2344','2345','2346','2347','2348','2349','2350','2351','2352','2353','2354','2355','2356','2357','2358','2359','2360','2361','2362','2363','2364','2365','2366','2367','2368','2369','2370','2371','2372','2373','2374','2375','2376','2377','2378','2379','2380','2381','2382','2383','2384','2385','2386','2387','2388','2389','2390','2391','2392','2393','2394','2395','2396','2397','2398','2399','2400','2401','2402','2403','2404','2405','2406','2407','2408','2409','2410','2411','2412','2413','2414','2415','2416','2417','2418','2419','2420','2421','2422','2423','2424','2425','2426','2427','2428','2429','2430','2431','2432','2433','2434','2435','2436','2437','2438','2439','2440','2441','2442','2443','2444','2445','2446','2447','2448','2449','2450','2451','2452','2453','2454','2455','2456','2457','2458','2459','2460','2461','2462','2463','2464','2465','2466','2467','2468','2469','2470','2471','2472','2473','2474','2475','2476','2477','2478','2479','2480','2481','2482','2483','2484','2485','2486','2487','2488','2489','2490','2491','2492','2493','2494','2495','2496','2497','2498','2499','2500','2501','2502','2503','2504','2505','2506','2507','2508','2509','2510','2511','2512','2513','2514','2515','2516','2517','2518','2519','2520','2521']
    test_ids = ['2522','2523','2524','2525','2526','2527','2528','2529','2530','2531','2532','2533','2534','2535','2536','2537','2538','2539','2540','2541','2542','2543','2544','2545','2546','2547','2548','2549','2550','2551','2552','2553','2554','2555','2556','2557','2558','2559','2560','2561','2562','2563','2564','2565','2566','2567','2568','2569','2570','2571','2572','2573','2574','2575','2576','2577','2578','2579','2580','2581','2582','2583','2584','2585','2586','2587','2588','2589','2590','2591','2592','2593','2594','2595','2596','2597','2598','2599','2600','2601','2602','2603','2604','2605','2606','2607','2608','2609','2610','2611','2612','2613','2614','2615','2616','2617','2618','2619','2620','2621','2622','2623','2624','2625','2626','2627','2628','2629','2630','2631','2632','2633','2634','2635','2636','2637','2638','2639','2640','2641','2642','2643','2644','2645','2646','2647','2648','2649','2650','2651','2652','2653','2654','2655','2656','2657','2658','2659','2660','2661','2662','2663','2664','2665','2666','2667','2668','2669','2670','2671','2672','2673','2674','2675','2676','2677','2678','2679','2680','2681','2682','2683','2684','2685','2686','2687','2688','2689','2690','2691','2692','2693','2694','2695','2696','2697','2698','2699','2700','2701','2702','2703','2704','2705','2706','2707','2708','2709','2710','2711','2712','2713','2714','2715','2716','2717','2718','2719','2720','2721','2722','2723','2724','2725','2726','2727','2728','2729','2730','2731','2732','2733','2734','2735','2736','2737','2738','2739','2740','2741','2742','2743','2744','2745','2746','2747','2748','2749','2750','2751','2752','2753','2754','2755','2756','2757','2758','2759','2760','2761','2762','2763','2764','2765','2766','2767','2768','2769','2770','2771','2772','2773','2774','2775','2776','2777','2778','2779','2780','2781','2782','2783','2784','2785','2786','2787','2788','2789','2790','2791','2792','2793','2794','2795','2796','2797','2798','2799','2800','2801','2802','2803','2804','2805','2806','2807','2808','2809','2810','2811','2812','2813','2814','2815','2816','2817','2818','2819','2820','2821','2822','2823','2824','2825','2826','2827','2828','2829','2830','2831','2832','2833','2834','2835','2836','2837','2838','2839','2840','2841','2842','2843','2844','2845','2846','2847','2848','2849','2850','2851','2852','2853','2854','2855','2856','2857','2858','2859','2860','2861','2862','2863','2864','2865','2866','2867','2868','2869','2870','2871','2872','2873','2874','2875','2876','2877','2878','2879','2880','2881','2882','2883','2884','2885','2886','2887','2888','2889','2890','2891','2892','2893','2894','2895','2896','2897','2898','2899','2900','2901','2902','2903','2904','2905','2906','2907','2908','2909','2910','2911','2912','2913','2914','2915','2916','2917','2918','2919','2920','2921','2922','2923','2924','2925','2926','2927','2928','2929','2930','2931','2932','2933','2934','2935','2936','2937','2938','2939','2940','2941','2942','2943','2944','2945','2946','2947','2948','2949','2950','2951','2952','2953','2954','2955','2956','2957','2958','2959','2960','2961','2962','2963','2964','2965','2966','2967','2968','2969','2970','2971','2972','2973','2974','2975','2976','2977','2978','2979','2980','2981','2982','2983','2984','2985','2986','2987','2988','2989','2990','2991','2992','2993','2994','2995','2996','2997','2998','2999','3000','3001','3002','3003','3004','3005','3006','3007','3008','3009','3010','3011','3012','3013','3014','3015','3016','3017','3018','3019','3020','3021','3022','3023','3024','3025','3026','3027','3028','3029','3030','3031','3032','3033','3034','3035','3036','3037','3038','3039','3040','3041','3042','3043','3044','3045','3046','3047','3048','3049','3050','3051','3052','3053','3054','3055','3056','3057','3058','3059','3060','3061','3062','3063','3064','3065','3066','3067','3068','3069','3070','3071','3072','3073','3074','3075','3076','3077','3078','3079','3080','3081','3082','3083','3084','3085','3086','3087','3088','3089','3090','3091','3092','3093','3094','3095','3096','3097','3098','3099','3100','3101','3102','3103','3104','3105','3106','3107','3108','3109','3110','3111','3112','3113','3114','3115','3116','3117','3118','3119','3120','3121','3122','3123','3124','3125','3126','3127','3128','3129','3130','3131','3132','3133','3134','3135','3136','3137','3138','3139','3140','3141','3142','3143','3144','3145','3146','3147','3148','3149','3150','3151','3152','3153','3154','3155','3156','3157','3158','3159','3160','3161','3162','3163','3164','3165','3166','3167','3168','3169','3170','3171','3172','3173','3174','3175','3176','3177','3178','3179','3180','3181','3182','3183','3184','3185','3186','3187','3188','3189','3190','3191','3192','3193','3194','3195','3196','3197','3198','3199','3200','3201','3202','3203','3204','3205','3206','3207','3208','3209','3210','3211','3212','3213','3214','3215','3216','3217','3218','3219','3220','3221','3222','3223','3224','3225','3226','3227','3228','3229','3230','3231','3232','3233','3234','3235','3236','3237','3238','3239','3240','3241','3242','3243','3244','3245','3246','3247','3248','3249','3250','3251','3252','3253','3254','3255','3256','3257','3258','3259','3260','3261','3262','3263','3264','3265','3266','3267','3268','3269','3270','3271','3272','3273','3274','3275','3276','3277','3278','3279','3280','3281','3282','3283','3284','3285','3286','3287','3288','3289','3290','3291','3292','3293','3294','3295','3296','3297','3298','3299','3300','3301','3302','3303','3304','3305','3306','3307','3308','3309','3310','3311','3312','3313','3314','3315','3316','3317','3318','3319','3320','3321','3322','3323','3324','3325','3326','3327','3328','3329','3330','3331','3332','3333','3334','3335','3336','3337','3338','3339','3340','3341','3342','3343','3344','3345','3346','3347','3348','3349','3350','3351','3352','3353','3354','3355','3356','3357','3358','3359','3360','3361','3362','3363','3364','3365','3366','3367','3368','3369','3370','3371','3372','3373','3374','3375','3376','3377','3378','3379','3380','3381','3382','3383','3384','3385','3386','3387','3388','3389','3390','3391','3392','3393','3394','3395','3396','3397','3398','3399','3400','3401','3402','3403','3404','3405','3406','3407','3408','3409','3410','3411','3412','3413','3414','3415','3416','3417','3418','3419','3420','3421','3422','3423','3424','3425','3426','3427','3428','3429','3430','3431','3432','3433','3434','3435','3436','3437','3438','3439','3440','3441','3442','3443','3444','3445','3446','3447','3448','3449','3450','3451','3452','3453','3454','3455','3456','3457','3458','3459','3460','3461','3462','3463','3464','3465','3466','3467','3468','3469','3470','3471','3472','3473','3474','3475','3476','3477','3478','3479','3480','3481','3482','3483','3484','3485','3486','3487','3488','3489','3490','3491','3492','3493','3494','3495','3496','3497','3498','3499','3500','3501','3502','3503','3504','3505','3506','3507','3508','3509','3510','3511','3512','3513','3514','3515','3516','3517','3518','3519','3520','3521','3522','3523','3524','3525','3526','3527','3528','3529','3530','3531','3532','3533','3534','3535','3536','3537','3538','3539','3540','3541','3542','3543','3544','3545','3546','3547','3548','3549','3550','3551','3552','3553','3554','3555','3556','3557','3558','3559','3560','3561','3562','3563','3564','3565','3566','3567','3568','3569','3570','3571','3572','3573','3574','3575','3576','3577','3578','3579','3580','3581','3582','3583','3584','3585','3586','3587','3588','3589','3590','3591','3592','3593','3594','3595','3596','3597','3598','3599','3600','3601','3602','3603','3604','3605','3606','3607','3608','3609','3610','3611','3612','3613','3614','3615','3616','3617','3618','3619','3620','3621','3622','3623','3624','3625','3626','3627','3628','3629','3630','3631','3632','3633','3634','3635','3636','3637','3638','3639','3640','3641','3642','3643','3644','3645','3646','3647','3648','3649','3650','3651','3652','3653','3654','3655','3656','3657','3658','3659','3660','3661','3662','3663','3664','3665','3666','3667','3668','3669','3670','3671','3672','3673','3674','3675','3676','3677','3678','3679','3680','3681','3682','3683','3684','3685','3686','3687','3688','3689','3690','3691','3692','3693','3694','3695','3696','3697','3698','3699','3700','3701','3702','3703','3704','3705','3706','3707','3708','3709','3710','3711','3712','3713','3714','3715','3716','3717','3718','3719','3720','3721','3722','3723','3724','3725','3726','3727','3728','3729','3730','3731','3732','3733','3734','3735','3736','3737','3738','3739','3740','3741','3742','3743','3744','3745','3746','3747','3748','3749','3750','3751','3752','3753','3754','3755','3756','3757','3758','3759','3760','3761','3762','3763','3764','3765','3766','3767','3768','3769','3770','3771','3772','3773','3774','3775','3776','3777','3778','3779','3780','3781','3782','3783','3784','3785','3786','3787','3788','3789','3790','3791','3792','3793','3794','3795','3796','3797','3798','3799','3800','3801','3802','3803','3804','3805','3806','3807','3808','3809','3810','3811','3812','3813','3814','3815','3816','3817','3818','3819','3820','3821','3822','3823','3824','3825','3826','3827','3828','3829','3830','3831','3832','3833','3834','3835','3836','3837','3838','3839','3840','3841','3842','3843','3844','3845','3846','3847','3848','3849','3850','3851','3852','3853','3854','3855','3856','3857','3858','3859','3860','3861','3862','3863','3864','3865','3866','3867','3868','3869','3870','3871','3872','3873','3874','3875','3876','3877','3878','3879','3880','3881','3882','3883','3884','3885','3886','3887','3888','3889','3890','3891','3892','3893','3894','3895','3896','3897','3898','3899','3900','3901','3902','3903','3904','3905','3906','3907','3908','3909','3910','3911','3912','3913','3914','3915','3916','3917','3918','3919','3920','3921','3922','3923','3924','3925','3926','3927','3928','3929','3930','3931','3932','3933','3934','3935','3936','3937','3938','3939','3940','3941','3942','3943','3944','3945','3946','3947','3948','3949','3950','3951','3952','3953','3954','3955','3956','3957','3958','3959','3960','3961','3962','3963','3964','3965','3966','3967','3968','3969','3970','3971','3972','3973','3974','3975','3976','3977','3978','3979','3980','3981','3982','3983','3984','3985','3986','3987','3988','3989','3990','3991','3992','3993','3994','3995','3996','3997','3998','3999','4000','4001','4002','4003','4004','4005','4006','4007','4008','4009','4010','4011','4012','4013','4014','4015','4016','4017','4018','4019','4020','4021','4022','4023','4024','4025','4026','4027','4028','4029','4030','4031','4032','4033','4034','4035','4036','4037','4038','4039','4040','4041','4042','4043','4044','4045','4046','4047','4048','4049','4050','4051','4052','4053','4054','4055','4056','4057','4058','4059','4060','4061','4062','4063','4064','4065','4066','4067','4068','4069','4070','4071','4072','4073','4074','4075','4076','4077','4078','4079','4080','4081','4082','4083','4084','4085','4086','4087','4088','4089','4090','4091','4092','4093','4094','4095','4096','4097','4098','4099','4100','4101','4102','4103','4104','4105','4106','4107','4108','4109','4110','4111','4112','4113','4114','4115','4116','4117','4118','4119','4120','4121','4122','4123','4124','4125','4126','4127','4128','4129','4130','4131','4132','4133','4134','4135','4136','4137','4138','4139','4140','4141','4142','4143','4144','4145','4146','4147','4148','4149','4150','4151','4152','4153','4154','4155','4156','4157','4158','4159','4160','4161','4162','4163','4164','4165','4166','4167','4168','4169','4170','4171','4172','4173','4174','4175','4176','4177','4178','4179','4180','4181','4182','4183','4184','4185','4186','4187','4188','4189','4190']

    Stride_Size = 128
    FOLDER = "/home/SSRS-main/SAM_RS_all/"
    LABELS = ["background", "building", "road", "water", "barren", "forest", "agriculture"]
    N_CLASSES = len(LABELS) # Number of classes
    WEIGHTS = torch.ones(N_CLASSES) # Weights for class balancing
    MAIN_FOLDER = FOLDER + 'loveda_all/'
    DATA_FOLDER = MAIN_FOLDER + 'img/{}.png'
    LABEL_FOLDER = MAIN_FOLDER + 'label/{}.png'
    BOUNDARY_FOLDER = MAIN_FOLDER + 'SGB/{}.png'
    OBJECT_FOLDER = MAIN_FOLDER + 'SGO/{}.png'
    ERODED_FOLDER = MAIN_FOLDER + 'label/{}.png'
    palette = {0 : (255, 255, 255), # background
           1 : (255, 0, 0),     # building
           2 : (255, 255, 0),   # road
           3 : (0, 0, 255),     # water
           4 : (159, 129, 183), # barren
           5 : (0, 255, 0),     # forest
           6 : (255, 195, 128)} # agriculture
    invert_palette = {v: k for k, v in palette.items()}

if DATASET == 'DFC22':

    train_ids = ['307', '420', '244', '107', '432', '289', '260', '578', '277', '86', '164', '429', '414', '138', '744', '168', '739', '676', '498', '470', '489', '6', '41', '520', '672', '447', '510', '331', '184', '572', '643', '84', '575', '218', '431', '461', '38', '604', '46', '88', '12', '165', '746', '506', '726', '722', '207', '363', '440', '14', '437', '205', '190', '611', '547', '712', '569', '98', '534', '570', '152', '610', '592', '371', '394', '290', '10', '538', '43', '616', '460', '532', '367', '631', '262', '342', '721', '677', '762', '522', '563', '507', '529', '405', '590', '483', '426', '675', '35', '560', '655', '445', '241', '446', '530', '448', '130', '116', '682', '328', '83', '579', '719', '283', '82', '753', '474', '325', '143', '552', '220', '68', '528', '457', '737', '268', '24', '64', '75', '288', '427', '167', '418', '217', '101', '481', '339', '93', '710', '148', '108', '45', '385', '633', '351', '292', '209', '308', '707', '271', '752', '223', '515', '187', '72', '298', '157', '422', '182', '644', '743', '764', '11', '387', '78', '79', '505', '705', '421', '59', '267', '380', '160', '361', '585', '559', '174', '668', '609', '312', '713', '214', '674', '648', '475', '465', '39', '568', '61', '238', '125', '558', '211', '323', '732', '695', '206', '665', '355', '441', '321', '320', '619', '650', '20', '526', '690', '345', '230', '270', '142', '671', '488', '279', '87', '257', '110', '553', '473', '595', '537', '197', '412', '697', '370', '683', '482', '236', '329', '354', '303', '628', '479', '225', '408', '232', '261', '2', '745', '221', '201', '542', '29', '369', '503', '384', '452', '144', '242', '511', '602', '57', '317', '555', '540', '411', '246', '504', '266', '449', '31', '641', '169', '755', '377', '128', '561', '688', '183', '516', '416', '605', '166', '306', '357', '567', '679', '193', '598', '518', '597', '554', '453', '545', '565', '304', '551', '625', '33', '724', '747', '624', '44', '263', '667', '614', '291', '117', '386', '53', '253', '586', '140', '468', '495', '162', '513', '382', '680', '324', '71', '577', '334', '397', '700', '456', '181', '716', '70', '612', '714', '663', '444', '28', '338', '666', '333', '362', '81', '52', '272', '163', '539', '111', '765', '704', '65', '227', '247', '548', '703', '599', '215', '392', '742', '302', '26', '629', '85', '673', '486', '576', '179', '1', '103', '344', '738', '574', '149', '228', '255', '404', '375', '640', '13', '566', '200', '330', '398', '425', '701', '589', '73', '409', '136', '366', '27', '442', '618', '519', '175', '60', '466', '305', '131', '89', '120', '80', '9', '410', '657', '309', '368', '635', '178', '681', '274', '155', '438', '720', '139', '525', '240', '686', '37', '280', '191', '654', '740', '478', '546', '219', '286', '583', '494', '471', '399', '390', '245', '439', '134', '100', '748', '588', '112', '275', '388', '124', '763', '378', '647', '512', '90', '97', '758', '7', '356', '550', '727', '428', '594', '293', '159', '531', '469', '556', '94', '499', '226', '66', '664', '393', '154', '67', '346', '508', '353', '715', '195', '126', '678', '62', '467', '327', '121', '492', '730', '34', '395', '322', '601', '607', '627', '335', '259', '562', '401', '718', '497', '69', '147', '326', '295', '600', '235', '659', '696', '509', '651', '549', '374', '364', '389', '122', '584', '350', '358', '642', '42', '40', '692', '750', '709', '731', '234', '248', '749', '204', '638', '454', '733', '194', '698', '341', '582', '541', '192', '95', '185', '608', '55', '477', '365', '54', '173', '58', '48', '491', '571', '310', '115', '133', '141', '433', '485', '669', '318', '158', '224', '564', '188', '379', '756', '480', '203', '359', '186', '706', '213', '736', '17', '4', '199', '463', '337', '3', '660', '251', '316', '741', '189', '415', '708', '319', '76', '436', '229', '693', '161', '685', '282', '171', '523', '119', '212', '573', '77', '652', '104', '23', '632', '294', '273', '434', '521', '396', '156', '15', '653', '761', '581', '734', '464', '493', '735', '311', '501', '180', '626', '50', '237', '30', '725', '517', '92', '113', '689', '606', '458', '417', '424', '202', '99', '276', '313', '596', '336', '450', '150', '314', '265', '347']

    test_ids = ['623', '729', '196', '252', '766', '278', '443', '381', '645', '527', '284', '301', '691', '502', '687', '455', '617', '419', '723', '630', '391', '16', '656', '145', '476', '593', '376', '91', '198', '243', '102', '484', '684', '281', '285', '153', '536', '135', '146', '264', '177', '760', '332', '543', '250', '670', '487', '231', '106', '348', '622', '711', '172', '490', '728', '299', '402', '269', '459', '18', '340', '74', '32', '637', '256', '49', '176', '254', '658', '524', '222', '151', '315', '634', '216', '352', '535', '47', '114', '360', '406', '636', '413', '123', '137', '383', '435', '587', '105', '430', '22', '400', '8', '25', '109', '646', '699', '751', '36', '639', '451', '661', '533', '19', '96', '694', '514', '56', '407', '373', '649', '343', '702', '462', '620', '757', '210', '717', '372', '287', '5', '129', '127', '472', '132', '403', '621', '51', '496', '591', '544', '500', '603', '170', '21', '423', '239', '615', '258', '759', '580', '297', '63', '613', '754', '249', '349', '557', '208', '118', '662', '296', '233', '300']
   
    Stride_Size = 128
    FOLDER = "/data5/GLGAN/datasets/"
    LABELS = ["0", "1", "2", "3", "4", "5","6","7","8","9","10","11"]
    N_CLASSES = len(LABELS) # Number of classes
    WEIGHTS = torch.ones(N_CLASSES) # Weights for class balancing
    MAIN_FOLDER = FOLDER + 'DFC22/'
    DATA_FOLDER = MAIN_FOLDER + 'images/{}.tif'
    LABEL_FOLDER = MAIN_FOLDER + 'label_RGB/{}.tif'
    BOUNDARY_FOLDER = MAIN_FOLDER + 'depth_1/{}.png'
    OBJECT_FOLDER = MAIN_FOLDER + 'depth_1/{}.png'
    ERODED_FOLDER = MAIN_FOLDER + 'label_RGB/{}.tif'
    palette = {
        0: (219, 95, 87),  # Class 0
        1: (219, 151, 87),  # Class 1
        2: (219, 208, 87),  # Class 2
        3: (173, 219, 87),  # Class 3
        4: (117, 219, 87),  # Class 4
        5: (123, 196, 123),  # Class 5
        6: (88, 177, 88),  # Class 6
        7: (0, 128, 0),  # Class 7
        8: (88, 176, 167),  # Class 8
        9: (153, 93, 19),  # Class 9
        10: (87, 155, 219),  # Class 10
        11: (0, 98, 255)  # Class 11
    }
    invert_palette = {v: k for k, v in palette.items()}


if DATASET == 'GID-15':

    train_ids =['1413', '879', '2744', '1946', '2568', '1288', '224', '66', '688', '1493', '2996', '2413', '626', '2019', '738', '1075', '1728', '2871', '3172', '292', '1342', '1044', '249', '1634', '2783', '602', '2784', '1582', '185', '118', '1228', '598', '2941', '2356', '1065', '1224', '1328', '1315', '2950', '2796', '2066', '2055', '2391', '2363', '2320', '569', '926', '195', '3185', '1801', '3322', '188', '2858', '2712', '1783', '2640', '1271', '99', '2267', '2580', '2056', '2058', '3204', '777', '1744', '1438', '2057', '78', '3202', '2657', '2866', '2183', '2506', '3283', '2892', '2923', '2944', '1372', '1332', '64', '1990', '125', '2083', '2121', '1701', '550', '101', '1417', '1299', '385', '1076', '2901', '331', '1458', '1337', '1087', '241', '1949', '2762', '836', '3284', '2522', '2757', '2542', '1330', '2526', '661', '61', '1478', '3019', '2470', '3401', '726', '3354', '232', '657', '3051', '1682', '2163', '1770', '3142', '1058', '1411', '3033', '2930', '1311', '1565', '2513', '2257', '3041', '2023', '1125', '2847', '1455', '2629', '52', '1148', '604', '700', '973', '408', '2844', '443', '2149', '1396', '1813', '958', '3113', '1325', '3170', '2232', '1832', '552', '1539', '1461', '1237', '1972', '736', '916', '2967', '1491', '1260', '921', '1115', '1142', '387', '304', '2978', '644', '869', '2114', '470', '2774', '2449', '3250', '426', '2103', '2964', '3305', '1083', '2464', '2315', '2999', '1425', '2676', '386', '1840', '2859', '5', '303', '1051', '2677', '3032', '2845', '2955', '1198', '2801', '1635', '595', '1723', '623', '1380', '1687', '3379', '2497', '2816', '1479', '2426', '696', '300', '1505', '1259', '3234', '2495', '2138', '1316', '1907', '1448', '989', '3296', '607', '1847', '265', '2986', '2648', '2750', '2819', '2809', '164', '288', '543', '2108', '200', '413', '2798', '2370', '166', '1203', '2698', '2043', '643', '3038', '1525', '3392', '852', '2815', '1961', '2018', '3181', '3044', '3095', '3285', '1873', '3220', '3087', '609', '2886', '201', '515', '2344', '3406', '2375', '1604', '2301', '1918', '2431', '2782', '2128', '2594', '3417', '633', '1978', '2014', '561', '3409', '123', '2625', '2581', '2644', '325', '240', '932', '2604', '2013', '192', '1774', '2269', '853', '2890', '289', '1006', '582', '727', '2222', '1124', '179', '2867', '2854', '1733', '2781', '3231', '3316', '3167', '1340', '1625', '476', '124', '844', '2701', '988', '2678', '1481', '1173', '2612', '415', '1718', '459', '2231', '2596', '1643', '363', '3352', '1705', '1130', '1374', '2820', '449', '1218', '228', '1355', '51', '3011', '1327', '2825', '2479', '3003', '1910', '1980', '495', '441', '936', '2708', '3243', '1049', '2680', '2747', '361', '1708', '2508', '1068', '1875', '3335', '1598', '1732', '2009', '2215', '1297', '1563', '2283', '218', '3376', '168', '711', '3327', '983', '3257', '460', '3148', '1127', '3371', '2118', '2185', '1941', '1909', '2875', '236', '1569', '521', '1802', '1853', '778', '1447', '17', '1845', '1876', '379', '2585', '1931', '2693', '2142', '2725', '3360', '3266', '252', '481', '1871', '876', '1067', '2822', '1969', '1392', '792', '24', '2432', '2036', '2745', '3289', '860', '1944', '3048', '34', '2824', '1811', '3358', '2851', '717', '2650', '2276', '156', '1879', '675', '1959', '887', '1009', '3261', '3416', '1234', '2015', '2243', '217', '1982', '370', '1015', '2833', '3191', '625', '1201', '2751', '3301', '1902', '2001', '3144', '2313', '42', '1221', '1187', '433', '468', '1858', '295', '62', '409', '530', '2038', '1546', '334', '733', '313', '2208', '1606', '1883', '1537', '1', '1495', '2110', '2546', '771', '3006', '14', '1775', '3375', '337', '789', '1345', '1545', '1485', '1180', '1008', '2549', '1430', '1852', '3418', '1443', '2169', '3387', '1484', '1835', '431', '1038', '1321', '1594', '2492', '2702', '2621', '2916', '2336', '2224', '2976', '667', '2150', '91', '1633', '1111', '1379', '3166', '812', '2381', '3225', '1554', '467', '2881', '1807', '2032', '2627', '648', '1684', '3244', '2795', '694', '1360', '2592', '1772', '1809', '1619', '1365', '1074', '1849', '366', '2545', '3223', '2442', '2199', '1003', '2524', '558', '2692', '646', '2943', '1812', '804', '1030', '1927', '1842', '2635', '1630', '110', '1089', '1441', '832', '1133', '2673', '296', '3319', '1339', '1519', '710', '681', '3092', '293', '1703', '985', '2136', '3004', '2836', '3195', '3016', '2089', '1167', '2069', '2660', '1991', '819', '1028', '1120', '1676', '2306', '1776', '1953', '766', '1331', '1134', '1623', '1642', '906', '2828', '454', '746', '272', '274', '1506', '229', '1427', '2335', '1844', '613', '1424', '365', '796', '2033', '1838', '854', '573', '2636', '2481', '2494', '529', '767', '884', '3052', '1971', '2094', '301', '541', '979', '1755', '2503', '2191', '3227', '2398', '324', '2021', '2738', '2348', '730', '2905', '603', '2405', '149', '3263', '1263', '2188', '2929', '339', '1547', '2406', '3021', '2987', '1027', '3240', '2435', '1011', '1933', '2610', '3419', '480', '647', '2288', '298', '2939', '3175', '2817', '158', '536', '372', '2554', '1369', '756', '1607', '263', '1731', '1791', '913', '1267', '2102', '851', '1534', '1796', '1341', '1079', '2338', '1724', '68', '3160', '3110', '1924', '669', '3098', '2316', '3216', '2697', '2281', '1521', '1714', '1256', '505', '1571', '991', '3196', '1743', '1456', '326', '32', '2974', '1354', '1925', '2578', '2965', '1394', '1960', '1798', '1605', '209', '463', '2718', '3310', '920', '1741', '2643', '3357', '3174', '2564', '2664', '2951', '3287', '3407', '374', '2233', '349', '3093', '2342', '30', '597', '1614', '1433', '2933', '1112', '321', '708', '1202', '2004', '663', '2264', '1165', '2190', '205', '1149', '608', '2379', '2096', '1830', '1720', '2290', '531', '3215', '389', '1663', '1415', '3153', '1950', '1884', '3359', '2268', '2936', '825', '629', '2025', '914', '2934', '1857', '275', '230', '1740', '2958', '2216', '501', '2341', '2920', '2371', '1829', '3331', '2511', '2105', '969', '2529', '1435', '2567', '962', '1450', '3042', '996', '720', '1055', '1715', '2106', '2683', '3415', '2186', '15', '1361', '1090', '1922', '3183', '368', '3168', '221', '1114', '2425', '725', '1178', '2331', '981', '2583', '2076', '2737', '1745', '503', '2721', '933', '484', '2971', '999', '3132', '2134', '1782', '1901', '163', '1446', '977', '2926', '2758', '2713', '2300', '2946', '440', '520', '1874', '1151', '2694', '430', '930', '585', '1422', '580', '1967', '2980', '2832', '2282', '316', '2030', '2192', '1742', '46', '3237', '889', '1680', '2160', '167', '1158', '176', '1686', '3107', '2626', '1291', '4', '2787', '1900', '2166', '1063', '2318', '3367', '2691', '1995', '3012', '2077', '3108', '2017', '662', '2181', '957', '3291', '2756', '1626', '640', '1318', '65', '3122', '155', '207', '1469', '2827', '976', '2661', '222', '267', '1382', '3276', '3034', '2008', '41', '1220', '1665', '89', '2471', '3102', '1005', '1290', '1641', '121', '1050', '1371', '1652', '3112', '1183', '1794', '429', '3190', '1189', '1681', '2477', '583', '2770', '1381', '1163', '3217', '3351', '3200', '327', '258', '835', '2788', '712', '2637', '817', '2147', '2421', '396', '3408', '699', '2843', '1408', '1789', '773', '575', '3176', '2123', '2597', '1013', '428', '2598', '2424', '878', '1229', '653', '1781', '674', '354', '2646', '1659', '1822', '1859', '2034', '1356', '928', '2983', '690', '1012', '1204', '248', '2197', '2158', '312', '506', '1818', '2865', '3178', '2897', '1376', '2135', '3101', '2085', '1397', '1314', '439', '2830', '2935', '2887', '659', '2172', '402', '743', '60', '417', '1283', '549', '90', '747', '3151', '2071', '399', '1375', '2279', '306', '1699', '614', '407', '1593', '237', '1412', '2804', '2771', '3199', '299', '1347', '1661', '1580', '3361', '260', '1864', '2040', '2686', '2500', '257', '1921', '2441', '2557', '67', '181', '1868', '2387', '2645', '3292', '3189', '414', '2461', '1305', '719', '278', '1912', '1541', '2777', '3233', '1159', '2667', '127', '2642', '1735', '532', '2908', '1121', '2857', '679', '16', '472', '2299', '2350', '723', '1368', '447', '2535', '3203', '251', '1303', '2410', '1583', '146', '3013', '2800', '347', '3097', '1637', '754', '204', '2179', '1095', '2966', '2125', '1502', '2012', '2060', '3140', '103', '3207', '2238', '2779', '1243', '1805', '935', '1523', '927', '2772', '2624', '570', '1210', '7', '1981', '562', '1181', '2285', '2769', '3094', '618', '211', '308', '658', '2388', '2247', '528', '1035', '1105', '1677', '584', '2937', '1393', '2639', '961', '689', '1312', '2603', '963', '734', '2938', '3000', '1487', '1496', '369', '2489', '1036', '1037', '1503', '3365', '964', '1154', '1421', '620', '2260', '77', '2565', '161', '1670', '3278', '85', '1568', '2864', '1881', '672', '202', '1466', '1577', '2754', '2437', '1216', '2250', '1179', '826', '2048', '1324', '545', '1227', '2945', '3219', '2510', '2662', '3226', '1280', '27', '3072', '3058', '1317', '128', '2065', '3323', '2977', '2144', '1295', '1197', '1617', '2289', '956', '3264', '522', '3373', '865', '1119', '2540', '2068', '358', '1694', '108', '745', '2606', '1592', '638', '100', '910', '601', '2882', '461', '3340', '2200', '630', '2253', '2960', '1578', '398', '523', '1591', '2415', '553', '698', '1226', '768', '670', '1268', '3069', '1685', '69', '1370', '1122', '22', '294', '2230', '1804', '2528', '3083', '2842', '507', '1726', '2591', '3149', '1763', '2064', '3105', '212', '464', '871', '1047', '1475', '2850', '1004', '1564', '1489', '902', '1693', '215', '466', '588', '446', '1025', '1613', '2187', '567', '947', '808', '713', '2548', '1898', '2717', '799', '861', '1527', '896', '1930', '2050', '2126', '198', '940', '3239', '855', '3341', '2427', '1752', '2444', '762', '2100', '944', '1560', '1656', '1052', '3275', '50', '564', '154', '2860', '2240', '1888', '2155', '199', '145', '3353', '1174', '1987', '1026', '1632', '2430', '3039', '1761', '400', '748', '153', '75', '2143', '35', '1483', '273', '702', '1737', '1128', '1780', '1815', '2321', '3314', '2724', '1893', '857', '3031', '786', '952', '208', '1938', '2091', '2617', '1722', '668', '38', '2151', '2652', '1172', '1081', '995', '2392', '3404', '2533', '98', '959', '1199', '3075', '2893', '21', '329', '2384', '1639', '687', '946', '955', '19', '2393', '1573', '512', '2570', '2303', '527', '539', '2768', '1586', '3126', '1678', '1251', '1657', '3154', '556', '1155', '3205', '1056', '751', '140', '715', '3377', '1759', '1692', '2376', '1462', '3100', '2615', '1222', '2148', '2763', '821', '142', '1358', '266', '843', '496', '83', '1406', '315', '2586', '1528', '3312', '412', '3104', '2569', '1275', '2856', '3274', '3043', '2919', '2690', '1727', '3211', '3380', '2687', '3070', '3364', '2225', '673', '703', '2818', '1892', '1851', '2633', '3325', '391', '119', '2174', '1042', '314', '3023', '2251', '1014', '305', '3106', '2792', '1106', '1294', '941', '3388', '2359', '2547', '2086', '1460', '1749', '1410', '111', '1097', '29', '2600', '1002', '1522', '112', '2924', '71', '2689', '1974', '2876', '937', '1168', '2333', '2403', '1474', '2537', '3272', '345', '1223', '1711', '136', '3057', '2611', '888', '3073', '3123', '115', '2735', '842', '133', '1784', '2111', '1977', '1001', '487', '3345', '2507', '152', '2957', '929', '1551', '1176', '2634', '1820', '1517', '870', '216', '2088', '1768', '3059', '732', '621', '2255', '1494', '3017', '1184', '572', '2961', '1508', '2579', '3230', '2515', '2084', '3222', '418', '862', '1194', '2047', '2472', '1471', '3130', '818', '1627', '707', '2491', '3350', '3', '705', '858', '2385', '3389', '1423', '1480', '1821', '846', '1419', '2330', '1024', '652', '1403', '2749', '1675', '3194', '2262', '1915', '2638', '2716', '742', '1465', '718', '1683', '1998', '1022', '276', '3356', '3368', '2719', '1266', '2272', '2127', '231', '765', '891', '246', '2562', '189', '2532', '1890', '3326', '971', '2530', '1449', '1716', '510', '2835', '1041', '1964', '1262', '126', '1899', '2514', '2753', '2324', '2167', '2360', '2775', '2223', '1094', '1270', '423', '2070', '1211', '1800', '642', '1754', '1544', '797', '1476', '774', '1721', '665', '3010', '1279', '193', '1444', '1292', '2838', '2791', '3370', '2113', '939', '1061', '555', '1863', '2767', '2438', '1926', '2730', '637', '1548', '1208', '3248', '3082', '639', '752', '291', '1359', '131', '1166', '1824', '810', '1624', '1144', '3020', '1644', '2090', '2399', '197', '848', '2468', '1734', '282', '822', '2274', '1349', '2499', '666', '2707', '279', '2109', '1467', '2079', '2601', '107', '1093', '2704', '1973', '875', '2577', '1535', '2098', '1104', '3078', '834', '1697', '3150', '605', '245', '2412', '3385', '2249', '2120', '909', '1021', '74', '1391', '2146', '2705', '2589', '2736', '3037', '1872', '784', '259', '2201', '907', '1386', '2778', '2162', '3152', '915', '3085', '2343', '2080', '2799', '1215', '1293', '2046', '2061', '23', '1252', '3050', '2177', '2666', '3329', '1827', '281', '2802', '664', '3155', '357', '3333', '3030', '1746', '873', '420', '173', '2618', '1160', '2679', '2366', '283', '551', '1771', '2329', '3320', '1588', '978', '3056', '867', '380', '2373', '775', '3269', '148', '1225', '355', '2448', '1395', '2630', '1923', '918', '2496', '514', '526', '57', '489', '2211', '2053', '3001', '255', '1384', '1107', '56', '2722', '997', '48', '2165', '966', '2729', '95', '516', '2207', '479', '2684', '3145', '3324', '2153', '2794', '1895', '2171', '1935', '3080', '322', '388', '2672', '1500', '2294', '2632', '1664', '2309', '2487', '1452', '691', '2536', '1507', '2659', '141', '1482', '2998', '1230', '1602', '863', '655', '2614', '297', '1296', '3118', '866', '3337', '2180', '122', '1459', '2839', '2011', '2671', '1831', '109', '448', '1767', '2741', '2347', '1916', '3330', '451', '1053', '793', '1750', '2543', '1719', '2520', '2219', '923', '1257', '2327', '776', '2765', '2382', '72', '560', '619', '3084', '485', '191', '3372', '3139', '2051', '3005', '1947', '174', '2552', '2989', '1757', '1310', '3309', '319', '2408', '2469', '3393', '984', '504', '524', '341', '1366', '576', '2808', '2117', '1671', '2052', '1712', '2670', '3247', '849', '1045', '3410', '3071', '1919', '404', '692', '2173', '474', '1420', '990', '1416', '2189', '1575', '1748', '1272', '1453', '2947', '2709', '3055', '1019', '3397', '3254', '3018', '994', '600', '1939', '1620', '492', '2073', '1531', '170', '1653', '3396', '3382', '872', '2411', '25', '3171', '2571', '1434', '3246', '1060', '1764', '1934', '3026', '831', '2710', '3318', '1777', '864', '3109', '1156', '2364', '3212', '2534', '2518', '332', '1581', '2273', '650', '680', '134', '8', '2159', '2681', '2295', '1955', '1836', '2700', '1426', '2352', '1145', '1610', '651', '824', '3146', '2483', '2555', '2728', '1688', '1428', '3022', '3252', '2443', '31', '1367', '1695', '1232', '1597', '425', '3224', '2092', '2154', '2732', '2417', '2016', '1905', '39', '1046', '287', '350', '542', '1810', '3135', '2131', '2922', '1549', '1409', '508', '882', '3015', '1877', '2354', '1989', '3348', '2482', '500', '803', '3028', '3398', '94', '2743', '1848', '3063', '320', '213', '1903', '3311', '2254', '1673', '3060', '2655', '264', '2910', '3346', '3157', '1616', '2218', '1432', '2948', '2759', '2894', '3096', '815', '2213', '3131', '2731', '2369', '2995', '801', '2419', '967', '1468', '1102', '271', '2334', '547', '2932', '779', '2226', '130', '2776', '2906', '632', '610', '1904', '740', '2556', '2911', '2020', '1059', '254', '3286', '3180', '1278', '2654', '290', '1612', '1753', '138', '2706', '3420', '462', '1579', '3228', '811', '2918', '1622', '2742', '1390', '922', '1242', '2244', '2539', '3068', '2688', '2505', '1570', '2457', '2029', '1638', '88', '277', '2898', '809', '2665', '2319', '1032', '1017', '1572', '3369', '1192', '1442', '533', '3184', '1486', '565', '2455', '783', '392', '76', '2480', '823', '1146', '1387', '3214', '1511', '2217', '2879', '225', '2407', '722', '1352', '2605', '782', '693', '113', '1205', '2310', '1407', '2829', '2164', '243', '1402', '1206', '2202', '2558', '465', '2296', '10', '80', '919', '87', '2152', '1713', '676', '2361', '1140', '1077', '2367', '535', '28', '434', '2351', '3065', '1497', '135', '2848', '682', '568', '2325', '1567', '2377', '1793', '814', '442', '356', '578', '3241', '1040', '2175', '2502', '2868', '3009', '3339', '1738', '830', '1512', '1323', '1603', '3158', '73', '104', '3162', '2302', '2311', '180', '3271', '3349', '3053', '3008', '2054', '1239', '1589', '2439', '2733', '1023', '486', '2493', '2846', '376', '2209', '2723', '3403', '2374', '980', '2997', '3394', '2308', '2206', '483', '3165', '1660', '2394', '3061', '3054', '901', '1418', '2740', '816', '2204', '3213', '3258', '1401', '912', '1986', '3265', '704', '1576', '807', '1615', '3381', '2346', '3294', '525', '1658', '3307', '1595', '2400', '820', '856', '684', '3091', '2696', '1405', '1826', '33', '2884', '885', '2739', '419', '3273', '2927', '1264', '1880', '622', '2566', '3338', '868', '2891', '2780', '1086', '2970', '1651', '1400', '1431', '1956', '1787', '378', '12', '798', '244', '788', '3027', '3321', '493', '3384', '894', '1936', '182', '114', '3077', '758', '1943', '2501', '2903', '1298', '2764', '953', '2460', '2298', '247', '2904', '1398', '1123', '1302', '309', '656', '739', '2082', '841', '2531', '1530', '833', '586', '86', '794', '159', '1031', '2332', '3024', '3164', '469', '2039', '1557', '3081', '150', '1806', '346', '1585', '3251', '1992', '401', '2422', '1889', '390', '1729', '1860', '1069', '2323', '2803', '3313', '1669', '2573', '1273', '2885', '2474', '3025', '1937', '2631', '3117', '1439', '330', '2912', '478', '2380', '1333', '269', '1710', '165', '2734', '1891', '3413', '2433', '139', '3378', '3007', '2590', '1212', '1861', '2022', '2991', '2519', '1691', '477', '214', '634', '2913', '172', '599', '2576', '2559', '2752', '1850', '2195', '3366', '2812', '2544', '1814', '1854', '1351', '908', '1131', '1648', '1553', '1404', '897', '2156', '1584', '1309', '375', '482', '187', '1795', '757', '1364', '2498', '1769', '721', '509', '450', '3086', '635', '3210', '3197', '2044', '2291', '581', '1209', '262', '183', '802', '518', '554', '2297', '1526', '3125', '1335', '624', '769', '3386', '1258', '364', '1516', '432', '2451', '44', '3137', '1241', '352', '1357', '2651', '2786', '9', '1618', '1307', '2446', '2196', '2726', '1451', '2909', '1383', '755', '2699', '59', '772', '1463', '2124', '3255', '1062', '2081', '3147', '353', '458', '3111', '1966', '196', '2101', '1979', '1965', '827', '328', '3229', '1343', '1518', '162', '203', '3268', '2789', '1730', '3088', '318', '1231', '1118', '1429', '1645', '3295', '456', '338', '3280', '2584', '2345', '2270', '270', '678', '1600', '250', '457', '96', '499', '2928', '3188', '1561', '1353', '2314', '2357', '1621', '1786', '1504', '847', '911', '2990', '934', '2042', '1843', '3201', '2132', '1071', '2888', '950', '3342', '403', '2112', '190', '2668', '2715', '2203', '344', '1556', '1200', '268', '2031', '333', '2899', '3099', '1010', '2963', '2695', '1837', '1498', '965', '1590', '1000', '2814', '1932', '151', '3182', '519', '2992', '178', '2229', '3014', '1954', '3133', '781', '1348', '2141', '285', '1016', '2062', '3236', '351', '2027', '2900', '571', '1346', '2674', '3156', '2714', '3262', '1869', '686', '2821', '233', '649', '1161', '1282', '3293', '1792', '970', '1388', '144', '238', '1143', '3079', '2280', '436', '2409', '593', '1308', '26', '787', '840', '1153', '2339', '2205', '3046', '3049', '2623', '93', '760', '2874', '3242', '1233', '1640', '1574', '2525', '2602', '3267', '1803', '592', '537', '2365', '490', '307', '631', '1906', '1235', '548', '1601', '987', '2287', '45', '2317', '1911', '2831', '1773', '1217', '3134', '2416', '1993', '2271', '3253', '2711', '2806', '2572', '1790', '903', '1175', '2383', '3192', '544', '1110', '3304', '1320', '2748', '3405', '1132', '160', '1286', '2093', '741', '1855', '900', '2917', '1702', '2541', '2277', '3159', '1454', '993', '1253', '3120', '2263', '2235', '1096', '883', '1808', '731', '949', '340', '2462', '2099', '106', '859', '1920', '2663', '3186', '1171', '709', '3036', '2214', '1116', '2972', '1245', '2037', '1113', '2720', '3064', '3067', '1655', '2985', '612', '2942', '2170', '223', '1073', '845', '2002', '3400', '511', '2459', '2521', '1057', '893', '1988', '1698', '1587', '1473', '942', '2304', '2473', '286', '998', '1996', '1636', '1126', '1962', '2378', '829', '3336', '2953', '791', '753', '1689', '491', '2395', '645', '729', '1326', '2994', '566', '2397', '951', '1219', '2613', '3128', '157', '2790', '3328', '2440', '2353', '974', '2074', '677', '1628', '2852', '1942', '1207', '2465', '3347', '3143', '701', '2116', '744', '2551', '2914', '1896', '1668', '1334', '1878', '2675', '880', '1846', '452', '954', '373', '975', '81', '1043', '3208', '1492', '728', '382', '40', '395', '2837', '1929', '397', '2256', '70', '905', '1865', '1139', '3115', '1214', '2560', '594', '1265', '992', '2993', '3076', '1958', '2286', '1631', '1908', '1514', '1070', '1029']

    test_ids = ['2727', '1785', '1799', '1778', '1249', '3238', '1336', '2212', '2372', '2925', '1856', '1117', '1758', '3218', '2386', '2390', '606', '488', '3317', '2129', '737', '2504', '235', '1997', '1739', '2450', '1457', '2863', '3136', '3002', '2656', '1306', '3141', '671', '405', '1301', '1185', '1704', '1254', '3402', '1672', '227', '2517', '3047', '3198', '683', '2669', '898', '2975', '3209', '2445', '513', '2157', '20', '2484', '2221', '546', '1098', '617', '1034', '3245', '1501', '654', '3235', '2760', '1445', '2869', '494', '2969', '2861', '3344', '2024', '770', '1250', '1248', '557', '1244', '2797', '3414', '2184', '284', '2608', '1662', '393', '2429', '2516', '2355', '1562', '2873', '3138', '763', '3281', '3121', '3129', '3035', '2463', '2466', '1725', '3343', '311', '2227', '2337', '120', '2228', '253', '1558', '3270', '394', '2807', '1887', '435', '579', '2811', '3411', '1952', '2137', '3116', '3374', '1538', '2420', '348', '1552', '1513', '1437', '1281', '591', '317', '1238', '2', '2766', '2981', '2895', '1819', '1213', '335', '615', '706', '239', '2488', '1817', '2486', '1064', '49', '2305', '1650', '184', '1287', '1177', '837', '945', '895', '445', '3066', '3187', '1157', '2275', '2248', '1274', '302', '2003', '2647', '3290', '2954', '2418', '2561', '2485', '343', '1646', '2658', '968', '1196', '3177', '1816', '1193', '455', '1488', '1550', '627', '3169', '92', '1277', '2810', '2563', '2813', '3383', '360', '97', '2326', '2198', '143', '2242', '1963', '943', '2959', '79', '1866', '2880', '2292', '1834', '2476', '1823', '1867', '2245', '2553', '2067', '1103', '1948', '2220', '759', '1020', '1841', '3282', '695', '972', '574', '261', '475', '384', '660', '3090', '2434', '11', '2261', '1928', '1255', '795', '1524', '1080', '559', '1765', '2628', '2907', '1191', '938', '54', '3355', '780', '2234', '881', '1261', '1289', '37', '2703', '2028', '1389', '220', '2087', '2258', '3391', '764', '2607', '2045', '3395', '2931', '1136', '1882', '924', '2193', '1363', '540', '2458', '383', '2968', '2988', '2293', '105', '2979', '63', '2072', '2428', '3062', '1894', '453', '1839', '3412', '2349', '785', '2490', '132', '1717', '3297', '2921', '813', '2984', '2241', '1338', '1862', '1976', '18', '47', '890', '2973', '1779', '1246', '1164', '323', '1747', '1169', '1870', '925', '1088', '2896', '3362', '2475', '716', '2182', '2252', '3306', '1078', '2049', '1319', '2685', '367', '2755', '2452', '1609', '3206', '2653', '2682', '2595', '53', '437', '1162', '2035', '2649', '2878', '1917', '242', '1674', '960', '790', '1983', '171', '498', '1696', '1825', '1322', '3298', '2178', '3161', '1913', '2841', '117', '2312', '2278', '219', '1886', '359', '2007', '1039', '1129', '724', '1048', '1007', '1436', '1975', '2078', '587', '1897', '1667', '2853', '749', '1385', '2401', '931', '2582', '1152', '186', '1109', '3103', '2641', '2436', '1477', '1135', '904', '1649', '2982', '874', '1532', '1170', '1138', '1654', '6', '1566', '1559', '838', '3232', '1608', '406', '1914', '2746', '2952', '892', '2956', '1690', '210', '2266', '82', '2609', '2259', '3089', '2840', '2237', '2006', '2041', '1679', '55', '1186', '1092', '2246', '2402', '1666', '36', '1985', '628', '805', '1188', '538', '3193', '1018', '102', '362', '1066', '2168', '2538', '2588', '517', '2761', '2805', '1377', '3315', '2453', '1833', '636', '84', '2130', '58', '3300', '986', '1970', '1464', '2139', '1788', '2862', '3277', '1099', '43', '2962', '3221', '471', '2097', '2527', '761', '2389', '1533', '3279', '1284', '2362', '1940', '1515', '1285', '3363', '3114', '1706', '2823', '2026', '2593', '3260', '1885', '3302', '2883', '1085', '1304', '13', '2855', '1629', '2877', '424', '982', '1599', '1182', '2616', '806', '2423', '1414', '1378', '2396', '1344', '3127', '3249', '3390', '2115', '2870', '371', '1150', '473', '2773', '2239', '1611', '2509', '1756', '2523', '2368', '1994', '3288', '1300', '2620', '1510', '750', '1984', '2414', '2010', '1951', '2849', '2095', '2265', '1033', '2940', '714', '1968', '697', '381', '1108', '3399', '2133', '175', '147', '2512', '1100', '502', '116', '1240', '2358', '1147', '1520', '2328', '2119', '1269', '1543', '1091', '1399', '2075', '1999', '1137', '1490', '800', '948', '410', '3179', '3303', '129', '1472', '2949', '596', '2915', '1499', '1072', '2000', '2307', '2619', '2176', '422', '3334', '886', '2478', '1700', '1596', '2599', '899', '1957', '850', '1828', '177', '839', '2622', '1542', '1707', '206', '416', '2059', '1736', '1101', '577', '336', '1329', '3299', '1236', '1766', '2834', '3256', '828', '1540', '2005', '2889', '917', '1536', '3173', '2194', '310', '1195', '1362', '1945', '1797', '563', '534', '3124', '2575', '1762', '1470', '616', '444', '1190', '1440', '256', '3045', '2467', '2210', '611', '2872', '1276', '3074', '377', '3163', '1509', '641', '280', '1247', '1529', '169', '2902', '226', '1709', '497', '1350', '421', '590', '2107', '2122', '2236', '2587', '342', '877', '1084', '2145', '2550', '2574', '1647', '1054', '3029', '589', '2140', '2826', '137', '2447', '1082', '2456', '1141', '3040', '2793', '2322', '1760', '2284', '2161', '411', '234', '3119', '438', '3259', '1313', '2340', '427', '2404', '2785', '2454', '2063', '3332', '1373', '2104', '194', '1751', '735', '3308', '685', '1555']

    Stride_Size = 128
    FOLDER = "/data5/GLGAN/datasets/"
    LABELS = ["0", "1", "2", "3", "4", "5","6","7","8","9","10","11","12","13","14"]
    N_CLASSES = len(LABELS) # Number of classes
    WEIGHTS = torch.ones(N_CLASSES) # Weights for class balancing
    MAIN_FOLDER = FOLDER + 'GID-15/'
    DATA_FOLDER = MAIN_FOLDER + 'images/{}.tif'
    LABEL_FOLDER = MAIN_FOLDER + 'label_RGB/{}.tif'
    BOUNDARY_FOLDER = MAIN_FOLDER + 'depth_1/{}.png'
    OBJECT_FOLDER = MAIN_FOLDER + 'depth_1/{}.png'
    ERODED_FOLDER = MAIN_FOLDER + 'label_RGB/{}.tif'
    # 转换后的调色板字典格式
    palette = {
        0: (200, 0, 0),  # Class 0
        1: (250, 0, 150),  # Class 1
        2: (200, 150, 150),  # Class 2
        3: (250, 150, 150),  # Class 3
        4: (0, 200, 0),  # Class 4
        5: (150, 250, 0),  # Class 5
        6: (150, 200, 150),  # Class 6
        7: (200, 0, 200),  # Class 7
        8: (150, 0, 250),  # Class 8
        9: (150, 150, 250),  # Class 9
        10: (250, 200, 0),  # Class 10
        11: (200, 200, 0),  # Class 11
        12: (0, 0, 200),  # Class 12
        13: (0, 150, 200),  # Class 13
        14: (0, 200, 250)  # Class 14
    }

    # 反转调色板（颜色到类索引）
    invert_palette = {v: k for k, v in palette.items()}

if DATASET == 'iSAID':

    train_ids =['78', '939', '299', '1048', '811', '732', '87', '196', '181', '924', '1170', '973', '675', '839', '896', '643', '1345', '108', '1379', '342', '1209', '1205', '697', '626', '638', '47', '1013', '243', '1243', '689', '402', '246', '319', '180', '99', '469', '1262', '1091', '1190', '16', '1347', '1373', '1212', '407', '1229', '208', '969', '1280', '88', '1016', '285', '783', '72', '138', '923', '1293', '900', '424', '354', '916', '487', '244', '1232', '787', '52', '600', '1277', '1143', '141', '91', '521', '216', '1181', '1071', '1167', '960', '523', '38', '1298', '18', '845', '1320', '188', '574', '735', '741', '989', '1269', '729', '42', '251', '296', '1073', '1138', '1057', '534', '1346', '1369', '119', '1160', '1148', '458', '947', '624', '975', '327', '90', '1100', '164', '392', '1061', '9', '637', '801', '1310', '601', '401', '1001', '1099', '773', '276', '30', '790', '1247', '1161', '1042', '252', '1410', '41', '190', '172', '1351', '558', '1007', '1349', '349', '1045', '1175', '1356', '290', '264', '957', '1215', '434', '1199', '659', '844', '1115', '1180', '259', '872', '113', '963', '776', '412', '993', '617', '948', '503', '111', '70', '1119', '150', '1102', '758', '778', '248', '1234', '1323', '719', '586', '1309', '548', '513', '1381', '1003', '1357', '1083', '646', '591', '980', '40', '1166', '463', '1333', '566', '486', '940', '1255', '1240', '904', '61', '983', '763', '114', '702', '779', '211', '441', '257', '494', '152', '194', '936', '1296', '1082', '450', '1246', '303', '1020', '835', '5', '161', '931', '727', '554', '866', '596', '1120', '1270', '632', '1179', '1235', '1268', '453', '1219', '1169', '79', '1065', '514', '1075', '1027', '409', '7', '101', '346', '46', '414', '1203', '295', '772', '432', '1213', '199', '1105', '227', '84', '942', '526', '863', '1077', '1040', '1113', '377', '1289', '1217', '1403', '265', '767', '917', '212', '994', '562', '139', '1330', '312', '630', '379', '1374', '692', '598', '656', '386', '817', '60', '567', '1261', '225', '1231', '289', '807', '394', '597', '1200', '29', '681', '515', '641', '822', '389', '284', '647', '1114', '112', '580', '830', '780', '191', '529', '25', '313', '362', '578', '604', '1005', '620', '1122', '226', '1131', '691', '128', '743', '437', '54', '950', '277', '298', '962', '1242', '792', '1140', '419', '109', '1018', '1218', '292', '147', '840', '1387', '754', '62', '222', '1409', '499', '717', '58', '914', '1225', '998', '140', '1006', '650', '495', '918', '564', '818', '669', '1142', '901', '986', '535', '1249', '1155', '1389', '80', '707', '511', '706', '1245', '404', '163', '240', '1111', '446', '837', '1273', '1047', '1400', '1074', '907', '1411', '1334', '21', '170', '279', '1132', '1297', '593', '1052', '771', '1183', '550', '1164', '176', '770', '570', '43', '22', '497', '510', '374', '1228', '1244', '634', '670', '703', '1009', '577', '410', '606', '1352', '1008', '381', '673', '1127', '1014', '1222', '496', '217', '613', '236', '1002', '625', '559', '967', '261', '898', '1173', '28', '849', '35', '935', '31', '897', '911', '177', '405', '421', '1067', '1103', '131', '751', '793', '365', '100', '836', '581', '1295', '694', '142', '742', '1292', '708', '185', '66', '192', '1204', '712', '775', '418', '1123', '316', '466', '182', '1250', '293', '17', '1390', '1239', '658', '544', '944', '144', '1316', '1367', '965', '439', '57', '77', '3', '552', '157', '1129', '540', '169', '1303', '371', '1401', '1176', '1317', '154', '803', '1253', '86', '229', '24', '1', '324', '6', '576', '1287', '1010', '1321', '847', '59', '922', '1068', '232', '1191', '1171', '1335', '1282', '855', '880', '193', '1362', '263', '533', '472', '355', '1108', '492', '13', '583', '1039', '268', '455', '1407', '1385', '76', '1097', '1159', '1135', '238', '813', '820', '1023', '759', '1158', '1257', '1144', '619', '96', '1156', '833', '590', '1041', '1211', '800', '352', '1182', '364', '921', '1126', '810', '1405', '928', '977', '740', '710', '456', '1259', '353', '786', '266', '530', '1012', '545', '1339', '1146', '376', '477', '1019', '1325', '8', '864', '461', '347', '1130', '686', '698', '1035', '1153', '338', '628', '122', '1086', '603', '1049', '666', '501', '979', '1015', '1085', '335', '195', '378', '663', '946', '556', '148', '465', '895', '314', '135', '171', '341', '1116', '517', '919', '959', '234', '63', '1256', '1033', '1263', '890', '662', '688', '104', '213', '520', '874', '53', '1137', '130', '575', '10', '435', '239', '752', '133', '584', '639', '413', '1308', '899', '97', '468', '36', '1272', '50', '73', '1230', '1078', '270', '541', '1192', '748', '2', '755', '283', '1342', '429', '913', '45', '573', '1353', '1368', '838', '311', '1206', '1223', '1150', '254', '444', '360', '115', '206', '1301', '938', '1328', '1284', '398', '159', '282', '1311', '832', '1186', '1038', '197', '1224', '1281', '470', '766', '1364', '479', '357', '856', '769', '256', '933', '756', '428', '1044', '867', '106', '988', '502', '275', '1124', '422', '865', '902', '695', '83', '912', '781', '930', '1248', '718', '68', '480', '23', '168', '929', '1021', '351', '1147', '622', '383', '490', '842', '85', '375', '173', '592', '235', '118', '738', '149', '700', '1095', '273', '621', '819', '997', '55', '317', '906', '447', '1032', '306', '958', '1386', '560', '954', '665', '1370', '653', '393', '1000', '1267', '253', '44', '827', '262', '1306', '1210', '629', '1343', '245', '1375', '1355', '369', '1382', '242', '366', '1380', '39', '804', '795', '489', '816', '1336', '203', '538', '396', '655', '215', '660', '322', '785', '1359', '82', '1402', '834', '871', '1118', '33', '423', '726', '1384', '953', '95', '1046', '978', '221', '652', '582', '204', '187', '1391', '183', '815', '861', '1324', '927', '531', '89', '1163', '542', '684', '760', '1070', '1408', '843', '48', '661', '1227', '976', '127', '1087', '1121', '1214', '910', '110', '563', '373', '891', '968', '332', '343', '300', '281', '426', '654', '1236', '1319', '427', '814', '860', '210', '443', '471', '1360', '723', '888', '873', '1084', '1060', '304', '411', '1329', '696', '714', '37', '894', '175', '1036', '358', '308', '532', '126', '337', '200', '174', '1112', '205', '1226', '467', '321', '449', '1110', '297', '972', '762', '1125', '209', '996', '269', '189', '920', '823', '657', '1312', '876', '809', '1254', '1237', '1233', '258', '974', '764', '359', '799', '1187', '693', '64', '1022', '323', '350', '1051', '831', '498', '1315', '671', '879', '387', '609', '395', '146', '862', '1279', '825', '999', '356', '1221', '20', '1220', '385', '853', '125', '674', '949', '309', '505', '287', '851', '103', '433', '1157', '1168', '528', '1340', '1354', '1197', '1332', '1299', '805', '1141', '587', '302', '123', '745', '951', '1024', '19', '854', '1278', '482', '934', '1104', '852', '228', '202', '677', '956', '782', '905', '903', '372', '522', '320', '348', '491', '165', '178', '955', '551', '716', '336', '1313', '1376', '683', '121', '368', '870', '1149', '676', '721', '334', '543', '1088', '448', '49', '69', '744', '664', '925', '1395', '1331', '537', '1025', '699', '156', '730', '599', '301', '4', '328', '1275', '1189', '1397', '749', '1069', '1294', '1338', '1093', '1383', '720', '1165', '278', '797', '848', '1064', '430', '415', '1202', '367', '516', '1276', '198', '970', '440', '391', '460', '105', '709', '627', '1207', '143', '824', '331', '525', '649', '964', '1026', '1348', '612', '241', '92', '1344', '214', '615', '642', '417', '711', '644', '120', '94', '731', '1056', '1109', '611', '478', '442', '416', '588', '512', '305', '651', '219', '1058', '798', '116', '982', '1090', '859', '158', '32', '160', '610', '971', '943', '294', '310', '267', '223', '1314', '1184', '1092', '794', '571', '568', '475', '1201', '858', '614', '1133', '1128', '71', '459', '690', '915', '1271', '1076', '618', '892', '846', '536', '1406', '987', '857', '1251', '81', '361', '633', '1193', '765', '1361', '117', '1286', '1196', '877', '1337', '546', '408', '747', '1398', '1107', '484', '1302', '826', '806', '893', '685', '1241', '1300', '51', '425', '882', '179', '162', '333', '985', '1258', '436']

    test_ids = ['1117', '500', '330', '1106', '136', '715', '399', '218', '1096', '390', '812', '1378', '1053', '260', '1062', '370', '784', '93', '220', '1178', '1198', '1172', '1188', '98', '420', '821', '15', '307', '1291', '594', '1028', '237', '1394', '909', '1134', '737', '247', '1388', '952', '768', '640', '557', '1350', '761', '329', '648', '1318', '230', '34', '1089', '504', '145', '488', '1145', '1152', '734', '1043', '14', '1393', '1050', '565', '705', '990', '524', '631', '1307', '1290', '255', '616', '1371', '992', '1054', '397', '380', '1154', '1194', '291', '1285', '746', '1195', '589', '753', '207', '1327', '1238', '667', '608', '485', '155', '788', '518', '1079', '991', '701', '1274', '796', '132', '151', '883', '595', '1365', '725', '454', '679', '682', '1266', '1177', '774', '431', '137', '1366', '1304', '945', '1055', '547', '481', '233', '280', '340', '1066', '231', '602', '1080', '887', '1363', '937', '452', '286', '56', '483', '884', '507', '850', '561', '67', '363', '926', '1037', '808', '966', '201', '941', '344', '1305', '249', '555', '961', '713', '1216', '457', '829', '438', '1283', '841', '473', '26', '868', '875', '272', '1004', '382', '462', '777', '1185', '1252', '325', '1399', '1139', '1372', '668', '704', '250', '605', '995', '506', '1341', '107', '1101', '1174', '493', '539', '1208', '549', '400', '527', '153', '1029', '271', '908', '885', '1030', '981', '869', '791', '1011', '932', '636', '1017', '733', '1396', '384', '1094', '1288', '451', '878', '134', '645', '881', '728', '750', '886', '607', '722', '224', '1404', '569', '553', '889', '508', '74', '509', '1098', '572', '623', '1063', '802', '579', '274', '65', '1059', '1326', '186', '680', '474', '11', '1081', '318', '724', '345', '75', '326', '339', '167', '124', '1322', '184', '102', '403', '166', '1392', '1260', '1377', '789', '315', '828', '585', '445', '476', '406', '464', '1264', '757', '12', '1031', '672', '1151', '678', '1072', '519', '1034', '1136', '27', '288', '736', '687', '984', '635', '129', '739', '1162', '388', '1358', '1265']

    Stride_Size = 128
    FOLDER = "/data5/GLGAN/datasets/"
    LABELS = ["0", "1", "2", "3", "4", "5","6","7","8","9","10","11","12","13","14"]
    N_CLASSES = len(LABELS) # Number of classes
    WEIGHTS = torch.ones(N_CLASSES) # Weights for class balancing
    MAIN_FOLDER = FOLDER + 'iSAID/'
    DATA_FOLDER = MAIN_FOLDER + 'images/{}.png'
    LABEL_FOLDER = MAIN_FOLDER + 'label_RGB/{}.png'
    BOUNDARY_FOLDER = MAIN_FOLDER + 'depth_1/{}.png'
    OBJECT_FOLDER = MAIN_FOLDER + 'depth_1/{}.png'
    ERODED_FOLDER = MAIN_FOLDER + 'label_RGB/{}.png'
    # 转换后的调色板字典格式
    palette = {
        0: (0, 0, 63),  # Class 0
        1: (0, 63, 63),  # Class 1
        2: (0, 63, 0),  # Class 2
        3: (0, 63, 127),  # Class 3
        4: (0, 63, 191),  # Class 4
        5: (0, 63, 255),  # Class 5
        6: (0, 127, 63),  # Class 6
        7: (0, 127, 127),  # Class 7
        8: (0, 0, 127),  # Class 8
        9: (0, 0, 191),  # Class 9
        10: (0, 0, 255),  # Class 10
        11: (0, 191, 127),  # Class 11
        12: (0, 127, 191),  # Class 12
        13: (0, 127, 255),  # Class 13
        14: (0, 100, 155)  # Class 14
    }

    # 反转调色板（颜色到类索引）
    invert_palette = {v: k for k, v in palette.items()}


if DATASET == 'MER':

    train_ids =['97', '541', '799', '214', '411', '80', '828', '723', '276', '59', '192', '682', '144', '187', '1014', '493', '856', '767', '21', '118', '922', '343', '639', '482', '1047', '488', '44', '667', '956', '301', '841', '954', '973', '243', '933', '516', '6', '983', '957', '317', '564', '52', '260', '917', '281', '708', '15', '314', '49', '10', '3', '333', '556', '181', '868', '979', '297', '390', '379', '668', '215', '348', '980', '560', '637', '205', '506', '827', '575', '222', '156', '73', '762', '234', '94', '511', '1061', '790', '653', '418', '734', '1057', '1000', '997', '32', '113', '478', '513', '35', '357', '311', '571', '290', '38', '91', '127', '642', '140', '308', '424', '1005', '608', '71', '248', '861', '789', '659', '405', '823', '322', '504', '324', '274', '1027', '758', '498', '940', '927', '657', '686', '361', '434', '512', '329', '855', '988', '974', '616', '849', '420', '626', '57', '798', '874', '813', '78', '851', '860', '786', '401', '909', '660', '446', '882', '37', '89', '341', '259', '863', '55', '946', '510', '802', '992', '783', '302', '809', '953', '452', '174', '818', '754', '412', '255', '67', '271', '1020', '136', '1017', '402', '845', '985', '699', '633', '538', '518', '662', '392', '1040', '275', '272', '1030', '386', '47', '286', '338', '898', '651', '867', '738', '473', '817', '565', '948', '797', '519', '720', '484', '416', '431', '238', '681', '495', '617', '1029', '393', '780', '443', '232', '731', '649', '471', '590', '912', '413', '186', '347', '670', '382', '553', '46', '489', '562', '573', '650', '310', '335', '914', '692', '88', '155', '395', '710', '396', '148', '858', '899', '496', '56', '179', '500', '132', '458', '929', '1035', '342', '977', '464', '945', '586', '437', '171', '166', '665', '733', '201', '92', '330', '1032', '964', '450', '749', '105', '200', '724', '926', '570', '162', '117', '644', '871', '862', '782', '551', '240', '346', '569', '157', '43', '947', '903', '842', '456', '994', '269', '277', '82', '19', '403', '764', '803', '890', '441', '319', '839', '937', '447', '384', '857', '252', '795', '924', '408', '244', '1023', '804', '25', '529', '930', '251', '385', '208', '656', '60', '578', '744', '943', '902', '623', '364', '881', '647', '397', '843', '1011', '289', '776', '679', '634', '508', '76', '426', '884', '889', '430', '1044', '931', '467', '438', '597', '528', '703', '209', '415', '793', '696', '376', '87', '535', '195', '183', '701', '247', '552', '661', '487', '756', '378', '840', '777', '479', '962', '887', '29', '894', '698', '1049', '66', '866', '111', '404', '836', '770', '374', '428', '521', '919', '64', '913', '368', '747', '417', '20', '202', '101', '920', '287', '574', '503', '904', '161', '340', '517', '151', '172', '705', '605', '380', '1012', '635', '550', '427', '106', '65', '477', '99', '736', '601', '944', '1062', '14', '800', '167', '69', '228', '28', '154', '967', '714', '230', '349', '995', '779', '976', '1033', '830', '305', '713', '694', '485', '26', '79', '1064', '455', '175', '459', '12', '907', '932', '949', '939', '999', '965', '846', '918', '619', '1016', '109', '986', '676', '7', '439', '629', '549', '120', '1015', '588', '4', '263', '928', '40', '462', '213', '987', '716', '717', '750', '941', '249', '191', '98', '134', '451', '522', '824', '559', '545', '359', '515', '751', '350', '466', '354', '896', '391', '826', '915', '253', '775', '577', '470', '146', '328', '475', '607', '18', '704', '429', '50', '356', '8', '264', '270', '128', '643', '838', '759', '675', '677', '112', '102', '576', '216', '822', '285', '1019', '715', '45', '700', '1038', '706', '951', '84', '158', '688', '611', '1018', '453', '461', '176', '534', '612', '959', '190', '671', '180', '406', '30', '916', '225', '143', '725', '351', '523', '810', '625', '1039', '579', '952', '95', '572', '492', '278', '399', '972', '695', '905', '1009', '732', '663', '1059', '398', '566', '114', '193', '632', '1022', '358', '853', '624', '177', '142', '400', '198', '739', '224', '875', '494', '773', '1042', '100', '895', '1031', '292', '761', '563', '362', '606', '107', '923', '938', '652', '313', '1056', '367', '829', '693', '546', '1055', '457', '315', '850', '958', '707', '75', '658', '23', '321', '886', '115', '524', '123', '812', '164', '296', '587', '360', '1006', '906', '282', '557', '567', '687', '440', '435', '39', '295', '77', '375', '885', '966', '825', '942', '256', '526', '31', '254', '542', '1010', '620', '325', '609', '145', '520', '454', '741', '219', '242', '1024', '745', '711', '170', '1046', '62', '771', '769', '421', '502', '722', '284', '785', '1041', '788', '514', '110', '891', '525', '51', '730', '61', '469', '581', '149', '993', '684', '283', '702', '1054', '13', '265', '352', '806', '262', '409', '476', '1052', '472', '410', '491', '600', '345', '835', '615', '116', '1001', '159', '327', '1028', '463', '674', '307', '935', '757', '561', '864', '879', '768', '547', '139', '536', '796', '445', '936', '280', '169', '1021', '755', '1037', '655', '631', '196', '48', '366', '532', '33', '474', '678', '568', '58', '628', '595', '594', '1063', '372', '618', '934', '765', '221', '486', '554', '1036', '383', '74', '859', '805', '968', '592', '468', '963', '226', '288', '847', '888', '497', '212', '1034', '369', '645', '320', '630', '1060', '267', '373', '990', '1007', '540', '204', '961', '239', '318', '465', '203', '583', '241', '527', '811', '1003', '690', '304', '950', '709', '246', '419', '1045', '407', '673', '543', '729', '1058', '168', '72', '86', '691', '669', '807', '303', '989', '442', '603', '235', '217', '792', '54', '854', '848', '236', '90', '627', '337', '740', '544', '900', '820', '666', '499', '1025', '103', '165', '133', '880', '955', '231', '1026', '150', '530', '1050', '153', '548', '189', '332', '689', '147', '844', '27', '96', '306', '11', '873', '815', '293', '130', '794', '273', '268', '614', '584', '365', '432', '648', '727', '897']

    test_ids = ['816', '539', '808', '83', '448', '585', '121', '654', '883', '131', '300', '245', '68', '752', '558', '124', '982', '433', '599', '1004', '978', '505', '911', '821', '589', '194', '760', '748', '613', '41', '119', '16', '394', '279', '2', '34', '975', '220', '227', '126', '481', '257', '182', '423', '81', '910', '17', '258', '680', '377', '233', '93', '533', '876', '726', '178', '781', '125', '998', '636', '555', '344', '184', '326', '388', '291', '323', '331', '1053', '490', '218', '298', '602', '22', '893', '970', '721', '316', '509', '878', '664', '211', '971', '137', '24', '70', '460', '638', '865', '610', '449', '353', '371', '444', '129', '483', '537', '791', '580', '737', '870', '901', '370', '261', '309', '138', '984', '593', '640', '108', '683', '672', '299', '778', '339', '104', '355', '834', '122', '160', '604', '42', '819', '981', '414', '250', '742', '63', '728', '197', '294', '531', '1048', '996', '334', '223', '207', '869', '960', '774', '1013', '969', '831', '746', '772', '582', '507', '237', '814', '921', '833', '199', '425', '1002', '363', '141', '5', '719', '685', '1043', '163', '925', '784', '712', '718', '185', '210', '801', '787', '480', '36', '991', '436', '892', '877', '389', '173', '641', '1008', '501', '837', '9', '135', '85', '598', '908', '763', '1051', '591', '312', '188', '206', '336', '697', '1', '622', '152', '381', '422', '743', '852', '266', '646', '387', '735', '872', '53', '832', '596', '766', '229', '753', '621']

    Stride_Size = 128
    FOLDER = "/data5/GLGAN/datasets/"
    LABELS = ["0", "1", "2", "3", "4", "5","6","7","8"]
    N_CLASSES = len(LABELS) # Number of classes
    WEIGHTS = torch.ones(N_CLASSES) # Weights for class balancing
    MAIN_FOLDER = FOLDER + 'MER/'
    DATA_FOLDER = MAIN_FOLDER + 'images/{}.jpg'
    LABEL_FOLDER = MAIN_FOLDER + 'label_RGB/{}.png'
    BOUNDARY_FOLDER = MAIN_FOLDER + 'depth_1/{}.png'
    OBJECT_FOLDER = MAIN_FOLDER + 'depth_1/{}.png'
    ERODED_FOLDER = MAIN_FOLDER + 'label_RGB/{}.png'
    # 转换后的调色板字典格式
    palette = {
        0: (128, 0, 0),  # Class 0
        1: (0, 128, 0),  # Class 1
        2: (128, 128, 0),  # Class 2
        3: (0, 0, 128),  # Class 3
        4: (128, 0, 128),  # Class 4
        5: (0, 128, 128),  # Class 5
        6: (128, 128, 128),  # Class 6
        7: (64, 0, 0),  # Class 7
        8: (192, 0, 0)  # Class 8
    }

    # 反转调色板（颜色到类索引）
    invert_palette = {v: k for k, v in palette.items()}

if DATASET == 'MSL':

    train_ids =['1808', '3339', '2937', '76', '3134', '2474', '2286', '3564', '1185', '470', '991', '598', '1611', '796', '1467', '1161', '1559', '2137', '1238', '2044', '2257', '1052', '1844', '2666', '891', '2680', '371', '319', '1247', '819', '3430', '1879', '3885', '2075', '471', '1995', '3470', '3785', '666', '2059', '3681', '690', '3896', '2904', '1272', '1951', '647', '2640', '3606', '1070', '3841', '785', '401', '2397', '1667', '2032', '1671', '3462', '716', '3926', '3384', '2033', '2079', '692', '3187', '3173', '2203', '3348', '1840', '1230', '807', '3864', '128', '118', '2394', '3333', '2987', '3264', '3419', '381', '2057', '546', '2451', '9', '3352', '2766', '1668', '2362', '782', '1976', '445', '2368', '651', '1457', '3104', '3615', '2864', '1001', '87', '2824', '1357', '2046', '2969', '2757', '984', '435', '2958', '3765', '413', '544', '1593', '1377', '1217', '36', '3232', '2252', '46', '2001', '3619', '551', '3790', '1381', '1331', '839', '2225', '2388', '1653', '465', '2705', '242', '3344', '3658', '2098', '277', '1678', '1900', '1578', '1931', '2148', '2731', '3694', '355', '995', '74', '2029', '659', '3642', '784', '1810', '685', '3195', '34', '473', '1501', '3731', '1009', '107', '3177', '815', '1669', '2839', '69', '1735', '1300', '2851', '1474', '2845', '2996', '1469', '1540', '2237', '1059', '2875', '2372', '1291', '2595', '333', '894', '843', '3882', '3570', '3370', '3018', '3277', '3880', '3809', '3577', '2543', '873', '3636', '639', '3712', '2405', '3623', '1450', '1622', '1590', '1619', '3800', '626', '1164', '2395', '2817', '3071', '3750', '2403', '3354', '3328', '3723', '1510', '2376', '882', '789', '2191', '862', '357', '2794', '2557', '1534', '1920', '1094', '3112', '1899', '1695', '3289', '3387', '3373', '58', '3556', '2526', '1732', '3604', '3514', '787', '887', '2392', '2809', '32', '2306', '2676', '1466', '497', '2012', '1212', '2402', '1703', '156', '240', '2024', '1047', '1953', '2591', '416', '540', '3907', '2107', '2486', '112', '2866', '972', '1729', '2847', '1335', '1837', '2499', '198', '3483', '686', '3295', '3286', '3545', '2370', '3575', '2844', '3526', '3887', '1720', '917', '491', '1332', '362', '1723', '3740', '662', '1309', '914', '2452', '1587', '1061', '2545', '2126', '2903', '844', '1828', '3690', '2963', '2294', '3818', '2590', '3795', '2978', '1406', '2988', '207', '2481', '1718', '3244', '2840', '3911', '2410', '3416', '3233', '3253', '1233', '3782', '104', '1420', '3863', '3126', '227', '1362', '2398', '1612', '970', '3341', '2629', '1437', '3850', '2171', '2547', '3817', '1866', '1602', '3466', '3006', '3114', '2783', '3490', '1051', '3618', '3599', '1833', '1193', '2058', '212', '3155', '2208', '3924', '1039', '3250', '3223', '2482', '605', '506', '495', '1113', '3844', '3008', '1167', '133', '3699', '2994', '2764', '1298', '3320', '3162', '3284', '1266', '768', '3587', '2520', '464', '2119', '2549', '2831', '2511', '2552', '910', '577', '1599', '3761', '951', '3304', '216', '3395', '1781', '3563', '2399', '1500', '3444', '3835', '3217', '618', '41', '1404', '2760', '523', '2945', '2187', '1853', '719', '2928', '1917', '2356', '3210', '572', '1584', '1924', '2353', '3914', '3163', '3855', '2186', '1124', '3524', '163', '288', '3808', '763', '1832', '405', '2453', '2539', '2350', '3772', '710', '3744', '70', '966', '2992', '2527', '1827', '459', '2078', '3756', '3382', '117', '1944', '2487', '3239', '2299', '2881', '2504', '1663', '57', '462', '1958', '3862', '574', '3100', '3079', '1486', '1234', '1969', '2227', '713', '2799', '1942', '73', '3170', '1092', '630', '1521', '2470', '3739', '3487', '667', '1089', '3403', '3206', '1243', '1861', '3491', '3215', '1248', '457', '846', '315', '896', '565', '834', '2934', '2184', '3238', '90', '3422', '1465', '3597', '2944', '2784', '2677', '3351', '3482', '2716', '852', '1597', '634', '996', '911', '44', '1109', '2345', '1473', '2026', '2758', '3710', '353', '2805', '1897', '2280', '3548', '3012', '3572', '1141', '2751', '2691', '1042', '2572', '726', '1525', '2155', '1987', '3230', '564', '2142', '1818', '1455', '28', '3121', '1551', '340', '3485', '3102', '786', '929', '1296', '2933', '1829', '2228', '477', '2668', '2412', '251', '2271', '1783', '2325', '3840', '391', '225', '562', '2207', '424', '1570', '1057', '1758', '3433', '1072', '691', '239', '2524', '2870', '3820', '813', '1960', '1277', '3332', '3531', '3879', '7', '802', '1199', '1542', '2411', '3431', '556', '1679', '3150', '358', '1709', '545', '2732', '2066', '2478', '1759', '1520', '1452', '733', '3579', '2508', '2068', '3375', '500', '2320', '498', '3920', '3675', '258', '3442', '2648', '3705', '968', '1696', '3735', '868', '2573', '990', '155', '973', '1173', '928', '3488', '232', '1342', '3627', '1418', '3551', '91', '794', '957', '2400', '2307', '3094', '3176', '2925', '3894', '3182', '3236', '3734', '2982', '2505', '55', '1926', '2217', '3429', '2815', '889', '2708', '1411', '3657', '1386', '454', '3644', '1889', '1262', '1849', '2949', '1766', '2438', '2429', '2852', '867', '1276', '1623', '2173', '3139', '1497', '748', '217', '2021', '2176', '3448', '3828', '2017', '2531', '1195', '2553', '3321', '519', '1356', '3335', '1425', '442', '3581', '1147', '1906', '3475', '1761', '2386', '3081', '797', '2437', '3127', '3439', '4', '1318', '2210', '663', '3706', '971', '2240', '969', '3478', '976', '3330', '2006', '2632', '1055', '3293', '2923', '1892', '3753', '1267', '3427', '3073', '2221', '3562', '2516', '1740', '1314', '2694', '1860', '2940', '302', '3411', '1274', '816', '1349', '2491', '515', '1196', '832', '2396', '2005', '1691', '1442', '913', '2382', '1835', '1820', '25', '1068', '1129', '1095', '1940', '3229', '113', '905', '3923', '3567', '1526', '3003', '1007', '3391', '176', '1422', '3186', '641', '466', '1365', '2765', '655', '2448', '2494', '1368', '2709', '3130', '3160', '2529', '2297', '1915', '3398', '1727', '3366', '2369', '226', '3876', '1481', '3687', '115', '2920', '1564', '3501', '2530', '171', '622', '2330', '3917', '2011', '3371', '3085', '2617', '2292', '3198', '823', '2061', '1847', '520', '1045', '1925', '1480', '2102', '3791', '134', '276', '415', '2426', '883', '2197', '213', '1998', '180', '1643', '3202', '2279', '2954', '941', '407', '86', '1389', '1575', '105', '1801', '1908', '931', '3881', '3001', '2118', '2707', '1056', '3039', '1385', '960', '2464', '2220', '1432', '1795', '2555', '2174', '908', '3290', '698', '3707', '3314', '946', '249', '1568', '2305', '3616', '581', '752', '1676', '2083', '2756', '3067', '3505', '2561', '2514', '2359', '2379', '573', '3742', '2140', '601', '3196', '1203', '1549', '411', '301', '2144', '2377', '3510', '3436', '922', '2999', '2571', '75', '3385', '162', '2599', '1518', '224', '2583', '3900', '3028', '2194', '2971', '2268', '493', '2873', '559', '2022', '2596', '1038', '1964', '2050', '1651', '1704', '496', '2211', '1337', '2686', '798', '649', '3088', '2586', '1242', '743', '765', '3737', '2', '824', '2371', '3708', '1682', '1708', '1198', '51', '1037', '3738', '3122', '3780', '2218', '1980', '2974', '265', '2101', '3779', '508', '2201', '3273', '1965', '1446', '1482', '708', '3004', '2922', '161', '2106', '1680', '1444', '1918', '3481', '774', '2479', '1690', '915', '1585', '1012', '275', '1950', '3220', '1582', '290', '1322', '2828', '2685', '3649', '3271', '2902', '1163', '1863', '1685', '2769', '2117', '3285', '778', '1747', '580', '1396', '2077', '318', '1083', '2256', '576', '1175', '1142', '2850', '681', '1380', '157', '632', '3656', '1062', '2827', '1227', '522', '3242', '1428', '108', '2245', '50', '3786', '3757', '3110', '1307', '898', '1996', '729', '80', '1636', '2970', '2739', '3626', '2298', '3892', '3007', '278', '1429', '1633', '2989', '1048', '2409', '2993', '1105', '1138', '2490', '2341', '1815', '29', '2070', '2931', '3910', '335', '2981', '942', '3718', '332', '298', '3883', '1724', '2521', '2935', '1846', '2683', '2183', '1376', '1870', '1306', '1215', '1348', '646', '43', '2650', '3528', '673', '2430', '1186', '769', '2324', '3267', '1498', '2497', '3172', '2807', '3306', '1910', '1649', '3541', '3717', '186', '3302', '1281', '958', '2180', '2152', '2475', '285', '3822', '2009', '3805', '3129', '3325', '2621', '2178', '1806', '1981', '3124', '2746', '2074', '2869', '2219', '3661', '3056', '3063', '2859', '3598', '1355', '1577', '711', '1076', '3168', '3251', '3747', '1245', '314', '1148', '2138', '262', '1289', '1326', '1312', '8', '3671', '1675', '2340', '3888', '3133', '2601', '2613', '12', '116', '3026', '856', '236', '2907', '2108', '1745', '2027', '2175', '3317', '1854', '3506', '2160', '2788', '3702', '2342', '3346', '1204', '3899', '3312', '1067', '246', '2085', '141', '3278', '1855', '2327', '2449', '841', '1662', '402', '2417', '2602', '1990', '1514', '2485', '1625', '1640', '2916', '530', '2800', '2086', '811', '1080', '472', '22', '2718', '208', '3854', '521', '408', '1229', '1792', '433', '1660', '1569', '3726', '3441', '1174', '2953', '2258', '1069', '2290', '2422', '1579', '3639', '2753', '3064', '3632', '126', '2458', '1383', '2779', '2980', '3525', '1812', '2134', '2592', '2168', '2373', '3477', '422', '1485', '934', '195', '244', '2270', '1064', '478', '2143', '1478', '1851', '853', '2962', '1934', '793', '1407', '1462', '963', '3715', '3693', '3049', '1237', '3418', '3105', '606', '2986', '1873', '3494', '3248', '3830', '3136', '2308', '1366', '3334', '427', '2887', '587', '3476', '2579', '1401', '3484', '1468', '2251', '1382', '1279', '2042', '1115', '2056', '1395', '0', '1293', '1015', '428', '1901', '2880', '3426', '1125', '2879', '3324', '1013', '2706', '1086', '1771', '1461', '2740', '3638', '3612', '1555', '367', '3059', '640', '1604', '370', '2642', '732', '1628', '2701', '406', '2623', '384', '369', '2065', '100', '201', '1214', '3774', '2835', '705', '390', '2796', '1341', '1821', '1063', '1336', '1100', '644', '1187', '2365', '463', '2901', '3508', '310', '1923', '746', '2849', '1916', '1216', '142', '3515', '1102', '2927', '907', '2471', '184', '2104', '199', '1135', '1085', '1121', '1903', '3062', '3611', '1553', '1028', '187', '3700', '2289', '1756', '3898', '1538', '1875', '65', '2717', '2469', '2115', '88', '3613', '3358', '2512', '2559', '2593', '1804', '2939', '1952', '1171', '2759', '247', '940', '26', '1228', '2871', '2146', '2282', '821', '1000', '2966', '2124', '1600', '1155', '2303', '1657', '527', '2128', '1449', '1363', '3512', '3336', '3268', '742', '193', '374', '1156', '1516', '3580', '2250', '553', '3329', '1088', '3420', '3647', '956', '3719', '2312', '1576', '829', '166', '814', '283', '537', '1202', '3151', '2619', '3369', '3770', '2995', '1191', '2811', '2419', '284', '1673', '2503', '2109', '919', '1588', '1447', '1024', '2546', '2698', '1887', '1936', '2826', '2692', '3394', '2674', '2704', '2736', '3468', '2205', '1090', '1561', '2076', '1779', '1409', '2424', '2192', '67', '1858', '709', '2500', '2338', '1572', '3153', '1403', '2013', '2375', '3792', '37', '2460', '205', '596', '2797', '610', '3603', '2582', '3144', '507', '3680', '1016', '738', '174', '1816', '1477', '1705', '3023', '2885', '1483', '3140', '2346', '2955', '2568', '628', '1654', '3035', '30', '3549', '3074', '783', '485', '845', '2223', '665', '3532', '3543', '3812', '1443', '2332', '3368', '2606', '2518', '2391', '1912', '2266', '1458', '2195', '1400', '3674', '1714', '1616', '3486', '3727', '861', '1181', '2627', '2354', '2233', '3460', '3561', '3497', '3843', '3825', '2151', '1077', '2030', '1354', '3408', '3424', '3594', '3311', '1972', '835', '3090', '1424', '2991', '3721', '706', '2374', '1563', '127', '3025', '173', '499', '3044', '3040', '2461', '3566', '1197', '1226', '2959', '45', '2938', '3764', '880', '1686', '3838', '3748', '2036', '3406', '1297', '101', '5', '2947', '3146', '2926', '53', '460', '1074', '3208', '2558', '13', '1566', '2421', '718', '3038', '1301', '182', '3437', '3467', '2492', '1413', '2111', '1697', '2882', '2100', '3307', '3005', '3569', '2830', '1323', '1993', '1798', '1374', '2960', '1391', '2878', '376', '2162', '2408', '3209', '222', '2950', '488', '3340', '2288', '1699', '221', '703', '1303', '3517', '1084', '3509', '2496', '2833', '2159', '2728', '1140', '2696', '181', '764', '2906', '3280', '3029', '509', '2695', '771', '2587', '3536', '248', '1002', '3858', '3045', '1743', '3179', '2900', '368', '83', '2313', '398', '997', '1097', '1260', '3866', '2094', '831', '3803', '1264', '2790', '85', '3019', '2979', '2930', '773', '2625', '761', '3184', '452', '1043', '3451', '2735', '2905', '82', '3492', '1165', '2105', '2080', '2667', '3445', '1358', '482', '1823', '210', '3725', '254', '3276', '3793', '492', '614', '513', '3823', '2067', '3355', '767', '3310', '1776', '1605', '3089', '589', '875', '2455', '1157', '830', '1614', '347', '854', '3274', '3754', '526', '2275', '1240', '3376', '3203', '2418', '1359', '1130', '1390', '3053', '687', '1209', '2390', '1725', '3032', '1589', '674', '2729', '1375', '1914', '617', '1158', '409', '772', '2267', '607', '3901', '2967', '3537', '179', '327', '3807', '1475', '3834', '3299', '3534', '1805', '714', '2158', '1451', '1504', '280', '1845', '2209', '1949', '2015', '2688', '2897', '2226', '1241', '2244', '3365', '2678', '3849', '693', '736', '3557', '3746', '2793', '172', '2721', '3546', '3322', '2541', '672', '541', '547', '3024', '2712', '1692', '1610', '591', '3648', '2493', '84', '1728', '1128', '268', '1239', '1983', '2679', '1734', '953', '2484', '2643', '3106', '3030', '0', '192', '3851', '567', '3353', '149', '2703', '1154', '3853', '1784', '721', '2689', '3017', '1394', '3664', '3086', '3275', '469', '2509', '871', '542', '3589', '1066', '2378', '1954', '3228', '49', '1453', '1974', '1586', '1149', '2089', '1541', '808', '1770', '2480', '1213', '2051', '209', '920', '937', '1273', '525', '3640', '675', '1737', '1711', '2054', '817', '274', '2263', '1294', '2575', '364', '200', '822', '1825', '3578', '3732', '1885', '3733', '954', '1852', '63', '3192', '3037', '3455', '2028', '2768', '592', '1626', '1134', '125', '810', '2135', '3078', '420', '3857', '234', '95', '2120', '1107', '2968', '2630', '3204', '272', '518', '2921', '2291', '2762', '927', '2099', '3716', '2964', '260', '441', '1319', '1232', '3775', '3116', '671', '39', '3760', '923', '2773', '1539', '170', '1320', '3138', '92', '3327', '745', '474', '448', '3918', '1284', '3722', '2087', '467', '2141', '93', '2336', '204', '3291', '2589', '654', '1997', '1884', '1419', '3922', '130', '3363', '3404', '2466', '3262', '253', '2877', '552', '895', '387', '158', '1988', '1933', '3868', '431', '243', '1581', '571', '2523', '609', '3867', '1317', '3628', '2690', '3254', '2614', '2899', '3390', '795', '1445', '3553', '2738', '3193', '395', '3703', '1945', '1448', '1398', '153', '1765', '2936', '3380', '1921', '99', '1746', '528', '3861', '3113', '14', '1670', '3142', '1975', '1598', '2476', '324', '47', '2311', '2198', '3600', '1340', '2890', '3413', '1325', '183', '2273', '1427', '3125', '1938', '2091', '1977', '1613', '1788', '2624', '1880', '2467', '1787', '1439', '3158', '2609', '3374', '2262', '3166', '3098', '2483', '1346', '2447', '252', '1932', '1813', '961', '2616', '144', '3305', '3801', '2874', '3042', '1472', '2285', '2886', '524', '3221', '2489', '1430', '3824', '2909', '3435', '1222', '661', '3091', '3590', '1127', '3768', '2733', '1223', '2040', '2785', '3540', '382', '3447', '1194', '1716', '2618', '1524', '2662', '2673', '2533', '2654', '1110', '3905', '1502', '933', '2537', '2752', '3602', '3342', '3592', '744', '380', '2943', '2581', '2645', '3269', '1859', '2891', '3620', '255', '10', '2649', '372', '3296', '1415', '3655', '776', '3588', '938', '1992', '2334', '1984', '317', '3709', '2687', '3811', '3256', '2326', '245', '1591', '2941', '1139', '642', '235', '3582', '2798', '110', '1819', '3565', '1036', '2352', '855', '1822', '3069', '2234', '2427', '3678', '3697', '177', '3169', '739', '566', '2193', '1634', '3440', '1176', '899', '3847', '1350', '1762', '229', '3781', '620', '1713', '3653', '3908', '3128', '2214', '3513', '27', '625', '548', '1802', '1103', '3852', '312', '2331', '876', '2780', '3769', '1231', '3319', '2772', '3415', '3662', '3240', '2684', '3033', '3605', '1522', '2633', '2156', '1719', '858', '3428', '549', '2360', '2149', '286', '2548', '2564', '1180', '3595', '2147', '1178', '160', '1683', '2316', '2445', '3672', '2781', '338', '3175', '2737', '3832', '1800', '1650', '1219', '885', '2884', '2550', '223', '955', '3118', '801', '930', '2578', '3884', '2064', '233', '3796', '2876', '1087', '676', '2150', '3925', '2383', '2584', '289', '3414', '514', '3255', '1046', '2598', '2358', '2439', '1894', '2574', '2889', '1677', '468', '701', '2577', '2328', '282', '1032', '2653', '2347', '313', '2246', '594', '2253', '3788', '379', '992', '1862', '842', '96', '2276', '345', '1131', '159', '196', '3', '1183', '1883', '1372', '1489', '1160', '1919', '1991', '1631', '3323', '2693', '150', '1299', '399', '3066', '780', '3417', '3097', '2317', '1895', '2020', '2620', '635', '1532', '760', '21', '510', '443', '2323', '561', '3080', '2034', '2812', '1476', '1601', '2343', '1207', '998', '1970', '3389', '3875', '2946', '2918', '3212', '1499', '2754', '3392', '3815', '2172', '1608', '3751', '2647', '2742', '1647', '2242', '3054', '3596', '16', '2750', '2832', '325', '804', '857', '2130', '2658', '1179', '623', '2465', '2646', '3410', '2103', '2635', '3432', '1550', '1645', '3684', '1632', '3076', '3225', '2381', '645', '2284', '1512', '2116', '3816', '1545', '479', '2872', '3452', '1421', '98', '1702', '1741', '3692', '989', '1665', '583', '15', '2047', '2838', '3645', '1621', '1968', '2196', '203', '3813', '2763', '2651', '512', '267', '2631', '2472', '925', '2002', '1506', '584', '1313', '1423', '3711', '3135', '751', '1715', '1136', '3292', '348', '900', '2722', '2092', '269', '453', '3826', '1168', '1689', '17', '3472', '2446', '2977', '1269', '3474', '2322', '1347', '2948', '1893', '3383', '1882', '2122', '1236', '2259', '1275', '3259', '61', '902', '366', '3568', '1744', '2052', '2975', '1967', '2133', '3147', '3200', '2215', '351', '3607', '434', '3111', '2911', '3298', '1624', '2786', '631', '2264', '123', '909', '820', '3621', '2495', '2952', '1867', '326', '3837', '1658', '323', '870', '2132', '731', '2477', '1495', '2912', '2741', '539', '3624', '481', '3667', '1571', '568', '124', '1830', '2727', '296', '2700', '1864', '847', '1108', '403', '197', '143', '3839', '590', '2423', '1841', '3154', '425', '1144', '932', '449', '3504', '1642', '1902', '3878', '3821', '1772', '3877', '421', '444', '627', '3810', '903', '1896', '3784', '3034', '3741', '1433', '3084', '912', '3682', '145', '2540', '2745', '3461', '1251', '2062', '3164', '135', '3499', '1700', '3201', '322', '1143', '766', '218', '24', '3058', '3519', '1905', '2053', '1655', '2823', '138', '2380', '1122', '1775', '2997', '273', '3301', '2269', '1471', '3450', '952', '2125', '3921', '2314', '3503', '386', '986', '250', '535', '455', '3109', '489', '1693', '1957', '359', '266', '981', '3010', '3362', '297', '836', '1629', '892', '2924', '3405', '1706', '3119', '3585', '994', '977', '1249', '2170', '637', '1494', '682', '2063', '2401', '935', '62', '1956', '1898', '1911', '1434', '2114', '38', '6', '3171', '3601', '2413', '119', '825', '2389', '3634', '1392', '1352', '1843', '1722', '1211', '569', '1344', '2319', '1842', '3698', '2235', '1947', '2749', '1890', '3367', '1637', '554', '3871', '1492', '3869', '3660', '1797', '352', '3889', '1058', '2260', '730', '2888', '501', '349', '1907', '2025', '3763', '1091', '2293', '2121', '1218', '3673', '3068', '1752', '679', '2096', '2669', '2200', '3498', '2123', '167', '697', '1982', '643', '792', '1172', '1159', '1118', '2321', '734', '3197', '64', '2585', '2248', '350', '1712', '516', '2778', '1014', '3181', '563', '263', '2502', '3827', '2841', '517', '271', '3891', '256', '2351', '3533', '2000', '165', '175', '1119', '1874', '555', '2414', '2761', '188', '3065', '2892', '2443', '363', '486', '1287', '1470', '3050', '2432', '1558', '1250', '361', '1878', '3075', '1011', '1971', '2428', '1496', '2570', '3471', '3798', '1329', '2942', '480', '3630', '1946', '20', '1208', '1304', '1774', '3593', '1554', '1071', '270', '3583', '1201', '3048', '2088', '3584', '1799', '3668', '2008', '211', '3539', '1101', '2153', '3159', '3257', '534', '1305', '1393', '2910', '3870', '3326', '2792', '2808', '2843', '3211', '1836', '2803', '2406', '2965', '2747', '949', '2567', '3895', '2357', '3677', '3586', '1479', '2615', '303', '3246', '1282', '306', '3258', '3396', '1146', '1189', '2917', '781', '688', '888', '2608', '1177', '2387', '1994', '1327', '3625', '3629', '1872', '3743', '3669', '136', '881', '164', '3149', '660', '121', '3183', '2597', '2825', '3789', '1523', '980', '2283', '2985', '31', '511', '3689', '1254', '1528', '1803', '613', '389', '1519', '579', '1592', '2671', '947', '936', '111', '1871', '3633', '3713', '638', '2222', '1701', '2563', '503', '1098', '1574', '1188', '2404', '2560', '1490', '1288', '2182', '2638', '2636', '1929', '169', '1726', '2241', '2855', '1257', '378', '1785', '1487', '3479', '3237', '1328', '2860', '777', '1793', '2842', '1431', '1778', '3650', '300', '1184', '939', '689', '1040', '3720', '874', '1913', '557', '1767', '3167', '40', '219', '3434', '3157', '3676', '1620', '1044', '1162', '1790', '2956', '1717', '3313', '2167', '728', '337', '206', '1454', '3666', '72', '1661', '2010', '3399', '1580', '2542', '504', '826', '1459', '1638', '877', '3009', '2224', '2004', '2038', '3345', '2261', '3361', '3283', '3520', '2804', '139', '1334', '3123', '1567', '2848', '866', '3141', '921', '1769', '2714', '3559', '2711', '2131', '94', '3511', '1543', '1834', '1065', '3665', '3145', '2301', '2726', '2169', '3691', '1364', '893', '342', '3787', '2789', '1986', '1807', '77', '806', '2611', '3143', '2145', '2538', '1259', '3131', '1505', '437', '185', '1560', '3903', '1073', '2661', '550', '385', '849', '3020', '3777', '241', '1210', '1082', '375', '331', '109', '305', '1008', '2748', '3745', '1672', '1137', '1417', '3226', '1111', '3464', '770', '850', '3554', '3338', '2652', '2681', '3685', '2863', '2055', '678', '2628', '2819', '2060', '3152', '1730', '2895', '2580', '1170', '1145', '944', '3446', '2637', '3057', '1607', '1962', '1739', '1220', '886', '3783', '818', '2816', '582', '450', '1791', '3051', '320', '33', '1609', '456', '3759', '2255', '1441', '536', '3646', '3550', '1435', '2488', '1414', '3797', '19', '2459', '1738', '2454', '803', '1221', '529', '3874', '2697', '724', '1292', '2544', '2278', '1378', '2610', '3773', '1641', '2603', '3728', '2858', '2188', '959', '3132', '2961', '2990', '3659', '3552', '1315', '2385', '1488', '2519', '2854', '2384', '964', '1694', '2296', '1261', '2665', '2771', '838', '3117', '1438', '341', '1868', '543', '1750', '2612', '2339', '3560', '3107', '1405', '3103', '293', '3249', '3402', '901', '237', '2110', '3245', '3538', '3776', '3165', '1099', '2247', '2929', '3493', '2277', '648', '3495', '1786', '1876', '3571', '2363', '1200', '725', '1010', '238', '758', '756', '360', '3148', '1093', '2232', '533', '2675', '2082', '3767', '2457', '3919', '3652', '1888', '664', '585', '396', '2420', '430', '412', '999', '1049', '2349', '2165', '383', '3115', '755', '356', '1399', '3055', '1531', '2715', '2315', '2801', '404', '3096', '1537', '2657', '1635', '2069', '3859', '2660', '2626', '194', '3829', '2818', '1753', '3281', '3794', '906', '1794', '2348', '476', '2023', '3480', '1026', '1768', '1302', '2295', '624', '3360', '3046', '2867', '3755', '2813', '3300', '1412', '259', '439', '3261', '308', '1192', '1029', '190', '2309', '1166', '106', '2462', '1150', '330', '717', '257', '154', '1290', '97', '1573', '683', '1939', '2837', '397', '1535', '1966', '2515', '3207', '3695', '1959', '1339', '230', '2436', '1789', '1646', '2154', '1742', '775', '2433', '3574', '2699', '2136', '1627', '1333', '3530', '3381', '1371', '1869', '3191', '670', '1224', '3915', '560', '393', '3836', '3247', '1517', '2894', '414', '2239', '2777', '309', '2249', '2525', '2972', '3337', '2035', '365', '483', '1379', '988', '1961', '532', '2393', '2213', '2594', '1493', '2565', '695', '586', '1764', '2041', '60', '388']

    test_ids = ['840', '863', '1639', '2072', '2562', '1416', '2113', '502', '2003', '3916', '3842', '343', '3778', '754', '950', '2506', '904', '2802', '791', '3617', '668', '3174', '1271', '2725', '3260', '2199', '2896', '1151', '2622', '328', '749', '1311', '2084', '1022', '1263', '2998', '1078', '3522', '2734', '346', '1838', '3397', '3356', '114', '2157', '3423', '2501', '1891', '148', '1316', '1106', '3591', '3219', '1270', '578', '3819', '2127', '2724', '3473', '1529', '3015', '1491', '3315', '3893', '438', '2302', '2774', '505', '1033', '864', '3093', '2806', '704', '975', '316', '3265', '1773', '68', '400', '3060', '2664', '2254', '3886', '2189', '2431', '611', '2163', '1360', '735', '974', '3608', '3099', '3120', '1817', '79', '494', '890', '3654', '2272', '334', '189', '3331', '151', '2919', '2498', '2821', '3663', '2730', '2857', '1922', '2049', '702', '1603', '1736', '3425', '3227', '2720', '2682', '1018', '3205', '1463', '307', '3521', '809', '3902', '418', '475', '2513', '2846', '3243', '3266', '1005', '3762', '2333', '1116', '593', '23', '2915', '1060', '1252', '1943', '1025', '1283', '1865', '1079', '429', '3409', '3270', '2861', '1831', '926', '1886', '2607', '3378', '1839', '1410', '3213', '696', '3516', '3576', '3865', '982', '417', '1557', '603', '1824', '1345', '3535', '1547', '2517', '1123', '446', '304', '1814', '1656', '3845', '1928', '3156', '2556', '3610', '1533', '2166', '1169', '621', '979', '2536', '884', '918', '3730', '1780', '595', '604', '122', '2976', '943', '2576', '3401', '1937', '146', '1361', '2829', '2639', '680', '3771', '1618', '2265', '837', '779', '120', '1999', '2014', '1948', '1856', '799', '3400', '1710', '1285', '458', '1114', '2957', '1034', '3379', '879', '3083', '1583', '3500', '3457', '1321', '3701', '2744', '3303', '432', '1782', '3350', '1548', '788', '531', '737', '2238', '3679', '321', '2898', '287', '102', '3752', '2367', '1909', '2090', '1935', '3234', '2415', '2216', '2795', '2532', '3412', '2535', '1652', '2045', '2932', '410', '2670', '2018', '993', '1258', '1985', '35', '140', '1265', '2037', '3011', '3904', '377', '1096', '447', '3873', '137', '2473', '1388', '859', '2865', '2656', '658', '291', '1440', '2569', '440', '2441', '281', '2659', '1556', '653', '2551', '3641', '2112', '616', '3714', '3231', '3222', '3643', '3463', '2787', '3459', '2510', '1268', '1256', '3188', '3308', '3092', '1684', '602', '684', '1757', '3180', '1594', '3318', '3799', '2181', '3635', '3507', '3137', '3449', '3095', '336', '636', '3216', '1253', '538', '1027', '3890', '1112', '967', '1509', '3364', '2274', '2206', '656', '2914', '3614', '214', '747', '1023', '3185', '1707', '848', '2883', '1648', '1630', '1035', '3637', '916', '3178', '2782', '2908', '1235', '2185', '1225', '3388', '1206', '2304', '1464', '2093', '1402', '1351', '3558', '451', '3438', '3465', '1019', '261', '2048', '1120', '354', '419', '833', '2231', '1688', '3622', '762', '2951', '3241', '1310', '1617', '1513', '2853', '2450', '1075', '3856', '3724', '1881', '3070', '2820', '1003', '759', '3912', '3502', '2973', '299', '3087', '1687', '1117', '1133', '1373', '3407', '1596', '2983', '1330', '3282', '295', '3002', '1546', '3547', '2776', '828', '650', '3906', '1031', '2007', '52', '3297', '3021', '2031', '3909', '2767', '3263', '1681', '1527', '436', '3609', '2534', '2743', '2230', '129', '329', '2822', '3421', '339', '461', '3443', '2566', '619', '3235', '3031', '490', '1006', '1755', '558', '394', '1698', '487', '2164', '1733', '629', '1081', '1050', '2856', '1053', '827', '3393', '3359', '3022', '178', '677', '3542', '1152', '2019', '1387', '987', '215', '2337', '3013', '1295', '3287', '1544', '865', '1384', '1857', '1850', '2355', '1760', '1041', '42', '426', '3041', '2588', '3036', '1809', '1721', '2554', '1324', '722', '3072', '132', '2719', '3357', '588', '2202', '3016', '1338', '1963', '2655', '1508', '1020', '1644', '812', '1004', '2791', '202', '2364', '2507', '741', '740', '2281', '311', '2702', '1595', '1308', '600', '1763', '2836', '1664', '1', '2229', '3000', '2713', '373', '575', '89', '2913', '1751', '2463', '2641', '2528', '715', '2139', '962', '1436', '897', '1132', '2605', '1749', '800', '3802', '2644', '3386', '1666', '1343', '1978', '3014', '2318', '3252', '2095', '3349', '1054', '790', '2361', '3343', '2600', '3897', '231', '228', '1536', '2440', '3846', '2834', '1877', '805', '3814', '1484', '3279', '1280', '1286', '3190', '2468', '1460', '2366', '615', '3804', '2236', '423', '3214', '1674', '2434', '1615', '2425', '3272', '878', '81', '103', '2604', '700', '707', '1244', '3077', '1927', '1552', '2179', '2190', '3456', '3294', '1246', '599', '3101', '727', '2287', '3527', '2663', '1565', '3749', '1848', '2862', '2810', '1397', '2081', '1979', '344', '860', '2984', '2043', '1017', '2868', '2634', '1367', '1659', '2407', '2522', '2344', '1021', '851', '1030', '3518', '59', '694', '720', '3651', '608', '3108', '292', '264', '2243', '1530', '3469', '597', '3704', '484', '3224', '3496', '2444', '48', '1255', '3544', '1369', '3309', '3347', '1503', '2161', '1606', '869', '3766', '3453', '2456', '1456', '1426', '279', '2416', '66', '2335', '3833', '1511', '633', '1731', '965', '220', '1190', '147', '1754', '3736', '3161', '1104', '54', '1826', '1777', '652', '2442', '3913', '612', '3631', '699', '56', '392', '948', '1562', '2071', '2073', '2710', '3194', '757', '3806', '71', '657', '3529', '2329', '2814', '3052', '2097', '1955', '3696', '1989', '3372', '3316', '78', '2775', '3082', '2435', '3688', '3489', '983', '2310', '3288', '2672', '3199', '3189', '872', '570', '1370', '1811', '3454', '669', '1748', '152', '294', '2893', '978', '2755', '2204', '750', '3458', '2129', '3555', '1930', '2177', '1153', '191', '3872', '1507', '753', '131', '2212', '1126', '3670', '1973', '1904', '2723', '3027', '1205', '2016', '11', '3047', '1278', '3523', '1182', '1941', '2300', '723', '3831', '3218', '1353', '3686', '2770', '1408', '168', '3043', '3573', '1796', '3758', '3061', '985', '18', '945', '924', '3860', '2039', '3377', '712', '3683', '3848', '1515']

    Stride_Size = 128
    FOLDER = "/data5/GLGAN/datasets/"
    LABELS = ["0", "1", "2", "3", "4", "5","6","7","8"]
    N_CLASSES = len(LABELS) # Number of classes
    WEIGHTS = torch.ones(N_CLASSES) # Weights for class balancing
    MAIN_FOLDER = FOLDER + 'MSL/'
    DATA_FOLDER = MAIN_FOLDER + 'images/{}.jpg'
    LABEL_FOLDER = MAIN_FOLDER + 'label_RGB/{}.png'
    BOUNDARY_FOLDER = MAIN_FOLDER + 'depth_1/{}.png'
    OBJECT_FOLDER = MAIN_FOLDER + 'depth_1/{}.png'
    ERODED_FOLDER = MAIN_FOLDER + 'label_RGB/{}.png'
    # 转换后的调色板字典格式
    palette = {
        0: (128, 0, 0),  # Class 0
        1: (0, 128, 0),  # Class 1
        2: (128, 128, 0),  # Class 2
        3: (0, 0, 128),  # Class 3
        4: (128, 0, 128),  # Class 4
        5: (0, 128, 128),  # Class 5
        6: (128, 128, 128),  # Class 6
        7: (64, 0, 0),  # Class 7
        8: (192, 0, 0)  # Class 8
    }

    # 反转调色板（颜色到类索引）
    invert_palette = {v: k for k, v in palette.items()}


def convert_to_color(arr_2d, palette=palette):
    """ Numeric labels to RGB-color encoding """
    arr_3d = np.zeros((arr_2d.shape[0], arr_2d.shape[1], 3), dtype=np.uint8)

    for c, i in palette.items():
        m = arr_2d == c
        arr_3d[m] = i

    return arr_3d

# def convert_to_color(arr_2d, palette=palette):
#     """ Numeric labels to RGB-color encoding """
#     arr_3d = np.zeros((arr_2d.shape[0], arr_2d.shape[1], 3), dtype=np.uint8)
#
#     for x in range(arr_2d.shape[0]):
#         for y in range(arr_2d.shape[1]):
#             label = arr_2d[x, y]
#             arr_3d[x, y] = palette[label]
#
#     return arr_3d





def convert_from_color(arr_3d, palette=invert_palette):
    """ RGB-color encoding to grayscale labels """
    arr_2d = np.zeros((arr_3d.shape[0], arr_3d.shape[1]), dtype=np.uint8)

    for c, i in palette.items():
        m = np.all(arr_3d == np.array(c).reshape(1, 1, 3), axis=2)
        arr_2d[m] = i

    return arr_2d


def convert_rgb_to_indices(rgb_label):
    indices_label = np.zeros_like(rgb_label, dtype=np.int64)
    for color, index in invert_palette.items():
        # 找到 RGB 图像中与当前颜色对应的像素，并将其标签设置为对应的索引值
        indices_label[np.all(rgb_label == color, axis=-1)] = index
    return indices_label


def save_img(tensor, name):
    tensor = tensor.cpu() .permute((1, 0, 2, 3))
    im = make_grid(tensor, normalize=True, scale_each=True, nrow=8, padding=2).permute((1, 2, 0))
    im = (im.data.numpy() * 255.).astype(np.uint8)
    Image.fromarray(im).save(name + '.jpg')

def object_process(object):
    ids = np.unique(object)
    new_id = 1
    for id in ids[1:]:
        object = np.where(object == id, new_id, object)
        new_id += 1
    return object

class ISPRS_dataset(torch.utils.data.Dataset):
    def __init__(self, ids, data_files=DATA_FOLDER, label_files=LABEL_FOLDER,
                 cache=False, augmentation=True):
        super(ISPRS_dataset, self).__init__()

        self.augmentation = augmentation
        self.cache = cache

        # List of files
        self.data_files = [DATA_FOLDER.format(id) for id in ids]
        self.boundary_files = [BOUNDARY_FOLDER.format(id) for id in ids]
        self.object_files = [OBJECT_FOLDER.format(id) for id in ids]
        self.label_files = [LABEL_FOLDER.format(id) for id in ids]

        # Sanity check : raise an error if some files do not exist
        for f in self.data_files + self.label_files:
            if not os.path.isfile(f):
                raise KeyError('{} is not a file !'.format(f))

        # Initialize cache dicts
        self.data_cache_ = {}
        self.boundary_cache_ = {}
        self.object_cache_ = {}
        self.label_cache_ = {}

    def __len__(self):
        # Default epoch size is 10 000 samples
        # return BATCH_SIZE * 100

        return BATCH_SIZE * 1000

    @classmethod
    def data_augmentation(cls, *arrays, flip=True, mirror=True):
        will_flip, will_mirror = False, False
        if flip and random.random() < 0.5:
            will_flip = True
        if mirror and random.random() < 0.5:
            will_mirror = True

        results = []
        for array in arrays:
            if will_flip:
                if len(array.shape) == 2:
                    array = array[::-1, :]
                else:
                    array = array[:, ::-1, :]
            if will_mirror:
                if len(array.shape) == 2:
                    array = array[:, ::-1]
                else:
                    array = array[:, :, ::-1]
            results.append(np.copy(array))

        return tuple(results)

    def __getitem__(self, i):
        # Pick a random image
        random_idx = random.randint(0, len(self.data_files) - 1)

        # If the tile hasn't been loaded yet, put in cache
        if random_idx in self.data_cache_.keys():
            data = self.data_cache_[random_idx]
        else:
            # Data is normalized in [0, 1]
            ## Potsdam IRRG
            if DATASET == 'Potsdam':
                ## RGB
                data = io.imread(self.data_files[random_idx])[:, :, :3].transpose((2, 0, 1))
                ## IRRG
                # data = io.imread(self.data_files[random_idx])[:, :, (3, 0, 1, 2)][:, :, :3].transpose((2, 0, 1))
                data = 1 / 255 * np.asarray(data, dtype='float32')
            else:
            ## Vaihingen IRRG
                data = io.imread(self.data_files[random_idx])
                data = 1 / 255 * np.asarray(data.transpose((2, 0, 1)), dtype='float32')
            if self.cache:
                self.data_cache_[random_idx] = data
        
        if random_idx in self.boundary_cache_.keys():
            boundary = self.boundary_cache_[random_idx]
        else:
            boundary = np.asarray(io.imread(self.boundary_files[random_idx])) / 255
            boundary = boundary.astype(np.int64)
            if self.cache:
                self.boundary_cache_[random_idx] = boundary

        if random_idx in self.object_cache_.keys():
            object = self.object_cache_[random_idx]
        else:
            object = np.asarray(io.imread(self.object_files[random_idx]))
            object = object.astype(np.int64)
            if self.cache:
                self.object_cache_[random_idx] = object

        if random_idx in self.label_cache_.keys():
            label = self.label_cache_[random_idx]
        else:
            # Labels are converted from RGB to their numeric values
            if DATASET == 'Loveda':
                label = np.asarray(io.imread(self.label_files[random_idx]), dtype='int64') - 1
            else:
                label = np.asarray(convert_from_color(io.imread(self.label_files[random_idx])), dtype='int64')
            if self.cache:
                self.label_cache_[random_idx] = label

        # Get a random patch
        x1, x2, y1, y2 = get_random_pos(data, WINDOW_SIZE)
        data_p = data[:, x1:x2, y1:y2]
        boundary_p = boundary[x1:x2, y1:y2]
        object_p = object[x1:x2, y1:y2]
        label_p = label[x1:x2, y1:y2]

        # Data augmentation
        # data_p, boundary_p, label_p = self.data_augmentation(data_p, boundary_p, label_p)
        data_p, boundary_p, object_p, label_p = self.data_augmentation(data_p, boundary_p, object_p, label_p)
        object_p = object_process(object_p)

        # Data augmentation
        # data_p, boundary_p, label_p = self.data_augmentation(data_p, boundary_p, label_p)
        data_p, boundary_p, object_p, label_p = self.data_augmentation(data_p, boundary_p, object_p, label_p)
        object_p = object_process(object_p)

        # Return the torch.Tensor values
        return (torch.from_numpy(data_p),
                torch.from_numpy(boundary_p),
                torch.from_numpy(object_p),
                torch.from_numpy(label_p))


## We load one tile from the dataset and we display it
# img = io.imread('./ISPRS_dataset/Vaihingen/top/top_mosaic_09cm_area11.tif')
# fig = plt.figure()
# fig.add_subplot(121)
# plt.imshow(img)
#
# # We load the ground truth
# gt = io.imread('./ISPRS_dataset/Vaihingen/gts_for_participants/top_mosaic_09cm_area11.tif')
# fig.add_subplot(122)
# plt.imshow(gt)
# plt.show()
#
# # We also check that we can convert the ground truth into an array format
# array_gt = convert_from_color(gt)
# print("Ground truth in numerical format has shape ({},{}) : \n".format(*array_gt.shape[:2]), array_gt)


# Utils

def get_random_pos(img, window_shape):
    """ Extract of 2D random patch of shape window_shape in the image """
    w, h = window_shape
    W, H = img.shape[-2:]
    x1 = random.randint(0, W - w - 1)
    x2 = x1 + w
    y1 = random.randint(0, H - h - 1)
    y2 = y1 + h
    return x1, x2, y1, y2


# class CrossEntropy2d_ignore(nn.Module):
#
#     def __init__(self, size_average=True, ignore_label=255):
#         super(CrossEntropy2d_ignore, self).__init__()
#         self.size_average = size_average
#         self.ignore_label = ignore_label
#
#     def forward(self, predict, target, weight=None):
#         """
#             Args:
#                 predict:(n, c, h, w)
#                 target:(n, h, w)
#                 weight (Tensor, optional): a manual rescaling weight given to each class.
#                                            If given, has to be a Tensor of size "nclasses"
#         """
#         assert not target.requires_grad
#         assert predict.dim() == 4
#         assert target.dim() == 3
#         assert predict.size(0) == target.size(0), "{0} vs {1} ".format(predict.size(0), target.size(0))
#         assert predict.size(2) == target.size(1), "{0} vs {1} ".format(predict.size(2), target.size(1))
#         assert predict.size(3) == target.size(2), "{0} vs {1} ".format(predict.size(3), target.size(3))
#         n, c, h, w = predict.size()
#         target_mask = (target >= 0) * (target != self.ignore_label)
#         target = target[target_mask]
#         if not target.data.dim():
#             return Variable(torch.zeros(1))
#         predict = predict.transpose(1, 2).transpose(2, 3).contiguous()
#         predict = predict[target_mask.view(n, h, w, 1).repeat(1, 1, 1, c)].view(-1, c)
#         loss = F.cross_entropy(predict, target, weight=weight, size_average=self.size_average)
#         return loss


class CrossEntropy2d_ignore(nn.Module):
    def __init__(self, size_average=True, ignore_label=255):
        super(CrossEntropy2d_ignore, self).__init__()
        self.size_average = size_average
        self.ignore_label = ignore_label

    def forward(self, predict, target, weight=None, weight_map=None):
        """
        Args:
            predict: (n, c, h, w) - 预测输出
            target: (n, h, w) - 真实标签
            weight: (c,) - 类别权重
            weight_map: (n, h, w) - 像素级权重图
        """
        assert not target.requires_grad
        assert predict.dim() == 4
        assert target.dim() == 3
        n, c, h, w = predict.size()

        # 创建掩码以忽略特定标签
        target_mask = (target >= 0) & (target != self.ignore_label)
        valid_indices = target_mask.nonzero(as_tuple=True)

        if len(valid_indices[0]) == 0:
            return torch.zeros(1).cuda()

        # 获取有效的预测和目标
        predict = predict.permute(0, 2, 3, 1)  # (n, h, w, c)
        predict = predict[valid_indices]
        predict = predict.view(-1, c)  # (num_valid_pixels, c)
        target = target[valid_indices]  # (num_valid_pixels,)

        if weight_map is not None:
            weight_map = weight_map.to(predict.device)
            per_pixel_weight = weight_map[valid_indices]  # (num_valid_pixels,)
        else:
            per_pixel_weight = None

        # 计算损失
        loss = F.cross_entropy(predict, target, weight=weight, reduction='none')

        if per_pixel_weight is not None:
            loss = loss * per_pixel_weight

        if self.size_average:
            loss = loss.mean()
        else:
            loss = loss.sum()

        return loss



# def loss_calc(pred, label, weights):
#     """
#     This function returns cross entropy loss for semantic segmentation
#     """
#     # out shape batch_size x channels x h x w -> batch_size x channels x h x w
#     # label shape h x w x 1 x batch_size  -> batch_size x 1 x h x w
#     label = Variable(label.long()).cuda()
#     criterion = CrossEntropy2d_ignore().cuda()

    # return criterion(pred, label, weights)

def loss_calc(pred, label, weights, weight_map=None):
    """
    该函数返回用于语义分割的加权交叉熵损失。
    """
    label = Variable(label.long()).cuda()
    criterion = CrossEntropy2d_ignore().cuda()
    return criterion(pred, label, weights, weight_map)




def CrossEntropy2d(input, target, weight=None, size_average=True):
    """ 2D version of the cross entropy loss """
    dim = input.dim()
    if dim == 2:
        return F.cross_entropy(input, target, weight, size_average)
    elif dim == 4:
        output = input.view(input.size(0), input.size(1), -1)
        output = torch.transpose(output, 1, 2).contiguous()
        output = output.view(-1, output.size(2))
        target = target.view(-1)
        return F.cross_entropy(output, target, weight, size_average)
    else:
        raise ValueError('Expected 2 or 4 dimensions (got {})'.format(dim))


def accuracy(input, target):
    return 100 * float(np.count_nonzero(input == target)) / target.size


def sliding_window(top, step=10, window_size=(20, 20)):
    """ Slide a window_shape window across the image with a stride of step """
    for x in range(0, top.shape[0], step):
        if x + window_size[0] > top.shape[0]:
            x = top.shape[0] - window_size[0]
        for y in range(0, top.shape[1], step):
            if y + window_size[1] > top.shape[1]:
                y = top.shape[1] - window_size[1]
            yield x, y, window_size[0], window_size[1]


def count_sliding_window(top, step=10, window_size=(20, 20)):
    """ Count the number of windows in an image """
    c = 0
    for x in range(0, top.shape[0], step):
        if x + window_size[0] > top.shape[0]:
            x = top.shape[0] - window_size[0]
        for y in range(0, top.shape[1], step):
            if y + window_size[1] > top.shape[1]:
                y = top.shape[1] - window_size[1]
            c += 1
    return c


def grouper(n, iterable):
    """ Browse an iterator by chunk of n elements """
    it = iter(iterable)
    while True:
        chunk = tuple(itertools.islice(it, n))
        if not chunk:
            return
        yield chunk


def one_hot(label, n_classes, requires_grad=True):
    """Return One Hot Label"""
    one_hot_label = torch.eye(
        n_classes, device='cuda', requires_grad=requires_grad)[label]
    one_hot_label = one_hot_label.transpose(1, 3).transpose(2, 3)

    return one_hot_label



######### FS LOSS

class DepthAwareSegmentationLoss(nn.Module):
    def __init__(self, lambda_edge=1.0, lambda_consistency=0.5):
        super(DepthAwareSegmentationLoss, self).__init__()
        self.lambda_edge = lambda_edge
        self.lambda_consistency = lambda_consistency


    def normalize_depth(self, depth):

        min_depth = torch.min(depth)
        max_depth = torch.max(depth)
        depth_normalized = (depth - min_depth) / (max_depth - min_depth + 1e-8)
        return depth_normalized

    def gradient_x(self, img):
        gx = img[:, :, :, :-1] - img[:, :, :, 1:]
        gx = gx[:, :, :-1, :]
        return gx

    def gradient_y(self, img):
        gy = img[:, :, :-1, :] - img[:, :, 1:, :]
        gy = gy[:, :, :, :-1]
        return gy

    def depth_edge_loss(self, pred_seg, depth):

        depth_normalized = self.normalize_depth(depth)

        # 计算深度图的梯度
        depth_grad_x = self.gradient_x(depth_normalized)
        depth_grad_y = self.gradient_y(depth_normalized)


        depth_grad_magnitude = torch.sqrt(depth_grad_x ** 2 + depth_grad_y ** 2 + 1e-8)


        pred_seg_softmax = F.softmax(pred_seg, dim=1)
        seg_boundary = self.compute_segmentation_boundaries(pred_seg_softmax)


        edge_loss = torch.mean(seg_boundary * depth_grad_magnitude)

        return edge_loss

    def compute_segmentation_boundaries(self, pred_seg_softmax):

        seg_grad_x = self.gradient_x(pred_seg_softmax)  # [B, C, H-1, W-1]
        seg_grad_y = self.gradient_y(pred_seg_softmax)  # [B, C, H-1, W-1]

        seg_grad_magnitude = torch.sqrt(seg_grad_x ** 2 + seg_grad_y ** 2 + 1e-8)

        seg_boundary = torch.sum(seg_grad_magnitude, dim=1, keepdim=True)  # [B, 1, H-1, W-1]
        return seg_boundary

    def depth_consistency_loss(self, pred_seg, depth):

        depth_normalized = self.normalize_depth(depth)


        pred_labels = torch.argmax(pred_seg, dim=1, keepdim=True)
        depth_flat = depth_normalized.view(depth_normalized.size(0), -1)
        label_flat = pred_labels.view(pred_labels.size(0), -1)

        depth_variance = 0.0
        num_classes = pred_seg.size(1)
        for c in range(num_classes):
            mask = (label_flat == c)
            if mask.sum() > 0:
                class_depths = depth_flat[mask]
                class_mean = class_depths.mean()
                class_variance = ((class_depths - class_mean) ** 2).mean()
                depth_variance += class_variance

        depth_variance = depth_variance / num_classes
        return depth_variance

    def forward(self, pred_seg,  depth):
        if depth.dim() == 3:
            depth = depth.unsqueeze(1)
        depth = depth.to(pred_seg.device)
        depth = self.normalize_depth(depth)
        edge_loss = self.depth_edge_loss(pred_seg, depth)
        consistency_loss = self.depth_consistency_loss(pred_seg, depth)
        total_loss =  self.lambda_edge * edge_loss + self.lambda_consistency * consistency_loss
        return total_loss


#################################################################################

class BoundaryLoss(nn.Module):
    def __init__(self, theta0=3, theta=5):
        super().__init__()

        self.theta0 = theta0
        self.theta = theta

    def forward(self, pred, gt):
        """
        Input:
            - pred: the output from model (before softmax)
                    shape (N, C, H, W)
            - gt: ground truth map
                    shape (N, H, w)
        Return:
            - boundary loss, averaged over mini-bathc
        """

        n, c, _, _ = pred.shape
        # softmax so that predicted map can be distributed in [0, 1]
        pred = torch.softmax(pred, dim=1)
        # one-hot vector of ground truth
        one_hot_gt = one_hot(gt, c)
        # boundary map
        gt_b = F.max_pool2d(
            1 - one_hot_gt, kernel_size=self.theta0, stride=1, padding=(self.theta0 - 1) // 2)
        gt_b -= 1 - one_hot_gt

        pred_b = F.max_pool2d(
            1 - pred, kernel_size=self.theta0, stride=1, padding=(self.theta0 - 1) // 2)
        pred_b -= 1 - pred

        # extended boundary map
        gt_b_ext = F.max_pool2d(
            gt_b, kernel_size=self.theta, stride=1, padding=(self.theta - 1) // 2)

        pred_b_ext = F.max_pool2d(
            pred_b, kernel_size=self.theta, stride=1, padding=(self.theta - 1) // 2)

        # reshape
        gt_b = gt_b.view(n, c, -1)
        pred_b = pred_b.view(n, c, -1)
        gt_b_ext = gt_b_ext.view(n, c, -1)
        pred_b_ext = pred_b_ext.view(n, c, -1)

        # Precision, Recall
        P = torch.sum(pred_b * gt_b_ext, dim=2) / (torch.sum(pred_b, dim=2) + 1e-7)
        R = torch.sum(pred_b_ext * gt_b, dim=2) / (torch.sum(gt_b, dim=2) + 1e-7)

        # Boundary F1 Score
        BF1 = 2 * P * R / (P + R + 1e-7)

        # summing BF1 Score for each class and average over mini-batch
        loss = torch.mean(1 - BF1)

        return loss


def metrics(predictions, gts, label_values=LABELS):
    cm = confusion_matrix(
        gts,
        predictions,
        labels=range(len(label_values)))

    print("Confusion matrix :")
    print(cm)
    # Compute global accuracy
    total = sum(sum(cm))
    accuracy = sum([cm[x][x] for x in range(len(cm))])
    accuracy *= 100 / float(total)
    print("%d pixels processed" % (total))
    print("Total accuracy : %.2f" % (accuracy))

    Acc = np.diag(cm) / cm.sum(axis=1)
    for l_id, score in enumerate(Acc):
        print("%s: %.4f" % (label_values[l_id], score))
    print("---")

    # Compute F1 score
    F1Score = np.zeros(len(label_values))
    for i in range(len(label_values)):
        try:
            F1Score[i] = 2. * cm[i, i] / (np.sum(cm[i, :]) + np.sum(cm[:, i]))
        except:
            # Ignore exception if there is no element in class i for test set
            pass
    print("F1Score :")
    for l_id, score in enumerate(F1Score):
        print("%s: %.4f" % (label_values[l_id], score))
    mf1 = np.nanmean(F1Score[:])
    print('mean F1Score: %.4f' % (np.nanmean(F1Score[:])))
    print("---")

    # Compute kappa coefficient
    total = np.sum(cm)
    pa = np.trace(cm) / float(total)
    pe = np.sum(np.sum(cm, axis=0) * np.sum(cm, axis=1)) / float(total * total)
    kappa = (pa - pe) / (1 - pe)
    print("Kappa: %.4f" % (kappa))

    # Compute MIoU coefficient
    MIoU = np.diag(cm) / (np.sum(cm, axis=1) + np.sum(cm, axis=0) - np.diag(cm))
    print(MIoU)
    MIoU = np.nanmean(MIoU[:])
    print('mean MIoU: %.4f' % (MIoU))
    print("---")

    return MIoU
